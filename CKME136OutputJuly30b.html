<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="TODD BETHELL" />

<meta name="date" content="2019-07-30" />

<title>CKME 136 Capstone</title>

<script src="CKME136OutputJuly30b_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="CKME136OutputJuly30b_files/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="CKME136OutputJuly30b_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="CKME136OutputJuly30b_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="CKME136OutputJuly30b_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="CKME136OutputJuly30b_files/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; } /* Alert */
code span.an { color: #008000; } /* Annotation */
code span.at { } /* Attribute */
code span.bu { } /* BuiltIn */
code span.cf { color: #0000ff; } /* ControlFlow */
code span.ch { color: #008080; } /* Char */
code span.cn { } /* Constant */
code span.co { color: #008000; } /* Comment */
code span.cv { color: #008000; } /* CommentVar */
code span.do { color: #008000; } /* Documentation */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.im { } /* Import */
code span.in { color: #008000; } /* Information */
code span.kw { color: #0000ff; } /* Keyword */
code span.op { } /* Operator */
code span.ot { color: #ff4000; } /* Other */
code span.pp { color: #ff4000; } /* Preprocessor */
code span.sc { color: #008080; } /* SpecialChar */
code span.ss { color: #008080; } /* SpecialString */
code span.st { color: #008080; } /* String */
code span.va { } /* Variable */
code span.vs { color: #008080; } /* VerbatimString */
code span.wa { color: #008000; font-weight: bold; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="fluid-row" id="header">



<h1 class="title toc-ignore">CKME 136 Capstone</h1>
<h4 class="author">TODD BETHELL</h4>
<h4 class="date">July 30, 2019</h4>

</div>


<div id="note-this-will-install-all-of-the-caret-package---which-will-take-several-minutes---so-comment-the-install-out-if-you-do-not-want-to-install-the-full-caret-package.-otherwise-start-from-line-66-first-chunk-to-determine-what-packages-you-may-need." class="section level4">
<h4>!!NOTE!! This will install ALL of the caret package - which will take several minutes - so comment the install out if you do not want to install the full caret package. Otherwise, start from line 66 (first chunk) to determine what packages you may need.</h4>
<p>install.packages(“caret”, dependencies = c(“Depends”, “Suggests”)) install.packages(“PerformanceAnalytics”) install.packages(“lsr”) install.packages(“tidyverse”) install.packages(“dplyr”) install.packages(“class”) install.packages(“gmodels”) install.packages(“corrplot”) install.packages(“RCurl”) install.packages(“GGally”) install.packages(“FSelector”) install.packages(“FSelectorRcpp”) install.packages(“mlbench”) install.packages(“caretEnsemble”) install.packages(“skimr”) install.packages(“tictoc”) install.packages(“effsize”) install.packages(“pscl”) install.packages(“klaR”) install.packages(“DMwR”) install.packages(“caTools”) install.packages(“rms”) install.packages(“Hmisc”) install.packages(“ggsignif”) install.packages(“ggsci”) install.packages(“pedometrics”) library(GGally) library(knitr) library(RCurl) library(caret) library(PerformanceAnalytics) library(lsr) library(tidyverse) library(dplyr) library(class) library(gmodels) library(corrplot) library(GGally) library(FSelectorRcpp) library(caretEnsemble) library(skimr) library(tictoc) library(effsize) library(pscl) library(klaR) library(DMwR) library(caTools) library(rms) library(Hmisc) library(ggsignif) library(ggsci) library(pedometrics) —</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(RCurl)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">library</span>(caret)</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">library</span>(PerformanceAnalytics)</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">library</span>(lsr)</a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw">library</span>(plyr)</a>
<a class="sourceLine" id="cb1-9" title="9"><span class="kw">library</span>(class)</a>
<a class="sourceLine" id="cb1-10" title="10"><span class="kw">library</span>(gmodels)</a>
<a class="sourceLine" id="cb1-11" title="11"><span class="kw">library</span>(corrplot)</a>
<a class="sourceLine" id="cb1-12" title="12"><span class="kw">library</span>(GGally)</a>
<a class="sourceLine" id="cb1-13" title="13"><span class="kw">library</span>(FSelectorRcpp)</a>
<a class="sourceLine" id="cb1-14" title="14"><span class="kw">library</span>(caretEnsemble)</a>
<a class="sourceLine" id="cb1-15" title="15"><span class="kw">library</span>(skimr)</a>
<a class="sourceLine" id="cb1-16" title="16"><span class="kw">library</span>(tictoc)</a>
<a class="sourceLine" id="cb1-17" title="17"><span class="kw">library</span>(effsize)</a>
<a class="sourceLine" id="cb1-18" title="18"><span class="kw">library</span>(pscl)</a>
<a class="sourceLine" id="cb1-19" title="19"><span class="kw">library</span>(klaR)</a>
<a class="sourceLine" id="cb1-20" title="20"><span class="kw">library</span>(DMwR)</a>
<a class="sourceLine" id="cb1-21" title="21"><span class="kw">library</span>(caTools)</a>
<a class="sourceLine" id="cb1-22" title="22"><span class="kw">library</span>(rms)</a>
<a class="sourceLine" id="cb1-23" title="23"><span class="kw">library</span>(Hmisc)</a>
<a class="sourceLine" id="cb1-24" title="24"><span class="kw">library</span>(ggsignif)</a>
<a class="sourceLine" id="cb1-25" title="25"><span class="kw">library</span>(ggsci)</a>
<a class="sourceLine" id="cb1-26" title="26"><span class="kw">library</span>(pedometrics)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">FullSetB4&lt;-<span class="kw">read.csv</span>(<span class="dt">file=</span><span class="st">&quot;https://raw.githubusercontent.com/ToddB11/TB136capstone/master/ZAlizadeh_dataset.csv&quot;</span>,<span class="dt">header=</span>T,<span class="dt">sep=</span><span class="st">&quot;,&quot;</span>)</a></code></pre></div>
</div>
<div id="review-data-set" class="section level4">
<h4>Review Data Set</h4>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">head</span>(FullSetB4)</a></code></pre></div>
<pre><code>##   ï..Age Weight Length   Sex      BMI DM HTN Smoker ExSmoker FH Obesity
## 1     53     90    175  Male 29.38776  0   1      1        0  0       Y
## 2     67     70    157 Fmale 28.39872  0   1      0        0  0       Y
## 3     54     54    164  Male 20.07733  0   0      1        0  0       N
## 4     66     67    158 Fmale 26.83865  0   1      0        0  0       Y
## 5     50     87    153 Fmale 37.16519  0   1      0        0  0       Y
## 6     50     75    175  Male 24.48980  0   0      1        0  0       N
##   CRF CVA AD TD CHF DLP  BP  PR Edema WPP LR SysM DiaM TCP Dyspnea Fclass
## 1   N   N  N  N   N   Y 110  80     0   N  N    N    N   0       N      0
## 2   N   N  N  N   N   N 140  80     1   N  N    N    N   1       N      0
## 3   N   N  N  N   N   N 100 100     0   N  N    N    N   1       N      0
## 4   N   N  N  N   N   N 100  80     0   N  N    N    Y   0       Y      3
## 5   N   N  N  N   N   N 110  80     0   N  N    Y    N   0       Y      2
## 6   N   N  N  N   N   N 118  70     0   N  N    N    N   1       N      3
##   ACP NCP ECP LTAng QWave STelev STdep Tinv LVH PoorR BBB FBS  Cr  TG LDL
## 1   N   N   N     N     0      0     1    1   N     N   N  90 0.7 250 155
## 2   N   N   N     N     0      0     1    1   N     N   N  80 1.0 309 121
## 3   N   N   N     N     0      0     0    0   N     N   N  85 1.0 103  70
## 4   N   Y   N     N     0      0     1    0   N     N   N  78 1.2  63  55
## 5   N   N   N     N     0      0     0    0   N     N   N 104 1.0 170 110
## 6   N   N   N     N     0      0     0    0   N     N   N  86 1.0 139 119
##   HDL BUN ESR   Hb   K  Na   WBC Lymph Neut PLT EF RWMA    VHD    CAD
## 1  30   8   7 15.6 4.7 141  5700    39   52 261 50    0      N    Cad
## 2  36  30  26 13.9 4.7 156  7700    38   55 165 40    4      N    Cad
## 3  45  17  10 13.5 4.7 139  7400    38   60 230 40    2   mild    Cad
## 4  27  30  76 12.1 4.4 142 13000    18   72 742 55    0 Severe Normal
## 5  50  16  27 13.2 4.0 140  9200    55   39 274 50    0 Severe Normal
## 6  34  13  18 15.6 4.2 141  7300    26   66 194 50    0      N    Cad</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">tail</span>(FullSetB4)</a></code></pre></div>
<pre><code>##     ï..Age Weight Length   Sex      BMI DM HTN Smoker ExSmoker FH Obesity
## 298     30    100    172  Male 33.80206  0   0      1        0  1       Y
## 299     58     84    168  Male 29.76190  0   0      0        0  0       Y
## 300     55     64    152 Fmale 27.70083  0   0      0        0  0       Y
## 301     48     77    160 Fmale 30.07812  0   1      0        0  1       Y
## 302     57     90    159 Fmale 35.59986  1   0      0        0  0       Y
## 303     56     85    170 Fmale 29.41176  0   1      1        0  0       Y
##     CRF CVA AD TD CHF DLP  BP PR Edema WPP LR SysM DiaM TCP Dyspnea Fclass
## 298   N   N  N  N   N   N 110 60     0   N  N    N    N   0       N      0
## 299   N   N  N  N   N   N 100 76     0   N  N    N    N   1       N      0
## 300   N   N  N  N   N   N 100 60     0   N  N    Y    N   0       Y      0
## 301   N   N  N  N   N   N 130 70     0   N  N    N    N   0       N      0
## 302   N   N  N  N   N   N 100 60     0   N  N    N    N   0       Y      0
## 303   N   N  N  N   N   N 120 80     0   N  N    N    N   1       N      0
##     ACP NCP ECP LTAng QWave STelev STdep Tinv LVH PoorR  BBB FBS  Cr  TG
## 298   Y   N   N     N     0      0     0    0   N     N    N  83 1.0 205
## 299   N   N   N     N     0      0     0    0   N     N    N  92 1.0 112
## 300   Y   N   N     N     0      0     0    0   N     N LBBB  86 0.9 111
## 301   N   Y   N     N     0      0     0    0   N     N RBBB  83 1.0  93
## 302   Y   N   N     N     0      0     0    0   N     N    N  96 1.0 116
## 303   N   N   N     N     0      0     0    1   N     N    N  78 0.7 139
##     LDL HDL BUN ESR   Hb   K  Na   WBC Lymph Neut PLT EF RWMA  VHD    CAD
## 298  97  53  20  16 13.1 4.0 143  9100    39   60 294 55    1    N Normal
## 299 115  44  13  13 12.3 4.8 146  8500    34   58 251 45    0    N    Cad
## 300  40  23  23   3 12.4 4.0 139 11400    16   80 377 40    0 mild Normal
## 301 112  42  13  20 12.8 4.0 140  9000    35   55 279 55    0    N Normal
## 302 130  49  14  31 10.1 3.8 141  3800    48   40 208 55    0    N Normal
## 303 124  34  16  13 14.7 4.4 147  6000    32   55 302 55    0    N    Cad</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">str</span>(FullSetB4)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    303 obs. of  56 variables:
##  $ ï..Age  : int  53 67 54 66 50 50 55 72 58 60 ...
##  $ Weight  : int  90 70 54 67 87 75 80 80 84 71 ...
##  $ Length  : int  175 157 164 158 153 175 165 175 163 170 ...
##  $ Sex     : Factor w/ 2 levels &quot;Fmale&quot;,&quot;Male&quot;: 2 1 2 1 1 2 2 2 1 2 ...
##  $ BMI     : num  29.4 28.4 20.1 26.8 37.2 ...
##  $ DM      : int  0 0 0 0 0 0 0 1 0 1 ...
##  $ HTN     : int  1 1 0 1 1 0 0 0 0 0 ...
##  $ Smoker  : int  1 0 1 0 0 1 0 1 0 0 ...
##  $ ExSmoker: int  0 0 0 0 0 0 1 0 0 0 ...
##  $ FH      : int  0 0 0 0 0 0 0 0 0 0 ...
##  $ Obesity : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 2 2 1 2 2 1 2 2 2 1 ...
##  $ CRF     : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ CVA     : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ AD      : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ TD      : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ CHF     : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ DLP     : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 2 1 1 1 1 1 1 2 1 1 ...
##  $ BP      : int  110 140 100 100 110 118 110 130 90 130 ...
##  $ PR      : int  80 80 100 80 80 70 80 70 50 70 ...
##  $ Edema   : int  0 1 0 0 0 0 0 0 0 0 ...
##  $ WPP     : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ LR      : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ SysM    : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 2 1 2 1 1 1 ...
##  $ DiaM    : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 2 1 1 1 1 1 1 ...
##  $ TCP     : int  0 1 1 0 0 1 1 1 0 1 ...
##  $ Dyspnea : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 2 2 1 1 1 2 2 ...
##  $ Fclass  : int  0 0 0 3 2 3 0 0 0 2 ...
##  $ ACP     : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NCP     : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 2 1 1 1 1 2 1 ...
##  $ ECP     : Factor w/ 1 level &quot;N&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ LTAng   : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ QWave   : int  0 0 0 0 0 0 1 0 0 0 ...
##  $ STelev  : int  0 0 0 0 0 0 1 0 0 0 ...
##  $ STdep   : int  1 1 0 1 0 0 0 1 0 0 ...
##  $ Tinv    : int  1 1 0 0 0 0 1 1 0 0 ...
##  $ LVH     : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ PoorR   : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ BBB     : Factor w/ 3 levels &quot;LBBB&quot;,&quot;N&quot;,&quot;RBBB&quot;: 2 2 2 2 2 2 2 2 2 1 ...
##  $ FBS     : int  90 80 85 78 104 86 80 130 69 209 ...
##  $ Cr      : num  0.7 1 1 1.2 1 1 0.8 0.9 0.6 1.3 ...
##  $ TG      : int  250 309 103 63 170 139 83 80 79 80 ...
##  $ LDL     : int  155 121 70 55 110 119 85 90 90 90 ...
##  $ HDL     : num  30 36 45 27 50 34 34 55 59 44 ...
##  $ BUN     : int  8 30 17 30 16 13 12 19 15 16 ...
##  $ ESR     : int  7 26 10 76 27 18 38 4 5 8 ...
##  $ Hb      : num  15.6 13.9 13.5 12.1 13.2 15.6 14.1 16.1 11.6 13.9 ...
##  $ K       : num  4.7 4.7 4.7 4.4 4 4.2 4.8 4.3 3.4 4.6 ...
##  $ Na      : int  141 156 139 142 140 141 139 142 139 140 ...
##  $ WBC     : int  5700 7700 7400 13000 9200 7300 9400 12200 5100 4900 ...
##  $ Lymph   : int  39 38 38 18 55 26 58 25 49 55 ...
##  $ Neut    : int  52 55 60 72 39 66 33 74 50 42 ...
##  $ PLT     : int  261 165 230 742 274 194 292 410 370 380 ...
##  $ EF      : int  50 40 40 55 50 50 40 45 50 40 ...
##  $ RWMA    : int  0 4 2 0 0 0 4 4 0 2 ...
##  $ VHD     : Factor w/ 4 levels &quot;mild&quot;,&quot;Moderate&quot;,..: 3 3 1 4 4 3 1 1 3 3 ...
##  $ CAD     : Factor w/ 2 levels &quot;Cad&quot;,&quot;Normal&quot;: 1 1 1 2 2 1 1 1 2 1 ...</code></pre>
</div>
<div id="fixing-age-column-header-not-displaying-correctly" class="section level4">
<h4>Fixing ‘Age’ column header (not displaying correctly):</h4>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">names</span>(FullSetB4)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;Age&quot;</span></a></code></pre></div>
</div>
<div id="remove-length-attribute---since-not-used-in-final-study-and-captured-via-bmi-and-obesity-uses-bmi" class="section level4">
<h4>Remove ‘Length’ attribute - since not used in final study; and captured via BMI (and ‘Obesity’ uses ‘BMI’):</h4>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">FullSetB4 &lt;-<span class="st"> </span>FullSetB4[<span class="op">-</span><span class="dv">3</span>]</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="kw">dim</span>(FullSetB4)</a></code></pre></div>
<pre><code>## [1] 303  55</code></pre>
</div>
<div id="checking-for-missing-data-errors" class="section level3">
<h3>CHECKING FOR MISSING DATA &amp; ERRORS:</h3>
<div id="step-one-review-all-integer-and-numeric-variables-statisitics-note-inline-histogram-correction-was-needed-to-display-correctly-on-rmarkdown" class="section level4">
<h4>Step one, review all integer and numeric variables statisitics (note: ‘inline histogram’ correction was needed to display correctly on rmarkdown):</h4>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">library</span>(skimr)</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb12-3" title="3"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb12-4" title="4"></a>
<a class="sourceLine" id="cb12-5" title="5">skim1 &lt;-<span class="st"> </span>FullSetB4[,<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dv">16</span><span class="op">:</span><span class="dv">17</span>,<span class="dv">36</span><span class="op">:</span><span class="dv">50</span>)]</a>
<a class="sourceLine" id="cb12-6" title="6">skimr<span class="op">::</span><span class="kw">skim</span>(skim1) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="st">  </span><span class="kw">filter</span>(stat <span class="op">==</span><span class="st"> &quot;hist&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="st">  </span><span class="kw">print.listof</span>(<span class="dt">locale =</span> <span class="kw">locale</span>(<span class="dt">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>))</a></code></pre></div>
<pre><code>## variable :
##  [1] &quot;Age&quot;    &quot;Weight&quot; &quot;BP&quot;     &quot;FBS&quot;    &quot;Cr&quot;     &quot;TG&quot;     &quot;LDL&quot;   
##  [8] &quot;HDL&quot;    &quot;BUN&quot;    &quot;ESR&quot;    &quot;Hb&quot;     &quot;K&quot;      &quot;Na&quot;     &quot;WBC&quot;   
## [15] &quot;Lymph&quot;  &quot;Neut&quot;  
## 
## type :
##  [1] &quot;integer&quot; &quot;integer&quot; &quot;integer&quot; &quot;integer&quot; &quot;numeric&quot; &quot;integer&quot; &quot;integer&quot;
##  [8] &quot;numeric&quot; &quot;integer&quot; &quot;integer&quot; &quot;numeric&quot; &quot;numeric&quot; &quot;integer&quot; &quot;integer&quot;
## [15] &quot;integer&quot; &quot;integer&quot;
## 
## stat :
##  [1] &quot;hist&quot; &quot;hist&quot; &quot;hist&quot; &quot;hist&quot; &quot;hist&quot; &quot;hist&quot; &quot;hist&quot; &quot;hist&quot; &quot;hist&quot; &quot;hist&quot;
## [11] &quot;hist&quot; &quot;hist&quot; &quot;hist&quot; &quot;hist&quot; &quot;hist&quot; &quot;hist&quot;
## 
## level :
##  [1] &quot;.all&quot; &quot;.all&quot; &quot;.all&quot; &quot;.all&quot; &quot;.all&quot; &quot;.all&quot; &quot;.all&quot; &quot;.all&quot; &quot;.all&quot; &quot;.all&quot;
## [11] &quot;.all&quot; &quot;.all&quot; &quot;.all&quot; &quot;.all&quot; &quot;.all&quot; &quot;.all&quot;
## 
## value :
##  [1] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
## 
## formatted :
##  [1] &quot;&lt;U+2581&gt;&lt;U+2582&gt;&lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2586&gt;&lt;U+2582&gt;&lt;U+2581&gt;&quot; &quot;&lt;U+2582&gt;&lt;U+2586&gt;&lt;U+2587&gt;&lt;U+2586&gt;&lt;U+2583&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&quot; &quot;&lt;U+2582&gt;&lt;U+2583&gt;&lt;U+2583&gt;&lt;U+2587&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&quot; &quot;&lt;U+2587&gt;&lt;U+2583&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&quot; &quot;&lt;U+2582&gt;&lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2586&gt;&lt;U+2582&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&quot; &quot;&lt;U+2587&gt;&lt;U+2582&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&quot;
##  [7] &quot;&lt;U+2581&gt;&lt;U+2583&gt;&lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2583&gt;&lt;U+2582&gt;&lt;U+2581&gt;&lt;U+2581&gt;&quot; &quot;&lt;U+2582&gt;&lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2582&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&quot; &quot;&lt;U+2582&gt;&lt;U+2587&gt;&lt;U+2583&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&quot; &quot;&lt;U+2587&gt;&lt;U+2586&gt;&lt;U+2582&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&quot; &quot;&lt;U+2581&gt;&lt;U+2582&gt;&lt;U+2583&gt;&lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2585&gt;&lt;U+2582&gt;&lt;U+2581&gt;&quot; &quot;&lt;U+2581&gt;&lt;U+2585&gt;&lt;U+2587&gt;&lt;U+2586&gt;&lt;U+2582&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&quot;
## [13] &quot;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2583&gt;&lt;U+2587&gt;&lt;U+2583&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&quot; &quot;&lt;U+2583&gt;&lt;U+2587&gt;&lt;U+2586&gt;&lt;U+2583&gt;&lt;U+2582&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2581&gt;&quot; &quot;&lt;U+2581&gt;&lt;U+2582&gt;&lt;U+2583&gt;&lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2583&gt;&lt;U+2581&gt;&lt;U+2581&gt;&quot; &quot;&lt;U+2581&gt;&lt;U+2582&gt;&lt;U+2586&gt;&lt;U+2587&gt;&lt;U+2586&gt;&lt;U+2583&gt;&lt;U+2582&gt;&lt;U+2581&gt;&quot;</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">skim2 &lt;-<span class="st"> </span><span class="kw">skim_to_wide</span>(skim1)</a>
<a class="sourceLine" id="cb14-2" title="2"><span class="kw">kable</span>(skim2)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="center">type</th>
<th align="center">variable</th>
<th align="center">missing</th>
<th align="center">complete</th>
<th align="center">n</th>
<th align="center">n_unique</th>
<th align="center">top_counts</th>
<th align="center">ordered</th>
<th align="center">mean</th>
<th align="center">sd</th>
<th align="center">p0</th>
<th align="center">p25</th>
<th align="center">p50</th>
<th align="center">p75</th>
<th align="center">p100</th>
<th align="center">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">factor</td>
<td align="center">BBB</td>
<td align="center">0</td>
<td align="center">303</td>
<td align="center">303</td>
<td align="center">3</td>
<td align="center">N: 282, LBB: 13, RBB: 8, NA: 0</td>
<td align="center">FALSE</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center">factor</td>
<td align="center">DLP</td>
<td align="center">0</td>
<td align="center">303</td>
<td align="center">303</td>
<td align="center">2</td>
<td align="center">N: 191, Y: 112, NA: 0</td>
<td align="center">FALSE</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="odd">
<td align="center">factor</td>
<td align="center">PoorR</td>
<td align="center">0</td>
<td align="center">303</td>
<td align="center">303</td>
<td align="center">2</td>
<td align="center">N: 294, Y: 9, NA: 0</td>
<td align="center">FALSE</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
<tr class="even">
<td align="center">integer</td>
<td align="center">Age</td>
<td align="center">0</td>
<td align="center">303</td>
<td align="center">303</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">58.9</td>
<td align="center">10.39</td>
<td align="center">30</td>
<td align="center">51</td>
<td align="center">58</td>
<td align="center">66</td>
<td align="center">86</td>
<td align="center">▁▂▇▇▇▆▂▁</td>
</tr>
<tr class="odd">
<td align="center">integer</td>
<td align="center">BP</td>
<td align="center">0</td>
<td align="center">303</td>
<td align="center">303</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">129.55</td>
<td align="center">18.94</td>
<td align="center">90</td>
<td align="center">120</td>
<td align="center">130</td>
<td align="center">140</td>
<td align="center">190</td>
<td align="center">▂▃▃▇▁▁▁▁</td>
</tr>
<tr class="even">
<td align="center">integer</td>
<td align="center">BUN</td>
<td align="center">0</td>
<td align="center">303</td>
<td align="center">303</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">17.5</td>
<td align="center">6.96</td>
<td align="center">6</td>
<td align="center">13</td>
<td align="center">16</td>
<td align="center">20</td>
<td align="center">52</td>
<td align="center">▂▇▃▁▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="center">integer</td>
<td align="center">ESR</td>
<td align="center">0</td>
<td align="center">303</td>
<td align="center">303</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">19.46</td>
<td align="center">15.94</td>
<td align="center">1</td>
<td align="center">9</td>
<td align="center">15</td>
<td align="center">26</td>
<td align="center">90</td>
<td align="center">▇▆▂▁▁▁▁▁</td>
</tr>
<tr class="even">
<td align="center">integer</td>
<td align="center">FBS</td>
<td align="center">0</td>
<td align="center">303</td>
<td align="center">303</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">119.18</td>
<td align="center">52.08</td>
<td align="center">62</td>
<td align="center">88.5</td>
<td align="center">98</td>
<td align="center">130</td>
<td align="center">400</td>
<td align="center">▇▃▁▁▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="center">integer</td>
<td align="center">LDL</td>
<td align="center">0</td>
<td align="center">303</td>
<td align="center">303</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">104.64</td>
<td align="center">35.4</td>
<td align="center">18</td>
<td align="center">80</td>
<td align="center">100</td>
<td align="center">122</td>
<td align="center">232</td>
<td align="center">▁▃▇▇▃▂▁▁</td>
</tr>
<tr class="even">
<td align="center">integer</td>
<td align="center">Lymph</td>
<td align="center">0</td>
<td align="center">303</td>
<td align="center">303</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">32.4</td>
<td align="center">9.97</td>
<td align="center">7</td>
<td align="center">26</td>
<td align="center">32</td>
<td align="center">39</td>
<td align="center">60</td>
<td align="center">▁▂▃▇▇▃▁▁</td>
</tr>
<tr class="odd">
<td align="center">integer</td>
<td align="center">Na</td>
<td align="center">0</td>
<td align="center">303</td>
<td align="center">303</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">141</td>
<td align="center">3.81</td>
<td align="center">128</td>
<td align="center">139</td>
<td align="center">141</td>
<td align="center">143</td>
<td align="center">156</td>
<td align="center">▁▁▃▇▃▁▁▁</td>
</tr>
<tr class="even">
<td align="center">integer</td>
<td align="center">Neut</td>
<td align="center">0</td>
<td align="center">303</td>
<td align="center">303</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">60.15</td>
<td align="center">10.18</td>
<td align="center">32</td>
<td align="center">52.5</td>
<td align="center">60</td>
<td align="center">67</td>
<td align="center">89</td>
<td align="center">▁▂▆▇▆▃▂▁</td>
</tr>
<tr class="odd">
<td align="center">integer</td>
<td align="center">TG</td>
<td align="center">0</td>
<td align="center">303</td>
<td align="center">303</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">150.34</td>
<td align="center">97.96</td>
<td align="center">37</td>
<td align="center">90</td>
<td align="center">122</td>
<td align="center">177</td>
<td align="center">1050</td>
<td align="center">▇▂▁▁▁▁▁▁</td>
</tr>
<tr class="even">
<td align="center">integer</td>
<td align="center">WBC</td>
<td align="center">0</td>
<td align="center">303</td>
<td align="center">303</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">7562.05</td>
<td align="center">2413.74</td>
<td align="center">3700</td>
<td align="center">5800</td>
<td align="center">7100</td>
<td align="center">8800</td>
<td align="center">18000</td>
<td align="center">▃▇▆▃▂▁▁▁</td>
</tr>
<tr class="odd">
<td align="center">integer</td>
<td align="center">Weight</td>
<td align="center">0</td>
<td align="center">303</td>
<td align="center">303</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">73.83</td>
<td align="center">11.99</td>
<td align="center">48</td>
<td align="center">65</td>
<td align="center">74</td>
<td align="center">81</td>
<td align="center">120</td>
<td align="center">▂▆▇▆▃▁▁▁</td>
</tr>
<tr class="even">
<td align="center">numeric</td>
<td align="center">Cr</td>
<td align="center">0</td>
<td align="center">303</td>
<td align="center">303</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">1.06</td>
<td align="center">0.26</td>
<td align="center">0.5</td>
<td align="center">0.9</td>
<td align="center">1</td>
<td align="center">1.2</td>
<td align="center">2.2</td>
<td align="center">▂▇▇▆▂▁▁▁</td>
</tr>
<tr class="odd">
<td align="center">numeric</td>
<td align="center">Hb</td>
<td align="center">0</td>
<td align="center">303</td>
<td align="center">303</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">13.15</td>
<td align="center">1.61</td>
<td align="center">8.9</td>
<td align="center">12.2</td>
<td align="center">13.2</td>
<td align="center">14.2</td>
<td align="center">17.6</td>
<td align="center">▁▂▃▇▇▅▂▁</td>
</tr>
<tr class="even">
<td align="center">numeric</td>
<td align="center">HDL</td>
<td align="center">0</td>
<td align="center">303</td>
<td align="center">303</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">40.23</td>
<td align="center">10.56</td>
<td align="center">15.9</td>
<td align="center">33.5</td>
<td align="center">39</td>
<td align="center">45.5</td>
<td align="center">111</td>
<td align="center">▂▇▇▂▁▁▁▁</td>
</tr>
<tr class="odd">
<td align="center">numeric</td>
<td align="center">K</td>
<td align="center">0</td>
<td align="center">303</td>
<td align="center">303</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">4.23</td>
<td align="center">0.46</td>
<td align="center">3</td>
<td align="center">3.9</td>
<td align="center">4.2</td>
<td align="center">4.5</td>
<td align="center">6.6</td>
<td align="center">▁▅▇▆▂▁▁▁</td>
</tr>
</tbody>
</table>
</div>
<div id="check-number-of-observations-and-whether-there-is-any-missing-data" class="section level4">
<h4>Check number of observations and whether there is any missing data:</h4>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">nrow</span>(FullSetB4)</a></code></pre></div>
<pre><code>## [1] 303</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">sum</span>(<span class="kw">is.na</span>(FullSetB4))</a></code></pre></div>
<pre><code>## [1] 0</code></pre>
</div>
<div id="double-checking-whether-all-observations-are-complete-no-missing-data-no-incomplete-cases-found-but-i-am-commenting-this-out-for-the-html-output---since-the-output-is-very-long." class="section level4">
<h4>Double checking whether all observations are complete (no missing data): No incomplete cases found, but I am commenting this out for the html output - since the output is very long.</h4>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="co"># FullSetB4[complete.cases(FullSetB4),]</span></a></code></pre></div>
</div>
<div id="checking-for-errors-starting-with-sex-attribute-column-3" class="section level4">
<h4>Checking for errors, starting with ‘Sex’ attribute (column 3):</h4>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">SexF &lt;-<span class="st"> </span><span class="kw">sum</span>(FullSetB4<span class="op">$</span>Sex <span class="op">==</span><span class="st"> &#39;Fmale&#39;</span>)</a>
<a class="sourceLine" id="cb20-2" title="2">SexM &lt;-<span class="st"> </span><span class="kw">sum</span>(FullSetB4<span class="op">$</span>Sex <span class="op">==</span><span class="st"> &#39;Male&#39;</span>)</a>
<a class="sourceLine" id="cb20-3" title="3"><span class="kw">sum</span>(SexF <span class="op">+</span><span class="st"> </span>SexM)</a></code></pre></div>
<pre><code>## [1] 303</code></pre>
</div>
<div id="checking-for-errors-in-columns-59-19-24-3134-must-be-0-or-1" class="section level4">
<h4>Checking for errors in columns 5:9, 19, 24, 31:34 (must be ‘0’ or ‘1’)</h4>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="co">#library(tidyverse)</span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="co">#library(dbplyr)</span></a>
<a class="sourceLine" id="cb22-3" title="3"></a>
<a class="sourceLine" id="cb22-4" title="4">Bins0 &lt;-<span class="st"> </span>FullSetB4<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-5" title="5"><span class="st">  </span><span class="kw">gather</span>(x, value, <span class="dv">5</span><span class="op">:</span><span class="dv">9</span>,<span class="dv">19</span>,<span class="dv">24</span>,<span class="dv">31</span><span class="op">:</span><span class="dv">34</span>)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-6" title="6"><span class="st">  </span><span class="kw">tally</span>(value <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb22-7" title="7">Bins1 &lt;-<span class="st"> </span>FullSetB4<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-8" title="8"><span class="st">  </span><span class="kw">gather</span>(x, value, <span class="dv">5</span><span class="op">:</span><span class="dv">9</span>,<span class="dv">19</span>,<span class="dv">24</span>,<span class="dv">31</span><span class="op">:</span><span class="dv">34</span>)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb22-9" title="9"><span class="st">  </span><span class="kw">tally</span>(value <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb22-10" title="10"> (Bins0 <span class="op">+</span><span class="st"> </span>Bins1)<span class="op">/</span><span class="dv">11</span></a></code></pre></div>
<pre><code>##     n
## 1 303</code></pre>
</div>
<div id="checking-for-errors-in-columns-1016-2023-25-2728-30-3536-must-be-y-or-n" class="section level4">
<h4>Checking for errors in columns 10:16, 20:23, 25, 27:28, 30, 35:36 (must be ‘Y’ or ‘N’)</h4>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">BinsY &lt;-<span class="st"> </span>FullSetB4<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-2" title="2"><span class="st">  </span><span class="kw">gather</span>(x, value, <span class="dv">10</span><span class="op">:</span><span class="dv">16</span>,<span class="dv">20</span><span class="op">:</span><span class="dv">23</span>,<span class="dv">25</span>,<span class="dv">27</span><span class="op">:</span><span class="dv">28</span>,<span class="dv">30</span>,<span class="dv">35</span><span class="op">:</span><span class="dv">36</span>)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-3" title="3"><span class="st">  </span><span class="kw">tally</span>(value <span class="op">==</span><span class="st"> &#39;Y&#39;</span>)</a>
<a class="sourceLine" id="cb24-4" title="4">BinsN &lt;-<span class="st"> </span>FullSetB4<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-5" title="5"><span class="st">  </span><span class="kw">gather</span>(x, value, <span class="dv">10</span><span class="op">:</span><span class="dv">16</span>,<span class="dv">20</span><span class="op">:</span><span class="dv">23</span>,<span class="dv">25</span>,<span class="dv">27</span><span class="op">:</span><span class="dv">28</span>,<span class="dv">30</span>,<span class="dv">35</span><span class="op">:</span><span class="dv">36</span>)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-6" title="6"><span class="st">  </span><span class="kw">tally</span>(value <span class="op">==</span><span class="st"> &#39;N&#39;</span>)</a>
<a class="sourceLine" id="cb24-7" title="7"> (BinsY <span class="op">+</span><span class="st"> </span>BinsN)<span class="op">/</span><span class="dv">17</span></a></code></pre></div>
<pre><code>##     n
## 1 303</code></pre>
</div>
<div id="checking-for-errors-in-the-bbbbundle-branch-block-attribute-column-37" class="section level4">
<h4>Checking for errors in the ‘BBB’(Bundle Branch Block) attribute (column 37):</h4>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">nBBB &lt;-<span class="st"> </span><span class="kw">sum</span>(FullSetB4<span class="op">$</span>BBB <span class="op">==</span><span class="st"> &#39;N&#39;</span>)</a>
<a class="sourceLine" id="cb26-2" title="2">LBBB &lt;-<span class="st"> </span><span class="kw">sum</span>(FullSetB4<span class="op">$</span>BBB <span class="op">==</span><span class="st"> &#39;LBBB&#39;</span>)</a>
<a class="sourceLine" id="cb26-3" title="3">RBBB &lt;-<span class="st"> </span><span class="kw">sum</span>(FullSetB4<span class="op">$</span>BBB <span class="op">==</span><span class="st"> &#39;RBBB&#39;</span>)</a>
<a class="sourceLine" id="cb26-4" title="4"><span class="kw">sum</span>(nBBB<span class="op">+</span>LBBB<span class="op">+</span>RBBB)</a></code></pre></div>
<pre><code>## [1] 303</code></pre>
</div>
<div id="checking-for-errors-in-the-vhdvalvular-heart-disease-attribute-column-54" class="section level4">
<h4>Checking for errors in the ‘VHD’(Valvular Heart Disease) attribute (column 54):</h4>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">Vmild &lt;-<span class="st"> </span><span class="kw">sum</span>(FullSetB4<span class="op">$</span>VHD <span class="op">==</span><span class="st"> &#39;mild&#39;</span>)</a>
<a class="sourceLine" id="cb28-2" title="2">VMod &lt;-<span class="st"> </span><span class="kw">sum</span>(FullSetB4<span class="op">$</span>VHD <span class="op">==</span><span class="st"> &#39;Moderate&#39;</span>)</a>
<a class="sourceLine" id="cb28-3" title="3">VN &lt;-<span class="st"> </span><span class="kw">sum</span>(FullSetB4<span class="op">$</span>VHD <span class="op">==</span><span class="st"> &#39;N&#39;</span>)</a>
<a class="sourceLine" id="cb28-4" title="4">VSev &lt;-<span class="st"> </span><span class="kw">sum</span>(FullSetB4<span class="op">$</span>VHD <span class="op">==</span><span class="st"> &#39;Severe&#39;</span>)</a>
<a class="sourceLine" id="cb28-5" title="5"><span class="kw">sum</span>(Vmild<span class="op">+</span>VMod<span class="op">+</span>VN<span class="op">+</span>VSev)</a></code></pre></div>
<pre><code>## [1] 303</code></pre>
</div>
<div id="converting-int-types-to-factor-where-appropriate" class="section level4">
<h4>Converting int types to factor, where appropriate:</h4>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">Allv1 &lt;-<span class="st"> </span>FullSetB4</a>
<a class="sourceLine" id="cb30-2" title="2">Allv1<span class="op">$</span>DM &lt;-<span class="st"> </span><span class="kw">as.factor</span>(Allv1<span class="op">$</span>DM)</a>
<a class="sourceLine" id="cb30-3" title="3">Allv1<span class="op">$</span>HTN &lt;-<span class="st"> </span><span class="kw">as.factor</span>(Allv1<span class="op">$</span>HTN)</a>
<a class="sourceLine" id="cb30-4" title="4">Allv1<span class="op">$</span>Smoker &lt;-<span class="st"> </span><span class="kw">as.factor</span>(Allv1<span class="op">$</span>Smoker)</a>
<a class="sourceLine" id="cb30-5" title="5">Allv1<span class="op">$</span>ExSmoker &lt;-<span class="st"> </span><span class="kw">as.factor</span>(Allv1<span class="op">$</span>ExSmoker)</a>
<a class="sourceLine" id="cb30-6" title="6">Allv1<span class="op">$</span>FH &lt;-<span class="st"> </span><span class="kw">as.factor</span>(Allv1<span class="op">$</span>FH)</a>
<a class="sourceLine" id="cb30-7" title="7">Allv1<span class="op">$</span>Edema &lt;-<span class="st"> </span><span class="kw">as.factor</span>(Allv1<span class="op">$</span>Edema)</a>
<a class="sourceLine" id="cb30-8" title="8">Allv1<span class="op">$</span>TCP &lt;-<span class="st"> </span><span class="kw">as.factor</span>(Allv1<span class="op">$</span>TCP)</a>
<a class="sourceLine" id="cb30-9" title="9">Allv1<span class="op">$</span>QWave &lt;-<span class="st"> </span><span class="kw">as.factor</span>(Allv1<span class="op">$</span>QWave)</a>
<a class="sourceLine" id="cb30-10" title="10">Allv1<span class="op">$</span>STelev &lt;-<span class="st"> </span><span class="kw">as.factor</span>(Allv1<span class="op">$</span>STelev)</a>
<a class="sourceLine" id="cb30-11" title="11">Allv1<span class="op">$</span>STdep &lt;-<span class="st"> </span><span class="kw">as.factor</span>(Allv1<span class="op">$</span>STdep)</a>
<a class="sourceLine" id="cb30-12" title="12">Allv1<span class="op">$</span>Tinv &lt;-<span class="st"> </span><span class="kw">as.factor</span>(Allv1<span class="op">$</span>Tinv)</a>
<a class="sourceLine" id="cb30-13" title="13"><span class="co">#str(Allv1)</span></a></code></pre></div>
</div>
</div>
<div id="discretizing" class="section level3">
<h3>DISCRETIZING:</h3>
<div id="change-age-attribute-to-factor-if-male-and-age-is-to-45-or-if-female-and-age-is-55-categorize-as-med-for-medium.-if-male-and-age-is-45-or-female-and-age-is-55-categorize-as-high." class="section level4">
<h4>Change age attribute to factor: If male and age is &lt;= to 45, OR if female and age is &lt;= 55; categorize as “med” (for ‘medium’). If male and age is &gt; 45 or female and age is &gt; 55, categorize as “high”.</h4>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1">Allv1<span class="op">$</span>Age &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">ifelse</span>(Allv1<span class="op">$</span>Age <span class="op">&lt;=</span><span class="st"> </span><span class="dv">45</span> <span class="op">&amp;</span><span class="st"> </span>Allv1<span class="op">$</span>Sex <span class="op">==</span><span class="st"> &#39;Male&#39;</span> <span class="op">|</span><span class="st"> </span>Allv1<span class="op">$</span>Age <span class="op">&lt;=</span><span class="st"> </span><span class="dv">55</span> <span class="op">&amp;</span><span class="st"> </span>Allv1<span class="op">$</span>Sex <span class="op">==</span><span class="st"> &#39;Fmale&#39;</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>))</a>
<a class="sourceLine" id="cb31-2" title="2"><span class="kw">str</span>(Allv1)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    303 obs. of  55 variables:
##  $ Age     : Factor w/ 2 levels &quot;High&quot;,&quot;Med&quot;: 1 1 1 1 2 1 1 1 1 1 ...
##  $ Weight  : int  90 70 54 67 87 75 80 80 84 71 ...
##  $ Sex     : Factor w/ 2 levels &quot;Fmale&quot;,&quot;Male&quot;: 2 1 2 1 1 2 2 2 1 2 ...
##  $ BMI     : num  29.4 28.4 20.1 26.8 37.2 ...
##  $ DM      : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 1 1 1 1 2 1 2 ...
##  $ HTN     : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 2 2 1 2 2 1 1 1 1 1 ...
##  $ Smoker  : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 2 1 2 1 1 2 1 2 1 1 ...
##  $ ExSmoker: Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 1 1 1 2 1 1 1 ...
##  $ FH      : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Obesity : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 2 2 1 2 2 1 2 2 2 1 ...
##  $ CRF     : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ CVA     : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ AD      : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ TD      : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ CHF     : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ DLP     : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 2 1 1 1 1 1 1 2 1 1 ...
##  $ BP      : int  110 140 100 100 110 118 110 130 90 130 ...
##  $ PR      : int  80 80 100 80 80 70 80 70 50 70 ...
##  $ Edema   : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 2 1 1 1 1 1 1 1 1 ...
##  $ WPP     : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ LR      : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ SysM    : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 2 1 2 1 1 1 ...
##  $ DiaM    : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 2 1 1 1 1 1 1 ...
##  $ TCP     : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 2 2 1 1 2 2 2 1 2 ...
##  $ Dyspnea : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 2 2 1 1 1 2 2 ...
##  $ Fclass  : int  0 0 0 3 2 3 0 0 0 2 ...
##  $ ACP     : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NCP     : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 2 1 1 1 1 2 1 ...
##  $ ECP     : Factor w/ 1 level &quot;N&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ LTAng   : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ QWave   : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 1 1 1 2 1 1 1 ...
##  $ STelev  : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 1 1 1 2 1 1 1 ...
##  $ STdep   : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 2 2 1 2 1 1 1 2 1 1 ...
##  $ Tinv    : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 2 2 1 1 1 1 2 2 1 1 ...
##  $ LVH     : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ PoorR   : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ BBB     : Factor w/ 3 levels &quot;LBBB&quot;,&quot;N&quot;,&quot;RBBB&quot;: 2 2 2 2 2 2 2 2 2 1 ...
##  $ FBS     : int  90 80 85 78 104 86 80 130 69 209 ...
##  $ Cr      : num  0.7 1 1 1.2 1 1 0.8 0.9 0.6 1.3 ...
##  $ TG      : int  250 309 103 63 170 139 83 80 79 80 ...
##  $ LDL     : int  155 121 70 55 110 119 85 90 90 90 ...
##  $ HDL     : num  30 36 45 27 50 34 34 55 59 44 ...
##  $ BUN     : int  8 30 17 30 16 13 12 19 15 16 ...
##  $ ESR     : int  7 26 10 76 27 18 38 4 5 8 ...
##  $ Hb      : num  15.6 13.9 13.5 12.1 13.2 15.6 14.1 16.1 11.6 13.9 ...
##  $ K       : num  4.7 4.7 4.7 4.4 4 4.2 4.8 4.3 3.4 4.6 ...
##  $ Na      : int  141 156 139 142 140 141 139 142 139 140 ...
##  $ WBC     : int  5700 7700 7400 13000 9200 7300 9400 12200 5100 4900 ...
##  $ Lymph   : int  39 38 38 18 55 26 58 25 49 55 ...
##  $ Neut    : int  52 55 60 72 39 66 33 74 50 42 ...
##  $ PLT     : int  261 165 230 742 274 194 292 410 370 380 ...
##  $ EF      : int  50 40 40 55 50 50 40 45 50 40 ...
##  $ RWMA    : int  0 4 2 0 0 0 4 4 0 2 ...
##  $ VHD     : Factor w/ 4 levels &quot;mild&quot;,&quot;Moderate&quot;,..: 3 3 1 4 4 3 1 1 3 3 ...
##  $ CAD     : Factor w/ 2 levels &quot;Cad&quot;,&quot;Normal&quot;: 1 1 1 2 2 1 1 1 2 1 ...</code></pre>
</div>
<div id="checking-for-any-errors-in-age-factor-values-and-the-proportion-of-medium-to-high-ages-after-being-discretized" class="section level4">
<h4>Checking for any errors in Age factor values, and the proportion of ‘medium’ to ‘high’ ages (after being discretized):</h4>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">MedAge &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv1<span class="op">$</span>Age <span class="op">==</span><span class="st"> &#39;Med&#39;</span>)</a>
<a class="sourceLine" id="cb33-2" title="2">HighAge &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv1<span class="op">$</span>Age <span class="op">==</span><span class="st"> &#39;High&#39;</span>)</a>
<a class="sourceLine" id="cb33-3" title="3"><span class="kw">sum</span>(MedAge<span class="op">+</span>HighAge)</a></code></pre></div>
<pre><code>## [1] 303</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1">(MedAge<span class="op">/</span>(MedAge<span class="op">+</span>HighAge))<span class="op">*</span><span class="dv">100</span></a></code></pre></div>
<pre><code>## [1] 21.45215</code></pre>
</div>
<div id="discretize-weight-for-males-vs-females.-these-discretized-ranges-were-not-specified-in-the-original-study-so-i-am-using-the-mean-and-the-factoring-into-belowave-or-above-high-the-group-average" class="section level4">
<h4>Discretize Weight for males vs females. These discretized ranges were not specified in the original study, so I am using the mean and the factoring into ‘below’(“Ave”) or ‘above’ (“High”) the group average:</h4>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="kw">tapply</span>(Allv1<span class="op">$</span>Weight, Allv1<span class="op">$</span>Sex, mean)</a></code></pre></div>
<pre><code>##    Fmale     Male 
## 70.52756 76.21591</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">Allv1<span class="op">$</span>Weight &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">ifelse</span>(Allv1<span class="op">$</span>Weight <span class="op">&lt;=</span><span class="st"> </span><span class="fl">76.2</span> <span class="op">&amp;</span><span class="st"> </span>Allv1<span class="op">$</span>Sex <span class="op">==</span><span class="st"> &#39;Male&#39;</span> <span class="op">|</span><span class="st"> </span>Allv1<span class="op">$</span>Weight <span class="op">&lt;=</span><span class="st"> </span><span class="fl">70.5</span> <span class="op">&amp;</span><span class="st"> </span>Allv1<span class="op">$</span>Sex <span class="op">==</span><span class="st"> &#39;Fmale&#39;</span>, <span class="st">&quot;Ave&quot;</span>, <span class="st">&quot;High&quot;</span>))</a></code></pre></div>
</div>
<div id="discretize-blood-pressure-bp" class="section level4">
<h4>Discretize Blood Pressure (BP):</h4>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="kw">max</span>(Allv1<span class="op">$</span>BP)</a></code></pre></div>
<pre><code>## [1] 190</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">Allv1<span class="op">$</span>BP &lt;-<span class="st"> </span><span class="kw">cut</span>(Allv1<span class="op">$</span>BP, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">89</span>,<span class="dv">140</span>,<span class="dv">200</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>))</a>
<a class="sourceLine" id="cb42-2" title="2"></a>
<a class="sourceLine" id="cb42-3" title="3">BPlow &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv1<span class="op">$</span>BP <span class="op">==</span><span class="st"> &quot;Low&quot;</span>)</a>
<a class="sourceLine" id="cb42-4" title="4">BPlow</a></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1">BPmed &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv1<span class="op">$</span>BP <span class="op">==</span><span class="st"> &quot;Med&quot;</span>)</a>
<a class="sourceLine" id="cb44-2" title="2">BPmed</a></code></pre></div>
<pre><code>## [1] 255</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1">BPhigh &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv1<span class="op">$</span>BP <span class="op">==</span><span class="st"> &quot;High&quot;</span>)</a>
<a class="sourceLine" id="cb46-2" title="2">BPhigh</a></code></pre></div>
<pre><code>## [1] 48</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1">BPcount &lt;-<span class="st"> </span><span class="kw">sum</span>(BPlow<span class="op">+</span>BPmed<span class="op">+</span>BPhigh)</a>
<a class="sourceLine" id="cb48-2" title="2">BPcount</a></code></pre></div>
<pre><code>## [1] 303</code></pre>
</div>
<div id="note-that-no-patients-had-a-low-blood-pressure.-check-the-proportion-of-medium-to-high-blood-pressure-results" class="section level4">
<h4>Note that no patients had a ‘low’ blood pressure. Check the proportion of medium to high blood pressure results:</h4>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1">(BPmed<span class="op">/</span>(BPmed<span class="op">+</span>BPhigh))<span class="op">*</span><span class="dv">100</span></a></code></pre></div>
<pre><code>## [1] 84.15842</code></pre>
</div>
<div id="discretize-pulse-rate-pr.-note-very-low-variation-in-pulse-rate-98.3-was-categorized-with-a-medium-heart-rate.-this-would-make-the-pulse-rate-attribute-a-good-candidate-for-removal." class="section level4">
<h4>Discretize Pulse Rate (PR). Note: Very low variation in pulse rate (98.3% was categorized with a ‘medium’ heart rate). THis would make the ‘Pulse rate’ attribute a good candidate for removal.</h4>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="kw">max</span>(Allv1<span class="op">$</span>PR)</a></code></pre></div>
<pre><code>## [1] 110</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1">Allv1<span class="op">$</span>PR &lt;-<span class="st"> </span><span class="kw">cut</span>(Allv1<span class="op">$</span>PR, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">59</span>,<span class="dv">100</span>,<span class="dv">200</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>))</a>
<a class="sourceLine" id="cb54-2" title="2"></a>
<a class="sourceLine" id="cb54-3" title="3">PRlow &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv1<span class="op">$</span>PR <span class="op">==</span><span class="st"> &quot;Low&quot;</span>)</a>
<a class="sourceLine" id="cb54-4" title="4">PRlow</a></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1">PRmed &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv1<span class="op">$</span>PR <span class="op">==</span><span class="st"> &quot;Med&quot;</span>)</a>
<a class="sourceLine" id="cb56-2" title="2">PRmed</a></code></pre></div>
<pre><code>## [1] 298</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1">PRhigh &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv1<span class="op">$</span>PR <span class="op">==</span><span class="st"> &quot;High&quot;</span>)</a>
<a class="sourceLine" id="cb58-2" title="2">PRhigh</a></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1">PRcount &lt;-<span class="st"> </span><span class="kw">sum</span>(PRlow<span class="op">+</span>PRmed<span class="op">+</span>PRhigh)</a>
<a class="sourceLine" id="cb60-2" title="2">PRcount</a></code></pre></div>
<pre><code>## [1] 303</code></pre>
</div>
<div id="discretize-heart-rate-functional-class-fclass-class-0-equals-med-and-classes-1-2-and-3-equal-high.-note-that-69.6-of-the-patients-were-evaluated-to-have-a-medium-heart-failure-functional-class." class="section level4">
<h4>Discretize Heart Rate Functional Class (Fclass): Class 0 equals ‘Med’ and classes 1, 2, and 3 equal ‘High’. Note that 69.6% of the patients were evaluated to have a “Medium” Heart Failure Functional Class.</h4>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="kw">sum</span>(Allv1<span class="op">$</span>Fclass <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## [1] 211</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1">Allv1<span class="op">$</span>Fclass &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">ifelse</span>(Allv1<span class="op">$</span>Fclass <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>))</a>
<a class="sourceLine" id="cb64-2" title="2"></a>
<a class="sourceLine" id="cb64-3" title="3">FCmed &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv1<span class="op">$</span>Fclass <span class="op">==</span><span class="st"> &quot;Med&quot;</span>)</a>
<a class="sourceLine" id="cb64-4" title="4">FCmed</a></code></pre></div>
<pre><code>## [1] 211</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1">FChigh &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv1<span class="op">$</span>Fclass <span class="op">==</span><span class="st"> &quot;High&quot;</span>)</a>
<a class="sourceLine" id="cb66-2" title="2">FChigh</a></code></pre></div>
<pre><code>## [1] 92</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1"><span class="kw">sum</span>(FCmed<span class="op">+</span>FChigh)</a></code></pre></div>
<pre><code>## [1] 303</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1">(FCmed<span class="op">/</span>(FCmed<span class="op">+</span>FChigh))<span class="op">*</span><span class="dv">100</span></a></code></pre></div>
<pre><code>## [1] 69.63696</code></pre>
</div>
<div id="count-the-levels-and-results-of-the-exertional-chest-pain-ecp-attribute-yesno-entries." class="section level4">
<h4>Count the levels and results of the ‘Exertional Chest Pain’ (ECP) attribute (yes/no entries).</h4>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1"><span class="kw">nlevels</span>(Allv1<span class="op">$</span>ECP)</a></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="kw">sum</span>(Allv1<span class="op">$</span>ECP <span class="op">==</span><span class="st"> &#39;N&#39;</span>)</a></code></pre></div>
<pre><code>## [1] 303</code></pre>
</div>
<div id="deleting-this-attribute-given-that-there-is-no-variation-in-the-results-and-as-such-does-not-improve-predictive-effectiveness" class="section level4">
<h4>Deleting this attribute given that there is no variation in the results, and as such, does not improve predictive effectiveness:</h4>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1">Allv1<span class="op">$</span>ECP &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb76-2" title="2">Allv2 &lt;-<span class="st"> </span>Allv1</a></code></pre></div>
</div>
<div id="checking-bundle-branch-block-bbb-for-the-numbers-of-lbbb-and-rbbb-results-there-are-in-the-total-93-of-patients-had-no-bbb." class="section level4">
<h4>Checking ‘Bundle Branch Block’ (BBB) for the numbers of LBBB and RBBB results there are in the total (93% of patients had no BBB).</h4>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1"><span class="kw">sum</span>(Allv2<span class="op">$</span>BBB <span class="op">==</span><span class="st"> &#39;N&#39;</span>)</a></code></pre></div>
<pre><code>## [1] 282</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1"><span class="kw">sum</span>(Allv2<span class="op">$</span>BBB <span class="op">==</span><span class="st"> &#39;LBBB&#39;</span>)</a></code></pre></div>
<pre><code>## [1] 13</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1"><span class="kw">sum</span>(Allv2<span class="op">$</span>BBB <span class="op">==</span><span class="st"> &#39;RBBB&#39;</span>)</a></code></pre></div>
<pre><code>## [1] 8</code></pre>
</div>
<div id="discretizing-the-fasting-blood-sugar-attribute-into-low-med-and-high" class="section level4">
<h4>Discretizing the ‘Fasting Blood Sugar’ attribute into ‘low’, ‘med’ and ‘high’:</h4>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1"><span class="kw">max</span>(Allv2<span class="op">$</span>FBS)</a></code></pre></div>
<pre><code>## [1] 400</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1">Allv2<span class="op">$</span>FBS &lt;-<span class="st"> </span><span class="kw">cut</span>(Allv2<span class="op">$</span>FBS, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">69</span>,<span class="dv">105</span>,<span class="dv">500</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>))</a>
<a class="sourceLine" id="cb85-2" title="2"></a>
<a class="sourceLine" id="cb85-3" title="3">FBSlow &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>FBS <span class="op">==</span><span class="st"> &quot;Low&quot;</span>)</a>
<a class="sourceLine" id="cb85-4" title="4">FBSlow</a></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1">FBSmed &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>FBS <span class="op">==</span><span class="st"> &quot;Med&quot;</span>)</a>
<a class="sourceLine" id="cb87-2" title="2">FBSmed</a></code></pre></div>
<pre><code>## [1] 179</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1">FBShigh &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>FBS <span class="op">==</span><span class="st"> &quot;High&quot;</span>)</a>
<a class="sourceLine" id="cb89-2" title="2">FBShigh</a></code></pre></div>
<pre><code>## [1] 121</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1">FBScount &lt;-<span class="st"> </span><span class="kw">sum</span>(FBSlow<span class="op">+</span>FBSmed<span class="op">+</span>FBShigh)</a>
<a class="sourceLine" id="cb91-2" title="2">FBScount</a></code></pre></div>
<pre><code>## [1] 303</code></pre>
</div>
<div id="discretizing-the-creatine-attribute-into-low-med-and-high" class="section level4">
<h4>Discretizing the ‘Creatine’ attribute into ‘low’, ‘med’ and ‘high’:</h4>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1"><span class="kw">max</span>(Allv2<span class="op">$</span>Cr)</a></code></pre></div>
<pre><code>## [1] 2.2</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1">Allv2<span class="op">$</span>Cr &lt;-<span class="st"> </span><span class="kw">cut</span>(Allv2<span class="op">$</span>Cr, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.69</span>,<span class="fl">1.5</span>,<span class="fl">2.5</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>))</a>
<a class="sourceLine" id="cb95-2" title="2"></a>
<a class="sourceLine" id="cb95-3" title="3">Crlow &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>Cr <span class="op">==</span><span class="st"> &quot;Low&quot;</span>)</a>
<a class="sourceLine" id="cb95-4" title="4">Crlow</a></code></pre></div>
<pre><code>## [1] 9</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1">Crmed &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>Cr <span class="op">==</span><span class="st"> &quot;Med&quot;</span>)</a>
<a class="sourceLine" id="cb97-2" title="2">Crmed</a></code></pre></div>
<pre><code>## [1] 281</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1">Crhigh &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>Cr <span class="op">==</span><span class="st"> &quot;High&quot;</span>)</a>
<a class="sourceLine" id="cb99-2" title="2">Crhigh</a></code></pre></div>
<pre><code>## [1] 13</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1">CrCount &lt;-<span class="st"> </span><span class="kw">sum</span>(Crlow<span class="op">+</span>Crmed<span class="op">+</span>Crhigh)</a>
<a class="sourceLine" id="cb101-2" title="2">CrCount</a></code></pre></div>
<pre><code>## [1] 303</code></pre>
</div>
<div id="discretizing-the-triglyceride-tg-variable-into-med-and-high" class="section level4">
<h4>Discretizing the Triglyceride (TG) variable into ‘med’ and ‘high’:</h4>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1"><span class="kw">max</span>(Allv2<span class="op">$</span>TG)</a></code></pre></div>
<pre><code>## [1] 1050</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1">Allv2<span class="op">$</span>TG &lt;-<span class="st"> </span><span class="kw">cut</span>(Allv2<span class="op">$</span>TG, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">200</span>,<span class="dv">1100</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>))</a>
<a class="sourceLine" id="cb105-2" title="2"></a>
<a class="sourceLine" id="cb105-3" title="3">TGmed &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>TG <span class="op">==</span><span class="st"> &quot;Med&quot;</span>)</a>
<a class="sourceLine" id="cb105-4" title="4">TGmed</a></code></pre></div>
<pre><code>## [1] 241</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1">TGhigh &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>TG <span class="op">==</span><span class="st"> &quot;High&quot;</span>)</a>
<a class="sourceLine" id="cb107-2" title="2">TGhigh</a></code></pre></div>
<pre><code>## [1] 62</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1">TGcount &lt;-<span class="st"> </span><span class="kw">sum</span>(TGmed<span class="op">+</span>TGhigh)</a>
<a class="sourceLine" id="cb109-2" title="2">TGcount</a></code></pre></div>
<pre><code>## [1] 303</code></pre>
</div>
<div id="discretizing-low-density-lipoprotein-ldl.-it-appears-that-the-results-of-the-cateorization-of-triglycerides-exactly-matches-that-of-ldl-hence-one-of-these-two-attributes-can-be-removed." class="section level4">
<h4>Discretizing Low Density Lipoprotein (LDL). It appears that the results of the cateorization of Triglycerides exactly matches that of LDL, hence, one of these two attributes can be removed.</h4>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1"><span class="kw">max</span>(Allv2<span class="op">$</span>LDL)</a></code></pre></div>
<pre><code>## [1] 232</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1">Allv2<span class="op">$</span>LDL &lt;-<span class="st"> </span><span class="kw">cut</span>(Allv2<span class="op">$</span>LDL, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">130</span>,<span class="dv">250</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>))</a>
<a class="sourceLine" id="cb113-2" title="2"></a>
<a class="sourceLine" id="cb113-3" title="3">LDLmed &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>LDL <span class="op">==</span><span class="st"> &quot;Med&quot;</span>)</a>
<a class="sourceLine" id="cb113-4" title="4">LDLmed</a></code></pre></div>
<pre><code>## [1] 241</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1">LDLhigh &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>LDL <span class="op">==</span><span class="st"> &quot;High&quot;</span>)</a>
<a class="sourceLine" id="cb115-2" title="2">LDLhigh</a></code></pre></div>
<pre><code>## [1] 62</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1">LDLcount &lt;-<span class="st"> </span><span class="kw">sum</span>(LDLmed<span class="op">+</span>LDLhigh)</a>
<a class="sourceLine" id="cb117-2" title="2">LDLcount</a></code></pre></div>
<pre><code>## [1] 303</code></pre>
</div>
<div id="discretizing-high-density-lipoprotein-hdl." class="section level4">
<h4>Discretizing High Density Lipoprotein (HDL).</h4>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1"><span class="kw">max</span>(Allv2<span class="op">$</span>HDL)</a></code></pre></div>
<pre><code>## [1] 111</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" title="1">Allv2<span class="op">$</span>HDL &lt;-<span class="st"> </span><span class="kw">cut</span>(Allv2<span class="op">$</span>HDL, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">34</span>,<span class="dv">120</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med&quot;</span>))</a>
<a class="sourceLine" id="cb121-2" title="2"></a>
<a class="sourceLine" id="cb121-3" title="3">HDLlow &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>HDL <span class="op">==</span><span class="st"> &quot;Low&quot;</span>)</a>
<a class="sourceLine" id="cb121-4" title="4">HDLlow</a></code></pre></div>
<pre><code>## [1] 87</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" title="1">HDLmed &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>HDL <span class="op">==</span><span class="st"> &quot;Med&quot;</span>)</a>
<a class="sourceLine" id="cb123-2" title="2">HDLmed</a></code></pre></div>
<pre><code>## [1] 216</code></pre>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" title="1">HDLcount &lt;-<span class="st"> </span><span class="kw">sum</span>(HDLlow<span class="op">+</span>HDLmed)</a>
<a class="sourceLine" id="cb125-2" title="2">HDLcount</a></code></pre></div>
<pre><code>## [1] 303</code></pre>
</div>
<div id="discretizing-blood-urea-nitrogen-bun" class="section level4">
<h4>Discretizing Blood Urea Nitrogen (BUN):</h4>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1"><span class="kw">max</span>(Allv2<span class="op">$</span>BUN)</a></code></pre></div>
<pre><code>## [1] 52</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1">Allv2<span class="op">$</span>BUN &lt;-<span class="st"> </span><span class="kw">cut</span>(Allv2<span class="op">$</span>BUN, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">6</span>,<span class="dv">20</span>,<span class="dv">55</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>))</a>
<a class="sourceLine" id="cb129-2" title="2"></a>
<a class="sourceLine" id="cb129-3" title="3">BUNlow &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>BUN <span class="op">==</span><span class="st"> &quot;Low&quot;</span>)</a>
<a class="sourceLine" id="cb129-4" title="4">BUNlow</a></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" title="1">BUNmed &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>BUN <span class="op">==</span><span class="st"> &quot;Med&quot;</span>)</a>
<a class="sourceLine" id="cb131-2" title="2">BUNmed</a></code></pre></div>
<pre><code>## [1] 229</code></pre>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" title="1">BUNhigh &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>BUN <span class="op">==</span><span class="st"> &quot;High&quot;</span>)</a>
<a class="sourceLine" id="cb133-2" title="2">BUNhigh</a></code></pre></div>
<pre><code>## [1] 73</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" title="1">BUNcount &lt;-<span class="st"> </span><span class="kw">sum</span>(BUNlow<span class="op">+</span>BUNmed<span class="op">+</span>BUNhigh)</a>
<a class="sourceLine" id="cb135-2" title="2">BUNcount</a></code></pre></div>
<pre><code>## [1] 303</code></pre>
</div>
<div id="taking-steps-to-discretize-erythrocyte-sedimentation-rate-esr.-if-male-and-esr-age2-or-if-female-and-esr-age25-then-esr-is-considered-mediium.-if-male-and-esr-is-age2-or-if-female-and-esr-age25-then-esr-is-considered-high" class="section level4">
<h4>Taking steps to discretize ‘Erythrocyte Sedimentation Rate’ (ESR). If male and ESR &lt;= age/2 OR if female and ESR &lt;= (age/2)+5 then ESR is considered “Mediium”. If male and ESR is &gt; age/2 OR if female and ESR &gt; (age/2)+5, then ESR is considered “High”:</h4>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" title="1">tempAge &lt;-<span class="st"> </span><span class="kw">data.frame</span>(FullSetB4[,<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dv">44</span>])</a>
<a class="sourceLine" id="cb137-2" title="2"></a>
<a class="sourceLine" id="cb137-3" title="3">tempAge<span class="op">$</span>Age &lt;-<span class="st"> </span><span class="kw">ifelse</span>(tempAge<span class="op">$</span>Sex <span class="op">==</span><span class="st"> &#39;Male&#39;</span>, tempAge<span class="op">$</span>Age<span class="op">/</span><span class="dv">2</span>, tempAge<span class="op">$</span>Age)</a>
<a class="sourceLine" id="cb137-4" title="4">tempAge2 &lt;-<span class="st"> </span>tempAge</a>
<a class="sourceLine" id="cb137-5" title="5"></a>
<a class="sourceLine" id="cb137-6" title="6">tempAge2<span class="op">$</span>Age &lt;-<span class="st"> </span><span class="kw">ifelse</span>(tempAge2<span class="op">$</span>Sex <span class="op">==</span><span class="st"> &#39;Fmale&#39;</span>, (tempAge2<span class="op">$</span>Age<span class="op">/</span><span class="dv">2</span>)<span class="op">+</span><span class="dv">5</span>, tempAge2<span class="op">$</span>Age)</a>
<a class="sourceLine" id="cb137-7" title="7"></a>
<a class="sourceLine" id="cb137-8" title="8">tempAge2<span class="op">$</span>ESR &lt;-<span class="st"> </span>FullSetB4<span class="op">$</span>ESR</a>
<a class="sourceLine" id="cb137-9" title="9">tempAge2<span class="op">$</span>Weight &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb137-10" title="10">tempAge3 &lt;-<span class="st"> </span>tempAge2</a>
<a class="sourceLine" id="cb137-11" title="11"></a>
<a class="sourceLine" id="cb137-12" title="12">tempAge3<span class="op">$</span>ESR &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">ifelse</span>(tempAge3<span class="op">$</span>ESR <span class="op">&lt;=</span><span class="st"> </span>tempAge3<span class="op">$</span>Age <span class="op">&amp;</span><span class="st"> </span>tempAge3<span class="op">$</span>Sex <span class="op">==</span><span class="st"> &#39;Male&#39;</span> <span class="op">|</span><span class="st"> </span>tempAge3<span class="op">$</span>ESR <span class="op">&lt;=</span><span class="st"> </span>tempAge3<span class="op">$</span>Age <span class="op">&amp;</span><span class="st"> </span>tempAge3<span class="op">$</span>Sex <span class="op">==</span><span class="st"> &#39;Fmale&#39;</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>))</a>
<a class="sourceLine" id="cb137-13" title="13"><span class="kw">str</span>(tempAge3)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    303 obs. of  3 variables:
##  $ Age: num  26.5 38.5 27 38 30 25 27.5 36 34 30 ...
##  $ Sex: Factor w/ 2 levels &quot;Fmale&quot;,&quot;Male&quot;: 2 1 2 1 1 2 2 2 1 2 ...
##  $ ESR: Factor w/ 2 levels &quot;High&quot;,&quot;Med&quot;: 2 2 2 1 2 2 1 2 2 2 ...</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" title="1">Allv2<span class="op">$</span>ESR &lt;-<span class="st"> </span>tempAge3<span class="op">$</span>ESR</a></code></pre></div>
</div>
<div id="discretizing-hemoglobin-hb.-if-male-hb-14-or-if-female-and-hb-is-12.5-then-hb-is-low.-if-male-hb-is-14-but-17-or-if-female-and-hb-is-12-but-15-then-hb-is-medium.-if-male-hb-17-or-if-female-and-hb-is-15-then-hb-is-high." class="section level4">
<h4>Discretizing Hemoglobin (Hb). If male &amp; Hb &lt; 14 or if female and Hb is &lt; 12.5, then Hb is “Low”. If male &amp; Hb is &gt;= 14 but &lt;= 17 OR if female and Hb is &gt;= 12 but &lt;= 15, then Hb is “Medium”. If male &amp; Hb &gt; 17 or if female and Hb is &gt; 15, then Hb is “High”.</h4>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" title="1">tempHb &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Allv2[,<span class="dv">3</span><span class="op">:</span><span class="dv">44</span>])</a>
<a class="sourceLine" id="cb140-2" title="2">tempHb[,<span class="dv">2</span><span class="op">:</span><span class="dv">41</span>] &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb140-3" title="3"></a>
<a class="sourceLine" id="cb140-4" title="4">tempHb<span class="op">$</span>Hb &lt;-<span class="st"> </span><span class="kw">with</span>(tempHb, <span class="kw">ifelse</span>(tempHb<span class="op">$</span>Sex <span class="op">==</span><span class="st"> &#39;Male&#39;</span> <span class="op">&amp;</span><span class="st"> </span>tempHb<span class="op">$</span>Hb <span class="op">&lt;</span><span class="st"> </span><span class="dv">14</span> <span class="op">|</span><span class="st"> </span>tempHb<span class="op">$</span>Sex <span class="op">==</span><span class="st"> &#39;Fmale&#39;</span> <span class="op">&amp;</span><span class="st"> </span>tempHb<span class="op">$</span>Hb <span class="op">&lt;</span><span class="st"> </span><span class="fl">12.5</span>, <span class="st">&quot;Low&quot;</span>, <span class="kw">ifelse</span>(tempHb<span class="op">$</span>Sex <span class="op">==</span><span class="st"> &#39;Male&#39;</span> <span class="op">&amp;</span><span class="st"> </span>tempHb<span class="op">$</span>Hb <span class="op">&gt;</span><span class="st"> </span><span class="dv">17</span> <span class="op">|</span><span class="st"> </span>tempHb<span class="op">$</span>Sex <span class="op">==</span><span class="st"> &#39;Fmale&#39;</span> <span class="op">&amp;</span><span class="st"> </span>tempHb<span class="op">$</span>Hb <span class="op">&gt;</span><span class="st"> </span><span class="dv">15</span>, <span class="st">&quot;High&quot;</span>, <span class="st">&quot;Med&quot;</span>)))</a>
<a class="sourceLine" id="cb140-5" title="5"></a>
<a class="sourceLine" id="cb140-6" title="6">Allv2<span class="op">$</span>Hb &lt;-<span class="st"> </span><span class="kw">as.factor</span>(tempHb<span class="op">$</span>Hb)</a>
<a class="sourceLine" id="cb140-7" title="7"><span class="co">#str(Allv2)</span></a></code></pre></div>
</div>
<div id="discretizing-potassium-k" class="section level4">
<h4>Discretizing Potassium (K):</h4>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" title="1"><span class="kw">max</span>(Allv2<span class="op">$</span>K)</a></code></pre></div>
<pre><code>## [1] 6.6</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" title="1">Allv2<span class="op">$</span>K &lt;-<span class="st"> </span><span class="kw">cut</span>(Allv2<span class="op">$</span>K, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">3.7</span>,<span class="fl">5.6</span>,<span class="fl">6.8</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>))</a>
<a class="sourceLine" id="cb143-2" title="2"></a>
<a class="sourceLine" id="cb143-3" title="3">Klow &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>K <span class="op">==</span><span class="st"> &quot;Low&quot;</span>)</a>
<a class="sourceLine" id="cb143-4" title="4">Klow</a></code></pre></div>
<pre><code>## [1] 36</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb145-1" title="1">Kmed &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>K <span class="op">==</span><span class="st"> &quot;Med&quot;</span>)</a>
<a class="sourceLine" id="cb145-2" title="2">Kmed</a></code></pre></div>
<pre><code>## [1] 266</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" title="1">Khigh &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>K <span class="op">==</span><span class="st"> &quot;High&quot;</span>)</a>
<a class="sourceLine" id="cb147-2" title="2">Khigh</a></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" title="1">Kcount &lt;-<span class="st"> </span><span class="kw">sum</span>(Klow<span class="op">+</span>Kmed<span class="op">+</span>Khigh)</a>
<a class="sourceLine" id="cb149-2" title="2">Kcount</a></code></pre></div>
<pre><code>## [1] 303</code></pre>
</div>
<div id="discretizing-sodium-na" class="section level4">
<h4>Discretizing Sodium (Na):</h4>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb151-1" title="1"><span class="kw">max</span>(Allv2<span class="op">$</span>Na)</a></code></pre></div>
<pre><code>## [1] 156</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb153-1" title="1">Allv2<span class="op">$</span>Na &lt;-<span class="st"> </span><span class="kw">cut</span>(Allv2<span class="op">$</span>Na, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">135</span>,<span class="dv">146</span>,<span class="dv">157</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>))</a>
<a class="sourceLine" id="cb153-2" title="2"></a>
<a class="sourceLine" id="cb153-3" title="3">NaLow &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>Na <span class="op">==</span><span class="st"> &quot;Low&quot;</span>)</a>
<a class="sourceLine" id="cb153-4" title="4">NaLow</a></code></pre></div>
<pre><code>## [1] 18</code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb155-1" title="1">NaMed &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>Na <span class="op">==</span><span class="st"> &quot;Med&quot;</span>)</a>
<a class="sourceLine" id="cb155-2" title="2">NaMed</a></code></pre></div>
<pre><code>## [1] 269</code></pre>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" title="1">NaHigh &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>Na <span class="op">==</span><span class="st"> &quot;High&quot;</span>)</a>
<a class="sourceLine" id="cb157-2" title="2">NaHigh</a></code></pre></div>
<pre><code>## [1] 16</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb159-1" title="1">NaCount &lt;-<span class="st"> </span><span class="kw">sum</span>(NaLow<span class="op">+</span>NaMed<span class="op">+</span>NaHigh)</a>
<a class="sourceLine" id="cb159-2" title="2">NaCount</a></code></pre></div>
<pre><code>## [1] 303</code></pre>
</div>
<div id="discretizing-white-blood-cell-wbc-count" class="section level4">
<h4>Discretizing White Blood Cell (WBC) count:</h4>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb161-1" title="1"><span class="kw">max</span>(Allv2<span class="op">$</span>WBC)</a></code></pre></div>
<pre><code>## [1] 18000</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb163-1" title="1">Allv2<span class="op">$</span>WBC &lt;-<span class="st"> </span><span class="kw">cut</span>(Allv2<span class="op">$</span>WBC, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">3999</span>,<span class="dv">11000</span>,<span class="dv">19000</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>))</a>
<a class="sourceLine" id="cb163-2" title="2"></a>
<a class="sourceLine" id="cb163-3" title="3">WBClow &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>WBC <span class="op">==</span><span class="st"> &quot;Low&quot;</span>)</a>
<a class="sourceLine" id="cb163-4" title="4">WBClow</a></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb165-1" title="1">WBCmed &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>WBC <span class="op">==</span><span class="st"> &quot;Med&quot;</span>)</a>
<a class="sourceLine" id="cb165-2" title="2">WBCmed</a></code></pre></div>
<pre><code>## [1] 276</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb167-1" title="1">WBChigh &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>WBC <span class="op">==</span><span class="st"> &quot;High&quot;</span>)</a>
<a class="sourceLine" id="cb167-2" title="2">WBChigh</a></code></pre></div>
<pre><code>## [1] 24</code></pre>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb169-1" title="1">WBCcount &lt;-<span class="st"> </span><span class="kw">sum</span>(WBClow<span class="op">+</span>WBCmed<span class="op">+</span>WBChigh)</a>
<a class="sourceLine" id="cb169-2" title="2">WBCcount</a></code></pre></div>
<pre><code>## [1] 303</code></pre>
</div>
<div id="discretizing-lymphocyte-lymph-percentage-results-see-reference-21-on-literature-review.-spreading-the-results-into-3-sections-low-med-and-high." class="section level4">
<h4>Discretizing Lymphocyte (Lymph) percentage results (See reference 21 on Literature Review). Spreading the results into 3 sections: ‘Low’, ‘Med’ and ‘High’.</h4>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb171-1" title="1"><span class="kw">max</span>(Allv2<span class="op">$</span>Lymph)</a></code></pre></div>
<pre><code>## [1] 60</code></pre>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb173-1" title="1">Allv2<span class="op">$</span>Lymph &lt;-<span class="st"> </span><span class="kw">cut</span>(Allv2<span class="op">$</span>Lymph, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">17</span>,<span class="dv">45</span>,<span class="dv">65</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>))</a>
<a class="sourceLine" id="cb173-2" title="2"></a>
<a class="sourceLine" id="cb173-3" title="3">LymphLow &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>Lymph <span class="op">==</span><span class="st"> &quot;Low&quot;</span>)</a>
<a class="sourceLine" id="cb173-4" title="4">LymphLow</a></code></pre></div>
<pre><code>## [1] 25</code></pre>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb175-1" title="1">LymphMed &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>Lymph <span class="op">==</span><span class="st"> &quot;Med&quot;</span>)</a>
<a class="sourceLine" id="cb175-2" title="2">LymphMed</a></code></pre></div>
<pre><code>## [1] 256</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb177-1" title="1">LymphHigh &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>Lymph <span class="op">==</span><span class="st"> &quot;High&quot;</span>)</a>
<a class="sourceLine" id="cb177-2" title="2">LymphHigh</a></code></pre></div>
<pre><code>## [1] 22</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb179-1" title="1">LymphCount &lt;-<span class="st"> </span><span class="kw">sum</span>(LymphLow<span class="op">+</span>LymphMed<span class="op">+</span>LymphHigh)</a>
<a class="sourceLine" id="cb179-2" title="2">LymphCount</a></code></pre></div>
<pre><code>## [1] 303</code></pre>
</div>
<div id="discretizing-neutrophil-neut-percentage-results-see-reference-22-on-literature-review.-spreading-the-results-into-3-sections-low-med-and-high." class="section level4">
<h4>Discretizing Neutrophil (Neut) percentage results (See reference 22 on Literature Review). Spreading the results into 3 sections: ‘Low’, ‘Med’ and ‘High’.</h4>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb181-1" title="1"><span class="kw">max</span>(Allv2<span class="op">$</span>Neut)</a></code></pre></div>
<pre><code>## [1] 89</code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb183-1" title="1">Allv2<span class="op">$</span>Neut &lt;-<span class="st"> </span><span class="kw">cut</span>(Allv2<span class="op">$</span>Neut, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">44</span>,<span class="dv">75</span>,<span class="dv">90</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>))</a>
<a class="sourceLine" id="cb183-2" title="2"></a>
<a class="sourceLine" id="cb183-3" title="3">NeutLow &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>Neut <span class="op">==</span><span class="st"> &quot;Low&quot;</span>)</a>
<a class="sourceLine" id="cb183-4" title="4">NeutLow</a></code></pre></div>
<pre><code>## [1] 16</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb185-1" title="1">NeutMed &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>Neut <span class="op">==</span><span class="st"> &quot;Med&quot;</span>)</a>
<a class="sourceLine" id="cb185-2" title="2">NeutMed</a></code></pre></div>
<pre><code>## [1] 264</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb187-1" title="1">NeutHigh &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>Neut <span class="op">==</span><span class="st"> &quot;High&quot;</span>)</a>
<a class="sourceLine" id="cb187-2" title="2">NeutHigh</a></code></pre></div>
<pre><code>## [1] 23</code></pre>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb189-1" title="1">NeutCount &lt;-<span class="st"> </span><span class="kw">sum</span>(NeutLow<span class="op">+</span>NeutMed<span class="op">+</span>NeutHigh)</a>
<a class="sourceLine" id="cb189-2" title="2">NeutCount</a></code></pre></div>
<pre><code>## [1] 303</code></pre>
</div>
<div id="discretizing-ejection-fraction-ef" class="section level4">
<h4>Discretizing Ejection Fraction (EF):</h4>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb191-1" title="1"><span class="kw">max</span>(Allv2<span class="op">$</span>EF)</a></code></pre></div>
<pre><code>## [1] 60</code></pre>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb193-1" title="1">Allv2<span class="op">$</span>EF &lt;-<span class="st"> </span><span class="kw">cut</span>(Allv2<span class="op">$</span>EF, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="dv">120</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med&quot;</span>))</a>
<a class="sourceLine" id="cb193-2" title="2"></a>
<a class="sourceLine" id="cb193-3" title="3">EFlow &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>EF <span class="op">==</span><span class="st"> &quot;Low&quot;</span>)</a>
<a class="sourceLine" id="cb193-4" title="4">EFlow</a></code></pre></div>
<pre><code>## [1] 197</code></pre>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb195-1" title="1">EFmed &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>EF <span class="op">==</span><span class="st"> &quot;Med&quot;</span>)</a>
<a class="sourceLine" id="cb195-2" title="2">EFmed</a></code></pre></div>
<pre><code>## [1] 106</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb197-1" title="1">EFcount &lt;-<span class="st"> </span><span class="kw">sum</span>(EFlow<span class="op">+</span>EFmed)</a>
<a class="sourceLine" id="cb197-2" title="2">EFcount</a></code></pre></div>
<pre><code>## [1] 303</code></pre>
</div>
<div id="discretizing-platelet-plt-count-note-96-of-patients-had-medium-counts" class="section level4">
<h4>Discretizing Platelet (PLT) count (Note: 96% of patients had ‘Medium’ counts)</h4>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb199-1" title="1"><span class="kw">max</span>(Allv2<span class="op">$</span>PLT)</a></code></pre></div>
<pre><code>## [1] 742</code></pre>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb201-1" title="1">Allv2<span class="op">$</span>PLT &lt;-<span class="st"> </span><span class="kw">cut</span>(Allv2<span class="op">$</span>PLT, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">149</span>,<span class="dv">450</span>,<span class="dv">750</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>))</a>
<a class="sourceLine" id="cb201-2" title="2"></a>
<a class="sourceLine" id="cb201-3" title="3">PLTlow &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>PLT <span class="op">==</span><span class="st"> &quot;Low&quot;</span>)</a>
<a class="sourceLine" id="cb201-4" title="4">PLTlow</a></code></pre></div>
<pre><code>## [1] 11</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb203-1" title="1">PLTmed &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>PLT <span class="op">==</span><span class="st"> &quot;Med&quot;</span>)</a>
<a class="sourceLine" id="cb203-2" title="2">PLTmed</a></code></pre></div>
<pre><code>## [1] 291</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb205-1" title="1">PLThigh &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>PLT <span class="op">==</span><span class="st"> &quot;High&quot;</span>)</a>
<a class="sourceLine" id="cb205-2" title="2">PLThigh</a></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb207-1" title="1">PLTcount &lt;-<span class="st"> </span><span class="kw">sum</span>(PLTlow<span class="op">+</span>PLTmed<span class="op">+</span>PLThigh)</a>
<a class="sourceLine" id="cb207-2" title="2">PLTcount</a></code></pre></div>
<pre><code>## [1] 303</code></pre>
</div>
<div id="discretizing-regional-wall-motion-abnormality-rwma.-rwma-0-is-med-rwma-to-0-are-high.-found-that-71.6-were-found-to-be-medium." class="section level4">
<h4>Discretizing Regional Wall Motion Abnormality (RWMA). RWMA = 0 is ‘Med’, RWMA != to 0 are ‘High’). Found that 71.6% were found to be ‘Medium’.</h4>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb209-1" title="1"><span class="kw">sum</span>(Allv2<span class="op">$</span>RWMA <span class="op">==</span><span class="st"> </span><span class="dv">0</span>)</a></code></pre></div>
<pre><code>## [1] 217</code></pre>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb211-1" title="1">Allv2<span class="op">$</span>RWMA &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">ifelse</span>(Allv2<span class="op">$</span>RWMA <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>))</a>
<a class="sourceLine" id="cb211-2" title="2"></a>
<a class="sourceLine" id="cb211-3" title="3">RWMAmed &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>RWMA <span class="op">==</span><span class="st"> &quot;Med&quot;</span>)</a>
<a class="sourceLine" id="cb211-4" title="4">RWMAmed</a></code></pre></div>
<pre><code>## [1] 217</code></pre>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb213-1" title="1">RWMAhigh &lt;-<span class="st"> </span><span class="kw">sum</span>(Allv2<span class="op">$</span>RWMA <span class="op">==</span><span class="st"> &quot;High&quot;</span>)</a>
<a class="sourceLine" id="cb213-2" title="2">RWMAhigh</a></code></pre></div>
<pre><code>## [1] 86</code></pre>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb215-1" title="1"><span class="kw">sum</span>(RWMAmed<span class="op">+</span>RWMAhigh)</a></code></pre></div>
<pre><code>## [1] 303</code></pre>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb217-1" title="1">(RWMAmed<span class="op">/</span>(RWMAmed<span class="op">+</span>RWMAhigh))<span class="op">*</span><span class="dv">100</span></a></code></pre></div>
<pre><code>## [1] 71.61716</code></pre>
</div>
<div id="removing-the-bmi-attribute-since-this-is-captured-in-the-obesity-attribute-given-that-a-bmi-result-that-is-over-25-is-considered-obese.-matching-the-removed-attributes-for-the-before-and-after-discretization-data-sets" class="section level4">
<h4>Removing the ‘BMI’ attribute since this is captured in the ‘Obesity’ attribute (given that a BMI result that is over 25 is considered ‘Obese’). Matching the removed attributes for the ‘before’ and ‘after’ (discretization) data sets:</h4>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb219-1" title="1">Allv2<span class="op">$</span>BMI &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb219-2" title="2"></a>
<a class="sourceLine" id="cb219-3" title="3">FullSetB4<span class="op">$</span>BMI &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb219-4" title="4">FullSetB4<span class="op">$</span>ECP &lt;-<span class="st"> </span><span class="ot">NULL</span></a></code></pre></div>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb220-1" title="1"><span class="co">#str(Allv2)</span></a></code></pre></div>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb221-1" title="1">AllvFinal &lt;-<span class="st"> </span>Allv2</a>
<a class="sourceLine" id="cb221-2" title="2">AllvFinal<span class="op">$</span>Age &lt;-<span class="st"> </span><span class="kw">factor</span>(AllvFinal<span class="op">$</span>Age, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>), <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb221-3" title="3">AllvFinal<span class="op">$</span>Weight &lt;-<span class="st"> </span><span class="kw">factor</span>(AllvFinal<span class="op">$</span>Weight, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Ave&quot;</span>, <span class="st">&quot;High&quot;</span>), <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb221-4" title="4">AllvFinal<span class="op">$</span>BP &lt;-<span class="st"> </span><span class="kw">factor</span>(AllvFinal<span class="op">$</span>BP, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>), <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb221-5" title="5">AllvFinal<span class="op">$</span>PR &lt;-<span class="st"> </span><span class="kw">factor</span>(AllvFinal<span class="op">$</span>PR, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>), <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb221-6" title="6">AllvFinal<span class="op">$</span>Fclass &lt;-<span class="st"> </span><span class="kw">factor</span>(AllvFinal<span class="op">$</span>Fclass, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>), <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb221-7" title="7">AllvFinal<span class="op">$</span>FBS &lt;-<span class="st"> </span><span class="kw">factor</span>(AllvFinal<span class="op">$</span>FBS, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>), <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb221-8" title="8">AllvFinal<span class="op">$</span>Cr &lt;-<span class="st"> </span><span class="kw">factor</span>(AllvFinal<span class="op">$</span>Cr, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>), <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb221-9" title="9">AllvFinal<span class="op">$</span>TG &lt;-<span class="st"> </span><span class="kw">factor</span>(AllvFinal<span class="op">$</span>TG, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>), <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb221-10" title="10">AllvFinal<span class="op">$</span>LDL &lt;-<span class="st"> </span><span class="kw">factor</span>(AllvFinal<span class="op">$</span>LDL, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>), <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb221-11" title="11">AllvFinal<span class="op">$</span>HDL &lt;-<span class="st"> </span><span class="kw">factor</span>(AllvFinal<span class="op">$</span>HDL, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med&quot;</span>), <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb221-12" title="12">AllvFinal<span class="op">$</span>BUN &lt;-<span class="st"> </span><span class="kw">factor</span>(AllvFinal<span class="op">$</span>BUN, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>), <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb221-13" title="13">AllvFinal<span class="op">$</span>ESR &lt;-<span class="st"> </span><span class="kw">factor</span>(AllvFinal<span class="op">$</span>ESR, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>), <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb221-14" title="14">AllvFinal<span class="op">$</span>Hb &lt;-<span class="st"> </span><span class="kw">factor</span>(AllvFinal<span class="op">$</span>Hb, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>), <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb221-15" title="15">AllvFinal<span class="op">$</span>K &lt;-<span class="st"> </span><span class="kw">factor</span>(AllvFinal<span class="op">$</span>K, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>), <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb221-16" title="16">AllvFinal<span class="op">$</span>Na &lt;-<span class="st"> </span><span class="kw">factor</span>(AllvFinal<span class="op">$</span>Na, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>), <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb221-17" title="17">AllvFinal<span class="op">$</span>WBC &lt;-<span class="st"> </span><span class="kw">factor</span>(AllvFinal<span class="op">$</span>WBC, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>), <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb221-18" title="18">AllvFinal<span class="op">$</span>Lymph &lt;-<span class="st"> </span><span class="kw">factor</span>(AllvFinal<span class="op">$</span>Lymph, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>), <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb221-19" title="19">AllvFinal<span class="op">$</span>Neut &lt;-<span class="st"> </span><span class="kw">factor</span>(AllvFinal<span class="op">$</span>Neut, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>), <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb221-20" title="20">AllvFinal<span class="op">$</span>PLT &lt;-<span class="st"> </span><span class="kw">factor</span>(AllvFinal<span class="op">$</span>PLT, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>), <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb221-21" title="21">AllvFinal<span class="op">$</span>EF &lt;-<span class="st"> </span><span class="kw">factor</span>(AllvFinal<span class="op">$</span>EF, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med&quot;</span>), <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb221-22" title="22">AllvFinal<span class="op">$</span>RWMA &lt;-<span class="st"> </span><span class="kw">factor</span>(AllvFinal<span class="op">$</span>RWMA, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>), <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb221-23" title="23">AllvFinal<span class="op">$</span>VHD &lt;-<span class="st"> </span><span class="kw">factor</span>(AllvFinal<span class="op">$</span>VHD, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;N&quot;</span>, <span class="st">&quot;mild&quot;</span>, <span class="st">&quot;Moderate&quot;</span>, <span class="st">&quot;Severe&quot;</span>), <span class="dt">ordered =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb221-24" title="24"></a>
<a class="sourceLine" id="cb221-25" title="25"><span class="kw">str</span>(AllvFinal)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    303 obs. of  53 variables:
##  $ Age     : Ord.factor w/ 2 levels &quot;Med&quot;&lt;&quot;High&quot;: 2 2 2 2 1 2 2 2 2 2 ...
##  $ Weight  : Ord.factor w/ 2 levels &quot;Ave&quot;&lt;&quot;High&quot;: 2 1 1 1 2 1 2 2 2 1 ...
##  $ Sex     : Factor w/ 2 levels &quot;Fmale&quot;,&quot;Male&quot;: 2 1 2 1 1 2 2 2 1 2 ...
##  $ DM      : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 1 1 1 1 2 1 2 ...
##  $ HTN     : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 2 2 1 2 2 1 1 1 1 1 ...
##  $ Smoker  : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 2 1 2 1 1 2 1 2 1 1 ...
##  $ ExSmoker: Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 1 1 1 2 1 1 1 ...
##  $ FH      : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Obesity : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 2 2 1 2 2 1 2 2 2 1 ...
##  $ CRF     : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ CVA     : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ AD      : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ TD      : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ CHF     : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ DLP     : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 2 1 1 1 1 1 1 2 1 1 ...
##  $ BP      : Ord.factor w/ 3 levels &quot;Low&quot;&lt;&quot;Med&quot;&lt;&quot;High&quot;: 2 2 2 2 2 2 2 2 2 2 ...
##  $ PR      : Ord.factor w/ 3 levels &quot;Low&quot;&lt;&quot;Med&quot;&lt;&quot;High&quot;: 2 2 2 2 2 2 2 2 1 2 ...
##  $ Edema   : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 2 1 1 1 1 1 1 1 1 ...
##  $ WPP     : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ LR      : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ SysM    : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 2 1 2 1 1 1 ...
##  $ DiaM    : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 2 1 1 1 1 1 1 ...
##  $ TCP     : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 2 2 1 1 2 2 2 1 2 ...
##  $ Dyspnea : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 2 2 1 1 1 2 2 ...
##  $ Fclass  : Ord.factor w/ 2 levels &quot;Med&quot;&lt;&quot;High&quot;: 1 1 1 2 2 2 1 1 1 2 ...
##  $ ACP     : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NCP     : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 2 1 1 1 1 2 1 ...
##  $ LTAng   : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ QWave   : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 1 1 1 2 1 1 1 ...
##  $ STelev  : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 1 1 1 2 1 1 1 ...
##  $ STdep   : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 2 2 1 2 1 1 1 2 1 1 ...
##  $ Tinv    : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 2 2 1 1 1 1 2 2 1 1 ...
##  $ LVH     : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ PoorR   : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ BBB     : Factor w/ 3 levels &quot;LBBB&quot;,&quot;N&quot;,&quot;RBBB&quot;: 2 2 2 2 2 2 2 2 2 1 ...
##  $ FBS     : Ord.factor w/ 3 levels &quot;Low&quot;&lt;&quot;Med&quot;&lt;&quot;High&quot;: 2 2 2 2 2 2 2 3 1 3 ...
##  $ Cr      : Ord.factor w/ 3 levels &quot;Low&quot;&lt;&quot;Med&quot;&lt;&quot;High&quot;: 2 2 2 2 2 2 2 2 1 2 ...
##  $ TG      : Ord.factor w/ 2 levels &quot;Med&quot;&lt;&quot;High&quot;: 2 2 1 1 1 1 1 1 1 1 ...
##  $ LDL     : Ord.factor w/ 2 levels &quot;Med&quot;&lt;&quot;High&quot;: 2 1 1 1 1 1 1 1 1 1 ...
##  $ HDL     : Ord.factor w/ 2 levels &quot;Low&quot;&lt;&quot;Med&quot;: 1 2 2 1 2 1 1 2 2 2 ...
##  $ BUN     : Ord.factor w/ 3 levels &quot;Low&quot;&lt;&quot;Med&quot;&lt;&quot;High&quot;: 2 3 2 3 2 2 2 2 2 2 ...
##  $ ESR     : Ord.factor w/ 2 levels &quot;Med&quot;&lt;&quot;High&quot;: 1 1 1 2 1 1 2 1 1 1 ...
##  $ Hb      : Ord.factor w/ 3 levels &quot;Low&quot;&lt;&quot;Med&quot;&lt;&quot;High&quot;: 2 2 1 1 2 2 2 2 1 1 ...
##  $ K       : Ord.factor w/ 3 levels &quot;Low&quot;&lt;&quot;Med&quot;&lt;&quot;High&quot;: 2 2 2 2 2 2 2 2 1 2 ...
##  $ Na      : Ord.factor w/ 3 levels &quot;Low&quot;&lt;&quot;Med&quot;&lt;&quot;High&quot;: 2 3 2 2 2 2 2 2 2 2 ...
##  $ WBC     : Ord.factor w/ 3 levels &quot;Low&quot;&lt;&quot;Med&quot;&lt;&quot;High&quot;: 2 2 2 3 2 2 2 3 2 2 ...
##  $ Lymph   : Ord.factor w/ 3 levels &quot;Low&quot;&lt;&quot;Med&quot;&lt;&quot;High&quot;: 2 2 2 2 3 2 3 2 3 3 ...
##  $ Neut    : Ord.factor w/ 3 levels &quot;Low&quot;&lt;&quot;Med&quot;&lt;&quot;High&quot;: 2 2 2 2 1 2 1 2 2 1 ...
##  $ PLT     : Ord.factor w/ 3 levels &quot;Low&quot;&lt;&quot;Med&quot;&lt;&quot;High&quot;: 2 2 2 3 2 2 2 2 2 2 ...
##  $ EF      : Ord.factor w/ 2 levels &quot;Low&quot;&lt;&quot;Med&quot;: 1 1 1 2 1 1 1 1 1 1 ...
##  $ RWMA    : Ord.factor w/ 2 levels &quot;Med&quot;&lt;&quot;High&quot;: 1 2 2 1 1 1 2 2 1 2 ...
##  $ VHD     : Ord.factor w/ 4 levels &quot;N&quot;&lt;&quot;mild&quot;&lt;&quot;Moderate&quot;&lt;..: 1 1 2 4 4 1 2 2 1 1 ...
##  $ CAD     : Factor w/ 2 levels &quot;Cad&quot;,&quot;Normal&quot;: 1 1 1 2 2 1 1 1 2 1 ...</code></pre>
</div>
<div id="taking-the-completed-and-discretized-allv2-data-frame-and-saving-it-as-4-separate-attribute-groups-data-frames-to-be-used-for-the-rest-of-the-predictionsmodeling.-keeping-the-dependent-result-cad-at-this-stage" class="section level4">
<h4>Taking the completed (and discretized) ‘Allv2’ data frame and saving it as 4 separate attribute groups (data frames); to be used for the rest of the predictions/modeling. Keeping the dependent result (CAD) at this stage:</h4>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb223-1" title="1">Demo &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Allv2[,<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>])</a>
<a class="sourceLine" id="cb223-2" title="2">Demo<span class="op">$</span>CAD &lt;-<span class="st"> </span>Allv2<span class="op">$</span>CAD</a>
<a class="sourceLine" id="cb223-3" title="3"></a>
<a class="sourceLine" id="cb223-4" title="4">Symptom &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Allv2[,<span class="dv">16</span><span class="op">:</span><span class="dv">28</span>])</a>
<a class="sourceLine" id="cb223-5" title="5">Symptom<span class="op">$</span>CAD &lt;-<span class="st"> </span>Allv2<span class="op">$</span>CAD</a>
<a class="sourceLine" id="cb223-6" title="6"></a>
<a class="sourceLine" id="cb223-7" title="7">ECG &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Allv2[,<span class="dv">29</span><span class="op">:</span><span class="dv">35</span>])</a>
<a class="sourceLine" id="cb223-8" title="8">ECG<span class="op">$</span>CAD &lt;-<span class="st"> </span>Allv2<span class="op">$</span>CAD</a>
<a class="sourceLine" id="cb223-9" title="9"></a>
<a class="sourceLine" id="cb223-10" title="10">LAB &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Allv2[,<span class="dv">36</span><span class="op">:</span><span class="dv">52</span>])</a>
<a class="sourceLine" id="cb223-11" title="11">LAB<span class="op">$</span>CAD &lt;-<span class="st"> </span>Allv2<span class="op">$</span>CAD</a></code></pre></div>
</div>
<div id="taking-the-data-set-before-discretizing-and-factoring-fullsetb4-and-saving-it-as-4-separate-attribute-groups-data-frames-to-be-used-for-analysis.-first-removing-the-ecp-and-bmi-attributes-to-match-the-discretized-data-set" class="section level4">
<h4>Taking the data set before discretizing and factoring (FullSetB4) and saving it as 4 separate attribute groups (data frames); to be used for analysis. First removing the ‘ECP’ and ‘BMI’ attributes (to match the discretized data set):</h4>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb224-1" title="1">FullSetB42 &lt;-<span class="st"> </span>FullSetB4</a>
<a class="sourceLine" id="cb224-2" title="2"></a>
<a class="sourceLine" id="cb224-3" title="3">DemoB4 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(FullSetB42[,<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>])</a>
<a class="sourceLine" id="cb224-4" title="4">DemoB4<span class="op">$</span>CAD &lt;-<span class="st"> </span>FullSetB42<span class="op">$</span>CAD</a>
<a class="sourceLine" id="cb224-5" title="5"></a>
<a class="sourceLine" id="cb224-6" title="6">SymptomB4 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(FullSetB42[,<span class="dv">16</span><span class="op">:</span><span class="dv">28</span>])</a>
<a class="sourceLine" id="cb224-7" title="7">SymptomB4<span class="op">$</span>CAD &lt;-<span class="st"> </span>FullSetB42<span class="op">$</span>CAD</a>
<a class="sourceLine" id="cb224-8" title="8"></a>
<a class="sourceLine" id="cb224-9" title="9">ECGB4 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(FullSetB42[,<span class="dv">29</span><span class="op">:</span><span class="dv">35</span>])</a>
<a class="sourceLine" id="cb224-10" title="10">ECGB4<span class="op">$</span>CAD &lt;-<span class="st"> </span>FullSetB42<span class="op">$</span>CAD</a>
<a class="sourceLine" id="cb224-11" title="11"></a>
<a class="sourceLine" id="cb224-12" title="12">LABB4 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(FullSetB42[,<span class="dv">36</span><span class="op">:</span><span class="dv">52</span>])</a>
<a class="sourceLine" id="cb224-13" title="13">LABB4<span class="op">$</span>CAD &lt;-<span class="st"> </span>FullSetB42<span class="op">$</span>CAD</a></code></pre></div>
</div>
</div>
<div id="univariate-analysis" class="section level3">
<h3>UNIVARIATE ANALYSIS:</h3>
<div id="correlation-coefficients-for-the-lab-results-show-no-correlation-other-than-the-negative-correlation-between-lymphocyte-and-neutrophil-results.-with-regards-to-this-inverse-relationship-an-abnormal-increase-in-one-kind-of-white-blood-cell-can-cause-a-decrease-in-another-kind.-both-abnormal-results-can-be-due-to-the-same-underlying-condition." class="section level4">
<h4>Correlation coefficients for the ‘LAB’ results show no correlation (other than the negative correlation between Lymphocyte and Neutrophil results). With regards to this inverse relationship, an abnormal increase in one kind of white blood cell can cause a decrease in another kind. Both abnormal results can be due to the same underlying condition.</h4>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb225-1" title="1"><span class="kw">library</span>(GGally)</a>
<a class="sourceLine" id="cb225-2" title="2"></a>
<a class="sourceLine" id="cb225-3" title="3">LABcor3 &lt;-<span class="st"> </span><span class="kw">ggcorr</span>(LABB4[<span class="dv">1</span><span class="op">:</span><span class="dv">15</span>], <span class="dt">palette =</span> <span class="st">&quot;RdY1Gn&quot;</span>, <span class="dt">label =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb225-4" title="4">LABcor3</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-46-1.png" width="672" /> #### Looking into the Neutrophil to Lymphocyte relationship further. Calculating the NLR (neutrophil-lymphocyte ratio) below. Reference # 24 shows that they have identified that the normal NLR values in an adult, non-geriatric, population in good health are between 0.78 and 3.53.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb226-1" title="1">NLR &lt;-<span class="st"> </span><span class="kw">data.frame</span>(FullSetB42[<span class="dv">48</span><span class="op">:</span><span class="dv">47</span>])</a>
<a class="sourceLine" id="cb226-2" title="2">NLR<span class="op">$</span>Ratio &lt;-<span class="st"> </span>NLR<span class="op">$</span>Neut<span class="op">/</span>NLR<span class="op">$</span>Lymph</a>
<a class="sourceLine" id="cb226-3" title="3"></a>
<a class="sourceLine" id="cb226-4" title="4"><span class="kw">min</span>(NLR<span class="op">$</span>Ratio)</a></code></pre></div>
<pre><code>## [1] 0.5689655</code></pre>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb228-1" title="1"><span class="kw">max</span>(NLR<span class="op">$</span>Ratio)</a></code></pre></div>
<pre><code>## [1] 12.14286</code></pre>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb230-1" title="1"><span class="kw">mean</span>(NLR<span class="op">$</span>Ratio)</a></code></pre></div>
<pre><code>## [1] 2.244218</code></pre>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb232-1" title="1">NLR<span class="op">$</span>Result &lt;-<span class="st"> </span><span class="kw">cut</span>(NLR<span class="op">$</span>Ratio, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.77</span>,<span class="fl">3.53</span>,<span class="fl">12.5</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Low&quot;</span>, <span class="st">&quot;Med&quot;</span>, <span class="st">&quot;High&quot;</span>))</a>
<a class="sourceLine" id="cb232-2" title="2"></a>
<a class="sourceLine" id="cb232-3" title="3">NLR<span class="op">$</span>CAD &lt;-<span class="st"> </span>FullSetB42<span class="op">$</span>CAD</a>
<a class="sourceLine" id="cb232-4" title="4"></a>
<a class="sourceLine" id="cb232-5" title="5">NLRlow &lt;-<span class="st"> </span><span class="kw">sum</span>(NLR<span class="op">$</span>Result <span class="op">==</span><span class="st"> &quot;Low&quot;</span>)</a>
<a class="sourceLine" id="cb232-6" title="6">NLRlow</a></code></pre></div>
<pre><code>## [1] 10</code></pre>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb234-1" title="1">NLRmed &lt;-<span class="st"> </span><span class="kw">sum</span>(NLR<span class="op">$</span>Result <span class="op">==</span><span class="st"> &quot;Med&quot;</span>)</a>
<a class="sourceLine" id="cb234-2" title="2">NLRmed</a></code></pre></div>
<pre><code>## [1] 257</code></pre>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb236-1" title="1">NLRhigh &lt;-<span class="st"> </span><span class="kw">sum</span>(NLR<span class="op">$</span>Result <span class="op">==</span><span class="st"> &quot;High&quot;</span>)</a>
<a class="sourceLine" id="cb236-2" title="2">NLRhigh</a></code></pre></div>
<pre><code>## [1] 36</code></pre>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb238-1" title="1">NLRcount &lt;-<span class="st"> </span><span class="kw">sum</span>(NLRlow<span class="op">+</span>NLRmed<span class="op">+</span>NLRhigh)</a>
<a class="sourceLine" id="cb238-2" title="2">NLRcount</a></code></pre></div>
<pre><code>## [1] 303</code></pre>
</div>
<div id="include-remaining-numeric-attributes-for-further-correlation-overview-shows-no-significant-correlation-results-other-than-what-was-already-found" class="section level4">
<h4>Include remaining numeric attributes for further correlation overview: Shows no significant correlation results, other than what was already found:</h4>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb240-1" title="1"><span class="kw">library</span>(GGally)</a>
<a class="sourceLine" id="cb240-2" title="2"></a>
<a class="sourceLine" id="cb240-3" title="3">Allints1 &lt;-<span class="st"> </span><span class="kw">ggcorr</span>(FullSetB42[,<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">16</span><span class="op">:</span><span class="dv">17</span>, <span class="dv">36</span><span class="op">:</span><span class="dv">50</span>)], <span class="dt">palette =</span> <span class="st">&quot;RdY1Gn&quot;</span>, <span class="dt">label =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb240-4" title="4">Allints1</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-48-1.png" width="672" /> #### Boxplot of Low Density Lipoprotein (LDL), High Density Lipoprotein (HDL), Blood Urea Nitrogen (BUN), and Erythrocyte Sedimentation Rate (ESR):</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb241-1" title="1"><span class="kw">attach</span>(LABB4)</a>
<a class="sourceLine" id="cb241-2" title="2"><span class="kw">boxplot</span>(LDL, HDL, BUN, ESR, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;cadetblue1&quot;</span>, <span class="st">&quot;antiquewhite&quot;</span>, <span class="st">&quot;chartreuse&quot;</span>, <span class="st">&quot;darkseagreen1&quot;</span>), <span class="dt">notch =</span> <span class="ot">TRUE</span>, <span class="dt">horizontal =</span> <span class="ot">FALSE</span>, <span class="dt">outline =</span> <span class="ot">TRUE</span>, <span class="dt">plot =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb241-3" title="3"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;LDL&quot;</span>, <span class="st">&quot;HDL&quot;</span>, <span class="st">&quot;BUN&quot;</span>, <span class="st">&quot;ESR&quot;</span>),<span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;cadetblue1&quot;</span>, <span class="st">&quot;antiquewhite&quot;</span>, <span class="st">&quot;chartreuse&quot;</span>, <span class="st">&quot;darkseagreen1&quot;</span>))</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-49-1.png" width="672" /> #### Boxplot of Sodium (Na), Lymphocyte % (Lymph), Neutrophil % (Neut), and Ejection Fraction % (EF):</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb242-1" title="1"><span class="kw">boxplot</span>(Na, Lymph, Neut, EF, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;indianred1&quot;</span>, <span class="st">&quot;antiquewhite&quot;</span>, <span class="st">&quot;chartreuse&quot;</span>, <span class="st">&quot;gold&quot;</span>), <span class="dt">notch =</span> <span class="ot">TRUE</span>, <span class="dt">horizontal =</span> <span class="ot">FALSE</span>, <span class="dt">outline =</span> <span class="ot">TRUE</span>, <span class="dt">plot =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb242-2" title="2"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Na&quot;</span>, <span class="st">&quot;Lymph&quot;</span>, <span class="st">&quot;Neut&quot;</span>, <span class="st">&quot;EF&quot;</span>),<span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;indianred1&quot;</span>, <span class="st">&quot;antiquewhite&quot;</span>, <span class="st">&quot;chartreuse&quot;</span>, <span class="st">&quot;gold&quot;</span>))</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-50-1.png" width="672" /> #### Boxplot of Triglyceride (TG), Platelet (PLT), and Fasting Blood Sugar (FBS):</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb243-1" title="1"><span class="kw">boxplot</span>(TG, PLT, FBS, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;aquamarine&quot;</span>,<span class="st">&quot;indianred1&quot;</span>, <span class="st">&quot;gray90&quot;</span>), <span class="dt">notch =</span> <span class="ot">TRUE</span>, <span class="dt">horizontal =</span> <span class="ot">FALSE</span>, <span class="dt">outline =</span> <span class="ot">TRUE</span>, <span class="dt">plot =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb243-2" title="2"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;TG&quot;</span>, <span class="st">&quot;PLT&quot;</span>, <span class="st">&quot;FBS&quot;</span>),<span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;aquamarine&quot;</span>,<span class="st">&quot;indianred1&quot;</span>, <span class="st">&quot;gray90&quot;</span>))</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-51-1.png" width="672" /> #### Boxplot of Hemoglobin (Hb), Potassium (K), and Creatine (Cr):</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb244-1" title="1"><span class="kw">boxplot</span>(Hb, K, Cr, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;aquamarine&quot;</span>,<span class="st">&quot;indianred1&quot;</span>, <span class="st">&quot;gray90&quot;</span>), <span class="dt">notch =</span> <span class="ot">TRUE</span>, <span class="dt">horizontal =</span> <span class="ot">FALSE</span>, <span class="dt">outline =</span> <span class="ot">TRUE</span>, <span class="dt">plot =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb244-2" title="2"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Hb&quot;</span>, <span class="st">&quot;K&quot;</span>, <span class="st">&quot;Cr&quot;</span>),<span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;aquamarine&quot;</span>,<span class="st">&quot;indianred1&quot;</span>, <span class="st">&quot;gray90&quot;</span>))</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-52-1.png" width="672" /> #### Boxplot of White Blood Cell (WBC) count:</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb245-1" title="1"><span class="kw">boxplot</span>(WBC, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;antiquewhite&quot;</span>), <span class="dt">notch =</span> <span class="ot">TRUE</span>, <span class="dt">horizontal =</span> <span class="ot">FALSE</span>, <span class="dt">outline =</span> <span class="ot">TRUE</span>, <span class="dt">plot =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb245-2" title="2"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;WBC&quot;</span>),<span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;antiquewhite&quot;</span>))</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-53-1.png" width="672" /> #### Boxplot to show distribution of Age and Weight:</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb246-1" title="1"><span class="kw">attach</span>(DemoB4)</a></code></pre></div>
<pre><code>## The following object is masked from LABB4:
## 
##     CAD</code></pre>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb248-1" title="1"><span class="kw">boxplot</span>(Age, Weight, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;aquamarine&quot;</span>,<span class="st">&quot;gray90&quot;</span>), <span class="dt">notch =</span> <span class="ot">TRUE</span>, <span class="dt">horizontal =</span> <span class="ot">FALSE</span>, <span class="dt">outline =</span> <span class="ot">TRUE</span>, <span class="dt">plot =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb248-2" title="2"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Age&quot;</span>, <span class="st">&quot;Weight&quot;</span>),<span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;aquamarine&quot;</span>,<span class="st">&quot;gray90&quot;</span>))</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
</div>
<div id="describe-continuous-variables" class="section level4">
<h4>Describe continuous variables:</h4>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb249-1" title="1"><span class="kw">library</span>(psych)</a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;psych&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:Hmisc&#39;:
## 
##     describe</code></pre>
<pre><code>## The following object is masked from &#39;package:effsize&#39;:
## 
##     cohen.d</code></pre>
<pre><code>## The following objects are masked from &#39;package:ggplot2&#39;:
## 
##     %+%, alpha</code></pre>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb254-1" title="1">FullSetB43 &lt;-<span class="st"> </span>FullSetB42</a>
<a class="sourceLine" id="cb254-2" title="2">FullSetB43[<span class="dv">3</span><span class="op">:</span><span class="dv">15</span>] &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb254-3" title="3">FullSetB43[<span class="dv">5</span><span class="op">:</span><span class="dv">22</span>] &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb254-4" title="4">FullSetB43[<span class="dv">20</span><span class="op">:</span><span class="dv">22</span>] &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb254-5" title="5"><span class="kw">describe</span>(FullSetB43)</a></code></pre></div>
<pre><code>##        vars   n    mean      sd median trimmed     mad    min     max
## Age       1 303   58.90   10.39   58.0   58.68   11.86   30.0    86.0
## Weight    2 303   73.83   11.99   74.0   73.44   11.86   48.0   120.0
## BP        3 303  129.55   18.94  130.0  128.46   14.83   90.0   190.0
## PR        4 303   75.14    8.91   70.0   74.22    7.41   50.0   110.0
## FBS       5 303  119.18   52.08   98.0  109.30   20.76   62.0   400.0
## Cr        6 303    1.06    0.26    1.0    1.04    0.30    0.5     2.2
## TG        7 303  150.34   97.96  122.0  134.64   54.86   37.0  1050.0
## LDL       8 303  104.64   35.40  100.0  102.70   31.13   18.0   232.0
## HDL       9 303   40.23   10.56   39.0   39.65    8.90   15.9   111.0
## BUN      10 303   17.50    6.96   16.0   16.50    5.93    6.0    52.0
## ESR      11 303   19.46   15.94   15.0   16.98   10.38    1.0    90.0
## Hb       12 303   13.15    1.61   13.2   13.18    1.48    8.9    17.6
## K        13 303    4.23    0.46    4.2    4.22    0.44    3.0     6.6
## Na       14 303  141.00    3.81  141.0  140.97    2.97  128.0   156.0
## WBC      15 303 7562.05 2413.74 7100.0 7280.66 2075.64 3700.0 18000.0
## Lymph    16 303   32.40    9.97   32.0   32.40    8.90    7.0    60.0
## Neut     17 303   60.15   10.18   60.0   59.98   10.38   32.0    89.0
## PLT      18 303  221.49   60.80  210.0  214.84   44.48   25.0   742.0
## EF       19 303   47.23    8.93   50.0   48.63    7.41   15.0    60.0
##          range  skew kurtosis     se
## Age       56.0  0.13    -0.44   0.60
## Weight    72.0  0.41     0.30   0.69
## BP       100.0  0.57     0.48   1.09
## PR        60.0  1.07     2.33   0.51
## FBS      338.0  2.25     6.31   2.99
## Cr         1.7  0.94     1.74   0.02
## TG      1013.0  3.74    25.31   5.63
## LDL      214.0  0.57     0.47   2.03
## HDL       95.1  1.45     6.94   0.61
## BUN       46.0  1.80     4.63   0.40
## ESR       89.0  1.61     2.88   0.92
## Hb         8.7 -0.18     0.08   0.09
## K          3.6  0.52     2.08   0.03
## Na        28.0  0.26     2.23   0.22
## WBC    14300.0  1.37     2.79 138.67
## Lymph     53.0  0.07     0.13   0.57
## Neut      57.0  0.09    -0.08   0.58
## PLT      717.0  2.56    17.17   3.49
## EF        45.0 -1.32     1.69   0.51</code></pre>
</div>
<div id="shapiro-tests-of-normality-h0-distribution-is-normal-reject-null-if-p-value-is-less-than-.05.-this-test-shows-that-none-of-the-continuous-variables-are-normally-distributed." class="section level4">
<h4>Shapiro tests of normality (H0: Distribution is normal; Reject null if p-value is less than .05). This test shows that none of the continuous variables are normally distributed.</h4>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb256-1" title="1">NormAll &lt;-<span class="st"> </span><span class="kw">lapply</span>(FullSetB43, shapiro.test)</a></code></pre></div>
</div>
<div id="pulling-p-values-of-shapiro-wilk-tests" class="section level4">
<h4>Pulling p-values of Shapiro-Wilk Tests:</h4>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb257-1" title="1">NormAll2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">c</span>(NormAll<span class="op">$</span>Age[<span class="st">&#39;p.value&#39;</span>], NormAll<span class="op">$</span>Weight[<span class="st">&#39;p.value&#39;</span>], NormAll<span class="op">$</span>BP[<span class="st">&#39;p.value&#39;</span>], NormAll<span class="op">$</span>PR[<span class="st">&#39;p.value&#39;</span>], NormAll<span class="op">$</span>FBS[<span class="st">&#39;p.value&#39;</span>], NormAll<span class="op">$</span>Cr[<span class="st">&#39;p.value&#39;</span>], NormAll<span class="op">$</span>TG[<span class="st">&#39;p.value&#39;</span>], NormAll<span class="op">$</span>LDL[<span class="st">&#39;p.value&#39;</span>], NormAll<span class="op">$</span>HDL[<span class="st">&#39;p.value&#39;</span>], NormAll<span class="op">$</span>BUN[<span class="st">&#39;p.value&#39;</span>], NormAll<span class="op">$</span>ESR[<span class="st">&#39;p.value&#39;</span>], NormAll<span class="op">$</span>Hb[<span class="st">&#39;p.value&#39;</span>], NormAll<span class="op">$</span>K[<span class="st">&#39;p.value&#39;</span>], NormAll<span class="op">$</span>Na[<span class="st">&#39;p.value&#39;</span>], NormAll<span class="op">$</span>WBC[<span class="st">&#39;p.value&#39;</span>], NormAll<span class="op">$</span>Lymph[<span class="st">&#39;p.value&#39;</span>], NormAll<span class="op">$</span>Neut[<span class="st">&#39;p.value&#39;</span>], NormAll<span class="op">$</span>PLT[<span class="st">&#39;p.value&#39;</span>], NormAll<span class="op">$</span>EF[<span class="st">&#39;p.value&#39;</span>]))</a>
<a class="sourceLine" id="cb257-2" title="2">                       </a>
<a class="sourceLine" id="cb257-3" title="3"><span class="kw">colnames</span>(NormAll2)=<span class="st"> </span>Attributes =<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Age&#39;</span>, <span class="st">&#39;Weight&#39;</span>, <span class="st">&#39;BP&#39;</span>, <span class="st">&#39;PR&#39;</span>, <span class="st">&#39;FBS&#39;</span>, <span class="st">&#39;Cr&#39;</span>, <span class="st">&#39;TG&#39;</span>, <span class="st">&#39;LDL&#39;</span>, <span class="st">&#39;HDL&#39;</span>, <span class="st">&#39;BUN&#39;</span>, <span class="st">&#39;ESR&#39;</span>, <span class="st">&#39;Hb&#39;</span>, <span class="st">&#39;K&#39;</span>, <span class="st">&#39;Na&#39;</span>, <span class="st">&#39;WBC&#39;</span>, <span class="st">&#39;Lymph&#39;</span>, <span class="st">&#39;Neut&#39;</span>, <span class="st">&#39;PLT&#39;</span>, <span class="st">&#39;EF&#39;</span>)</a>
<a class="sourceLine" id="cb257-4" title="4"></a>
<a class="sourceLine" id="cb257-5" title="5">NormAll3 &lt;-<span class="st"> </span><span class="kw">t</span>(NormAll2)</a>
<a class="sourceLine" id="cb257-6" title="6">NormAll3</a></code></pre></div>
<pre><code>##                [,1]
## Age    3.162362e-02
## Weight 7.982314e-03
## BP     4.038616e-08
## PR     6.633462e-16
## FBS    2.838568e-21
## Cr     1.859580e-09
## TG     1.565454e-22
## LDL    1.785946e-04
## HDL    1.808492e-11
## BUN    3.888873e-16
## ESR    1.780407e-16
## Hb     1.301080e-01
## K      1.955409e-05
## Na     1.319208e-07
## WBC    1.126418e-12
## Lymph  8.768542e-02
## Neut   2.626761e-01
## PLT    1.833105e-17
## EF     1.792951e-16</code></pre>
</div>
<div id="and-bmi-is-also-not-normally-distributed." class="section level4">
<h4>And BMI is also not normally distributed.</h4>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb259-1" title="1"><span class="kw">describe</span>(Allv1<span class="op">$</span>BMI)</a></code></pre></div>
<pre><code>##    vars   n  mean  sd median trimmed  mad   min  max range skew kurtosis
## X1    1 303 27.25 4.1  26.78   27.07 3.77 18.12 40.9 22.79 0.43     0.11
##      se
## X1 0.24</code></pre>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb261-1" title="1">BMINorm &lt;-<span class="st"> </span><span class="kw">shapiro.test</span>((Allv1<span class="op">$</span>BMI))</a>
<a class="sourceLine" id="cb261-2" title="2">BMINorm</a></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  (Allv1$BMI)
## W = 0.98564, p-value = 0.004061</code></pre>
</div>
<div id="boxplot-to-show-distribution-of-blood-pressure-and-pulse-rate" class="section level4">
<h4>Boxplot to show distribution of Blood Pressure and Pulse Rate</h4>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb263-1" title="1"><span class="kw">attach</span>(SymptomB4)</a></code></pre></div>
<pre><code>## The following object is masked from DemoB4:
## 
##     CAD</code></pre>
<pre><code>## The following object is masked from LABB4:
## 
##     CAD</code></pre>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb266-1" title="1"><span class="kw">boxplot</span>(BP, PR, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;indianred1&quot;</span>), <span class="dt">notch =</span> <span class="ot">TRUE</span>, <span class="dt">horizontal =</span> <span class="ot">FALSE</span>, <span class="dt">outline =</span> <span class="ot">TRUE</span>, <span class="dt">plot =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## Warning in bxp(list(stats = structure(c(90, 120, 130, 140, 170, 60, 70, :
## some notches went outside hinges (&#39;box&#39;): maybe set notch=FALSE</code></pre>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb268-1" title="1"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Blood Pressure&quot;</span>, <span class="st">&quot;Pulse Rate&quot;</span>),<span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;indianred1&quot;</span>))</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-59-1.png" width="672" /></p>
</div>
<div id="density-plot-of-weight-and-sex-before-discretization" class="section level4">
<h4>Density plot of weight and sex (before discretization):</h4>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb269-1" title="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb269-2" title="2"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb269-3" title="3"><span class="kw">library</span>(plyr)</a>
<a class="sourceLine" id="cb269-4" title="4"></a>
<a class="sourceLine" id="cb269-5" title="5">WeightMu &lt;-<span class="st"> </span><span class="kw">ddply</span>(DemoB4, <span class="st">&quot;Sex&quot;</span>, summarise, <span class="dt">grp.mean=</span><span class="kw">mean</span>(Weight))</a>
<a class="sourceLine" id="cb269-6" title="6"><span class="kw">head</span>(WeightMu)</a></code></pre></div>
<pre><code>##     Sex grp.mean
## 1 Fmale 70.52756
## 2  Male 76.21591</code></pre>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb271-1" title="1">DDen1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(DemoB4, <span class="kw">aes</span>(<span class="dt">x =</span> Weight, <span class="dt">fill =</span> Sex)) <span class="op">+</span></a>
<a class="sourceLine" id="cb271-2" title="2"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb271-3" title="3"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">data =</span> WeightMu, <span class="kw">aes</span>(<span class="dt">xintercept=</span>grp.mean, <span class="dt">colour =</span> Sex),</a>
<a class="sourceLine" id="cb271-4" title="4">             <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>)</a>
<a class="sourceLine" id="cb271-5" title="5">DDen1</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-60-1.png" width="672" /> #### Density plot of BMI and sex (before discretization):</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb272-1" title="1">BMIMu &lt;-<span class="st"> </span><span class="kw">ddply</span>(Allv1, <span class="st">&quot;Sex&quot;</span>, summarise, <span class="dt">grp.mean=</span><span class="kw">mean</span>(BMI))</a>
<a class="sourceLine" id="cb272-2" title="2"><span class="kw">head</span>(BMIMu)</a></code></pre></div>
<pre><code>##     Sex grp.mean
## 1 Fmale 28.61687
## 2  Male 26.26082</code></pre>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb274-1" title="1">BMIden &lt;-<span class="st"> </span><span class="kw">ggplot</span>(Allv1, <span class="kw">aes</span>(<span class="dt">x =</span> BMI, <span class="dt">fill =</span> Sex)) <span class="op">+</span></a>
<a class="sourceLine" id="cb274-2" title="2"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb274-3" title="3"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">data =</span> BMIMu, <span class="kw">aes</span>(<span class="dt">xintercept=</span>grp.mean, <span class="dt">colour =</span> Sex),</a>
<a class="sourceLine" id="cb274-4" title="4">             <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>)</a>
<a class="sourceLine" id="cb274-5" title="5">BMIden</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-61-1.png" width="672" /> #### Will be completing a number of ASSOCIATIONS between all categorical variables. Interpretation of results when K = 2: SMALL Association: 0.10 - &lt; 0.30; MEDIUM Association: 0.30 - &lt; 0.50; LARGE Association: &gt;0.50</p>
</div>
<div id="running-cramersv-on-all-factor-data-combined" class="section level4">
<h4>Running CramersV on all factor data combined:</h4>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb275-1" title="1"><span class="kw">library</span>(pedometrics); <span class="kw">library</span>(GGally)</a>
<a class="sourceLine" id="cb275-2" title="2"></a>
<a class="sourceLine" id="cb275-3" title="3">CV1 &lt;-<span class="st"> </span>AllvFinal</a>
<a class="sourceLine" id="cb275-4" title="4">CV1[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb275-5" title="5">CV1[<span class="dv">14</span><span class="op">:</span><span class="dv">15</span>] &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb275-6" title="6">CV1[<span class="dv">32</span><span class="op">:</span><span class="dv">46</span>] &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb275-7" title="7"></a>
<a class="sourceLine" id="cb275-8" title="8">CVresults &lt;-<span class="st"> </span><span class="kw">cramer</span>(CV1)</a>
<a class="sourceLine" id="cb275-9" title="9"><span class="co">#CVresults</span></a>
<a class="sourceLine" id="cb275-10" title="10"><span class="co">#corrplot(CVresults, type = &quot;upper&quot;, order = &quot;hclust&quot;)</span></a>
<a class="sourceLine" id="cb275-11" title="11"><span class="co">#corrplot(CVresults, method = &quot;number&quot;)</span></a>
<a class="sourceLine" id="cb275-12" title="12"><span class="kw">corrplot</span>(CVresults, <span class="dt">type =</span> <span class="st">&quot;upper&quot;</span>, <span class="dt">tl.cex=</span><span class="fl">0.6</span>)</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-62-1.png" width="150%" /></p>
</div>
<div id="running-cramers-v-on-individual-pairs-of-variables-that-show-some-levels-of-association---starting-with-tcp-and-acp" class="section level4">
<h4>Running Cramer’s V on individual pairs of variables that show some levels of association - starting with TCP and ACP:</h4>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb276-1" title="1"><span class="kw">library</span>(lsr)</a>
<a class="sourceLine" id="cb276-2" title="2"></a>
<a class="sourceLine" id="cb276-3" title="3"><span class="kw">cramersV</span>(CV1<span class="op">$</span>TCP, CV1<span class="op">$</span>ACP)</a></code></pre></div>
<pre><code>## [1] 0.7156668</code></pre>
</div>
<div id="association-between-sysm-and-vhd" class="section level4">
<h4>Association between SysM and VHD:</h4>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb278-1" title="1"><span class="kw">cramersV</span>(CV1<span class="op">$</span>SysM, CV1<span class="op">$</span>VHD)</a></code></pre></div>
<pre><code>## Warning in chisq.test(...): Chi-squared approximation may be incorrect</code></pre>
<pre><code>## [1] 0.5449543</code></pre>
</div>
<div id="association-between-diam-and-vhd" class="section level4">
<h4>Association between DiaM and VHD:</h4>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb281-1" title="1"><span class="kw">cramersV</span>(CV1<span class="op">$</span>DiaM, CV1<span class="op">$</span>VHD)</a></code></pre></div>
<pre><code>## Warning in chisq.test(...): Chi-squared approximation may be incorrect</code></pre>
<pre><code>## [1] 0.4983612</code></pre>
</div>
<div id="association-between-tcp-and-cad" class="section level4">
<h4>Association between TCP and CAD:</h4>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb284-1" title="1"><span class="kw">cramersV</span>(CV1<span class="op">$</span>TCP, CV1<span class="op">$</span>CAD)</a></code></pre></div>
<pre><code>## [1] 0.5356469</code></pre>
</div>
<div id="association-between-acp-and-cad" class="section level4">
<h4>Association between ACP and CAD:</h4>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb286-1" title="1"><span class="kw">cramersV</span>(CV1<span class="op">$</span>ACP, CV1<span class="op">$</span>CAD)</a></code></pre></div>
<pre><code>## [1] 0.4080137</code></pre>
</div>
<div id="association-between-rwma-and-cad" class="section level4">
<h4>Association between RWMA and CAD:</h4>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb288-1" title="1"><span class="kw">cramersV</span>(CV1<span class="op">$</span>RWMA, CV1<span class="op">$</span>CAD)</a></code></pre></div>
<pre><code>## [1] 0.3267227</code></pre>
</div>
<div id="association-between-edema-and-lr" class="section level4">
<h4>Association between Edema and LR:</h4>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb290-1" title="1"><span class="kw">cramersV</span>(CV1<span class="op">$</span>Edema, CV1<span class="op">$</span>LR)</a></code></pre></div>
<pre><code>## Warning in chisq.test(...): Chi-squared approximation may be incorrect</code></pre>
<pre><code>## [1] 0.2772407</code></pre>
</div>
<div id="association-between-htn-and-cad" class="section level4">
<h4>Association between HTN and CAD:</h4>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb293-1" title="1"><span class="kw">cramersV</span>(CV1<span class="op">$</span>HTN, CV1<span class="op">$</span>CAD)</a></code></pre></div>
<pre><code>## [1] 0.2803429</code></pre>
</div>
<div id="association-between-smoker-and-sex" class="section level4">
<h4>Association between Smoker and Sex:</h4>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb295-1" title="1"><span class="kw">cramersV</span>(CV1<span class="op">$</span>Smoker, CV1<span class="op">$</span>Sex)</a></code></pre></div>
<pre><code>## [1] 0.3280887</code></pre>
</div>
<div id="association-between-sex-and-dlp" class="section level4">
<h4>Association between Sex and DLP:</h4>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb297-1" title="1"><span class="kw">cramersV</span>(CV1<span class="op">$</span>Sex, CV1<span class="op">$</span>DLP)</a></code></pre></div>
<pre><code>## [1] 0.2709824</code></pre>
</div>
<div id="association-between-dm-and-poorr" class="section level4">
<h4>Association between DM and PoorR:</h4>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb299-1" title="1"><span class="kw">cramersV</span>(CV1<span class="op">$</span>DM, CV1<span class="op">$</span>PoorR)</a></code></pre></div>
<pre><code>## Warning in chisq.test(...): Chi-squared approximation may be incorrect</code></pre>
<pre><code>## [1] 0.2478916</code></pre>
</div>
<div id="association-between-dm-and-cad" class="section level4">
<h4>Association between DM and CAD:</h4>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb302-1" title="1"><span class="kw">cramersV</span>(CV1<span class="op">$</span>DM, CV1<span class="op">$</span>CAD)</a></code></pre></div>
<pre><code>## [1] 0.2449149</code></pre>
</div>
<div id="determining-whether-there-is-any-significant-variation-in-the-ncp-column-very-low-variation-94.7-of-ncp-entries-are-no" class="section level4">
<h4>Determining whether there is any significant variation in the ‘NCP’ column: Very low variation (94.7% of NCP entries are ‘No’)</h4>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb304-1" title="1">NCPn &lt;-<span class="st"> </span><span class="kw">sum</span>(FullSetB42<span class="op">$</span>NCP <span class="op">==</span><span class="st"> &#39;N&#39;</span>)</a>
<a class="sourceLine" id="cb304-2" title="2">NCPy &lt;-<span class="st"> </span><span class="kw">sum</span>(FullSetB42<span class="op">$</span>NCP <span class="op">==</span><span class="st"> &#39;Y&#39;</span>)</a>
<a class="sourceLine" id="cb304-3" title="3">(NCPn<span class="op">/</span>(NCPn<span class="op">+</span>NCPy))<span class="op">*</span><span class="dv">100</span></a></code></pre></div>
<pre><code>## [1] 94.71947</code></pre>
</div>
<div id="determining-whether-there-is-any-significant-variation-in-the-acp-column-69.3-of-these-acp-entries-are-no" class="section level4">
<h4>Determining whether there is any significant variation in the ‘ACP’ column: 69.3% of these ‘ACP’ entries are ‘No’</h4>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb306-1" title="1">ACPn &lt;-<span class="st"> </span><span class="kw">sum</span>(FullSetB42<span class="op">$</span>ACP <span class="op">==</span><span class="st"> &#39;N&#39;</span>)</a>
<a class="sourceLine" id="cb306-2" title="2">ACPy &lt;-<span class="st"> </span><span class="kw">sum</span>(FullSetB42<span class="op">$</span>ACP <span class="op">==</span><span class="st"> &#39;Y&#39;</span>)</a>
<a class="sourceLine" id="cb306-3" title="3">(ACPn<span class="op">/</span>(ACPn<span class="op">+</span>ACPy))<span class="op">*</span><span class="dv">100</span></a></code></pre></div>
<pre><code>## [1] 69.30693</code></pre>
</div>
<div id="barplot-of-bbb-attribute" class="section level4">
<h4>Barplot of BBB attribute</h4>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb308-1" title="1"><span class="kw">barplot</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(FullSetB42<span class="op">$</span>BBB)))</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-77-1.png" width="672" /> #### Barplot of VHD attribute</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb309-1" title="1"><span class="kw">barplot</span>(<span class="kw">prop.table</span>(<span class="kw">table</span>(FullSetB42<span class="op">$</span>VHD)))</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-78-1.png" width="672" /></p>
</div>
</div>
<div id="feature-selection-on-all-the-attributes-combined-as-well-as-on-the-4-individual-attribute-groups---using-the-fselector-package" class="section level3">
<h3>Feature selection on all the attributes combined, as well as on the 4 individual attribute groups - using the FSelector package:</h3>
<div id="starting-with-the-full-data-set---selected-cad-tcp-acp-rwma-ef-age-htn-ncp-dm-tinv-vhd" class="section level4">
<h4>Starting with the full data set - selected: CAD ~ TCP + ACP + RWMA + EF + Age + HTN + NCP + DM + Tinv + VHD</h4>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb310-1" title="1"><span class="kw">library</span>(FSelector)</a>
<a class="sourceLine" id="cb310-2" title="2"></a>
<a class="sourceLine" id="cb310-3" title="3">AllWeights &lt;-<span class="st"> </span><span class="kw">information.gain</span>(CAD<span class="op">~</span>.,AllvFinal)</a>
<a class="sourceLine" id="cb310-4" title="4"><span class="kw">print</span>(AllWeights)</a></code></pre></div>
<pre><code>##          attr_importance
## Age         3.913519e-02
## Weight      1.438164e-03
## Sex         2.235180e-03
## DM          3.600944e-02
## HTN         4.113445e-02
## Smoker      2.807166e-03
## ExSmoker    6.784699e-04
## FH          6.483446e-04
## Obesity     2.538449e-04
## CRF         6.782311e-03
## CVA         3.339416e-04
## AD          4.356926e-03
## TD          1.072752e-03
## CHF         1.119211e-03
## DLP         8.070815e-05
## BP          1.024603e-02
## PR          4.016178e-03
## Edema       1.620264e-03
## WPP         5.640631e-03
## LR          1.113538e-03
## SysM        1.175479e-05
## DiaM        9.476671e-03
## TCP         1.599631e-01
## Dyspnea     7.806613e-03
## Fclass      3.792510e-03
## ACP         8.291965e-02
## NCP         3.343336e-02
## LTAng       2.242843e-03
## QWave       1.845868e-02
## STelev      1.608471e-02
## STdep       1.125196e-02
## Tinv        3.123810e-02
## LVH         1.401389e-03
## PoorR       1.023512e-02
## BBB         3.643403e-03
## FBS         2.715595e-02
## Cr          6.521992e-03
## TG          3.953217e-03
## LDL         1.058707e-04
## HDL         1.254942e-04
## BUN         4.223209e-03
## ESR         2.226479e-03
## Hb          1.220366e-03
## K           2.808035e-03
## Na          2.518175e-03
## WBC         6.426433e-03
## Lymph       9.189265e-03
## Neut        6.394745e-03
## PLT         5.200316e-03
## EF          5.296640e-02
## RWMA        6.972199e-02
## VHD         2.486419e-02</code></pre>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb312-1" title="1">subset &lt;-<span class="st"> </span><span class="kw">cutoff.k</span>(AllWeights, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb312-2" title="2">FSall &lt;-<span class="st"> </span><span class="kw">as.simple.formula</span>(subset, <span class="st">&quot;CAD&quot;</span>)</a>
<a class="sourceLine" id="cb312-3" title="3"><span class="kw">print</span>(FSall)</a></code></pre></div>
<pre><code>## CAD ~ TCP + ACP + RWMA + EF + HTN + Age + DM + NCP + Tinv + FBS
## &lt;environment: 0x000000001dc548b8&gt;</code></pre>
</div>
<div id="next-using-the-demo-demographic-attribute-data-set---results-cad-age-htn-dm-crf-ad" class="section level4">
<h4>Next, using the ‘Demo’ (Demographic) attribute data set - results: CAD ~ Age + HTN + DM + CRF + AD</h4>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb314-1" title="1">DemoWeights &lt;-<span class="st"> </span><span class="kw">information.gain</span>(CAD<span class="op">~</span>.,Demo)</a>
<a class="sourceLine" id="cb314-2" title="2"><span class="kw">print</span>(DemoWeights)</a></code></pre></div>
<pre><code>##          attr_importance
## Age         3.913519e-02
## Weight      1.438164e-03
## Sex         2.235180e-03
## DM          3.600944e-02
## HTN         4.113445e-02
## Smoker      2.807166e-03
## ExSmoker    6.784699e-04
## FH          6.483446e-04
## Obesity     2.538449e-04
## CRF         6.782311e-03
## CVA         3.339416e-04
## AD          4.356926e-03
## TD          1.072752e-03
## CHF         1.119211e-03
## DLP         8.070815e-05</code></pre>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb316-1" title="1">subset &lt;-<span class="st"> </span><span class="kw">cutoff.k</span>(DemoWeights, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb316-2" title="2">FSdemo &lt;-<span class="st"> </span><span class="kw">as.simple.formula</span>(subset, <span class="st">&quot;CAD&quot;</span>)</a>
<a class="sourceLine" id="cb316-3" title="3"><span class="kw">print</span>(FSdemo)</a></code></pre></div>
<pre><code>## CAD ~ HTN + Age + DM + CRF + AD
## &lt;environment: 0x0000000020253c78&gt;</code></pre>
</div>
<div id="next-using-the-symptom-symptom-examination-attribute-data-set---results-cad-tcp-acp-ncp-diam-bp" class="section level4">
<h4>Next, using the ‘Symptom’ (Symptom &amp; Examination) attribute data set - results: CAD ~ TCP + ACP + NCP + DiaM + BP</h4>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb318-1" title="1">SymWeights &lt;-<span class="st"> </span><span class="kw">information.gain</span>(CAD<span class="op">~</span>.,Symptom)</a>
<a class="sourceLine" id="cb318-2" title="2"><span class="kw">print</span>(SymWeights)</a></code></pre></div>
<pre><code>##         attr_importance
## BP         1.024603e-02
## PR         4.016178e-03
## Edema      1.620264e-03
## WPP        5.640631e-03
## LR         1.113538e-03
## SysM       1.175479e-05
## DiaM       9.476671e-03
## TCP        1.599631e-01
## Dyspnea    7.806613e-03
## Fclass     3.792510e-03
## ACP        8.291965e-02
## NCP        3.343336e-02
## LTAng      2.242843e-03</code></pre>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb320-1" title="1">subset &lt;-<span class="st"> </span><span class="kw">cutoff.k</span>(SymWeights, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb320-2" title="2">FSsym &lt;-<span class="st"> </span><span class="kw">as.simple.formula</span>(subset, <span class="st">&quot;CAD&quot;</span>)</a>
<a class="sourceLine" id="cb320-3" title="3"><span class="kw">print</span>(FSsym)</a></code></pre></div>
<pre><code>## CAD ~ TCP + ACP + NCP + BP + DiaM
## &lt;environment: 0x0000000021ddf760&gt;</code></pre>
</div>
<div id="next-using-the-ecgattribute-data-set---results-cad-tinv-qwave-stdep-stelev-poorr" class="section level4">
<h4>Next, using the ’ECG’attribute data set - results: CAD ~ Tinv + QWave + STdep + STelev + PoorR</h4>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb322-1" title="1">ECGWeights &lt;-<span class="st"> </span><span class="kw">information.gain</span>(CAD<span class="op">~</span>.,ECG)</a>
<a class="sourceLine" id="cb322-2" title="2"><span class="kw">print</span>(ECGWeights)</a></code></pre></div>
<pre><code>##        attr_importance
## QWave      0.018458684
## STelev     0.016084706
## STdep      0.011251964
## Tinv       0.031238103
## LVH        0.001401389
## PoorR      0.010235124
## BBB        0.003643403</code></pre>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb324-1" title="1">subset &lt;-<span class="st"> </span><span class="kw">cutoff.k</span>(ECGWeights, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb324-2" title="2">FSecg &lt;-<span class="st"> </span><span class="kw">as.simple.formula</span>(subset, <span class="st">&quot;CAD&quot;</span>)</a>
<a class="sourceLine" id="cb324-3" title="3"><span class="kw">print</span>(FSecg)</a></code></pre></div>
<pre><code>## CAD ~ Tinv + QWave + STelev + STdep + PoorR
## &lt;environment: 0x000000002472b9f0&gt;</code></pre>
</div>
<div id="lastly-using-the-lab-laboratory-and-echocardiographic-attribute-data-set---results-cad-rwma-ef-vhd-fbs-lymph" class="section level4">
<h4>Lastly, using the ‘LAB’ (Laboratory and Echocardiographic) attribute data set - results: CAD ~ RWMA + EF + VHD + FBS + Lymph</h4>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb326-1" title="1">LABWeights &lt;-<span class="st"> </span><span class="kw">information.gain</span>(CAD<span class="op">~</span>.,LAB)</a>
<a class="sourceLine" id="cb326-2" title="2"><span class="kw">print</span>(LABWeights)</a></code></pre></div>
<pre><code>##       attr_importance
## FBS      0.0271559513
## Cr       0.0065219922
## TG       0.0039532167
## LDL      0.0001058707
## HDL      0.0001254942
## BUN      0.0042232088
## ESR      0.0022264785
## Hb       0.0012203662
## K        0.0028080353
## Na       0.0025181745
## WBC      0.0064264333
## Lymph    0.0091892646
## Neut     0.0063947452
## PLT      0.0052003162
## EF       0.0529664010
## RWMA     0.0697219929
## VHD      0.0248641911</code></pre>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb328-1" title="1">subset &lt;-<span class="st"> </span><span class="kw">cutoff.k</span>(LABWeights, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb328-2" title="2">FSlab &lt;-<span class="st"> </span><span class="kw">as.simple.formula</span>(subset, <span class="st">&quot;CAD&quot;</span>)</a>
<a class="sourceLine" id="cb328-3" title="3"><span class="kw">print</span>(FSlab)</a></code></pre></div>
<pre><code>## CAD ~ RWMA + EF + FBS + VHD + Lymph
## &lt;environment: 0x00000000200e3b10&gt;</code></pre>
</div>
</div>
<div id="now-comparing-these-discretized-results-with-those-from-before-discretization" class="section level3">
<h3>Now, comparing these discretized results with those from before discretization:</h3>
<div id="using-the-full-data-set-fullsetb42---results-cad-tcp-acp-rwma-age-ef-htn-dm-bp-ncp-tinv-while-the-discretized-results-were-cad-tcp-acp-rwma-ef-age-htn-ncp-dm-tinv-vhd.-note-the-top-6-were-the-same-for-both-data-sets-and-8-of-the-top-10-were-shared-across-both-data-sets" class="section level4">
<h4>Using the full data set (FullSetB42) - results: CAD ~ TCP + ACP + RWMA + Age + EF + HTN + DM + BP + NCP + Tinv (while the discretized results were: CAD ~ TCP + ACP + RWMA + EF + Age + HTN + NCP + DM + Tinv + VHD). NOTE: The top 6 were the same for both data sets (and 8 of the top 10 were shared across both data sets)</h4>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb330-1" title="1">AllB4Weights &lt;-<span class="st"> </span><span class="kw">information.gain</span>(CAD<span class="op">~</span>.,FullSetB42)</a>
<a class="sourceLine" id="cb330-2" title="2"><span class="kw">print</span>(AllB4Weights)</a></code></pre></div>
<pre><code>##          attr_importance
## Age         5.624803e-02
## Weight      0.000000e+00
## Sex         2.235180e-03
## DM          3.600944e-02
## HTN         4.113445e-02
## Smoker      0.000000e+00
## ExSmoker    0.000000e+00
## FH          0.000000e+00
## Obesity     2.538449e-04
## CRF         6.782311e-03
## CVA         3.339416e-04
## AD          4.356926e-03
## TD          1.072752e-03
## CHF         1.119211e-03
## DLP         8.070815e-05
## BP          3.543081e-02
## PR          0.000000e+00
## Edema       0.000000e+00
## WPP         5.640631e-03
## LR          1.113538e-03
## SysM        1.175479e-05
## DiaM        9.476671e-03
## TCP         1.599631e-01
## Dyspnea     7.806613e-03
## Fclass      0.000000e+00
## ACP         8.291965e-02
## NCP         3.343336e-02
## LTAng       2.242843e-03
## QWave       0.000000e+00
## STelev      0.000000e+00
## STdep       0.000000e+00
## Tinv        3.123810e-02
## LVH         1.401389e-03
## PoorR       1.023512e-02
## BBB         3.643403e-03
## FBS         2.902817e-02
## Cr          0.000000e+00
## TG          0.000000e+00
## LDL         0.000000e+00
## HDL         0.000000e+00
## BUN         0.000000e+00
## ESR         0.000000e+00
## Hb          0.000000e+00
## K           0.000000e+00
## Na          0.000000e+00
## WBC         0.000000e+00
## Lymph       0.000000e+00
## Neut        0.000000e+00
## PLT         0.000000e+00
## EF          5.296640e-02
## RWMA        6.972199e-02
## VHD         2.486419e-02</code></pre>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb332-1" title="1">subset &lt;-<span class="st"> </span><span class="kw">cutoff.k</span>(AllB4Weights, <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb332-2" title="2">FSB4all &lt;-<span class="st"> </span><span class="kw">as.simple.formula</span>(subset, <span class="st">&quot;CAD&quot;</span>)</a>
<a class="sourceLine" id="cb332-3" title="3"><span class="kw">print</span>(FSB4all)</a></code></pre></div>
<pre><code>## CAD ~ TCP + ACP + RWMA + Age + EF + HTN + DM + BP + NCP + Tinv
## &lt;environment: 0x0000000014660ca0&gt;</code></pre>
</div>
<div id="comparing-the-discretized-feature-selection-results-found-using-the-fselector-package-with-the-results-using-the-fselectorrcpp-package---results-cad-tcp-acp-rwma-ef-htn-age-dm-ncp-tinv-fbs" class="section level4">
<h4>Comparing the discretized feature selection results found using the ‘FSelector’ package with the results using the ‘FSelectorRcpp’ package - results: CAD ~ TCP + ACP + RWMA + EF + HTN + Age + DM + NCP + Tinv + FBS</h4>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb334-1" title="1"><span class="kw">library</span>(FSelectorRcpp)</a>
<a class="sourceLine" id="cb334-2" title="2"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb334-3" title="3"></a>
<a class="sourceLine" id="cb334-4" title="4">FS2all &lt;-<span class="st"> </span><span class="kw">information_gain</span>(</a>
<a class="sourceLine" id="cb334-5" title="5">  <span class="dt">formula =</span> CAD<span class="op">~</span>.,</a>
<a class="sourceLine" id="cb334-6" title="6">  <span class="dt">data =</span> AllvFinal,</a>
<a class="sourceLine" id="cb334-7" title="7">  <span class="dt">type =</span> <span class="st">&quot;infogain&quot;</span>,</a>
<a class="sourceLine" id="cb334-8" title="8">  <span class="dt">threads =</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb334-9" title="9">) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb334-10" title="10"><span class="kw">cut_attrs</span>(</a>
<a class="sourceLine" id="cb334-11" title="11">  <span class="dt">k =</span> <span class="dv">10</span></a>
<a class="sourceLine" id="cb334-12" title="12">) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb334-13" title="13"><span class="kw">to_formula</span>(</a>
<a class="sourceLine" id="cb334-14" title="14">  <span class="dt">attrs =</span> .,</a>
<a class="sourceLine" id="cb334-15" title="15">  <span class="dt">class =</span> <span class="st">&quot;CAD&quot;</span></a>
<a class="sourceLine" id="cb334-16" title="16">)</a>
<a class="sourceLine" id="cb334-17" title="17"><span class="kw">print</span>(FS2all)</a></code></pre></div>
<pre><code>## CAD ~ TCP + ACP + RWMA + EF + HTN + Age + DM + NCP + Tinv + FBS
## &lt;environment: 0x000000001f5166c8&gt;</code></pre>
</div>
<div id="lastly-comparing-the-output-of-the-fselectorrcpp-package-using-the-data-set-that-was-not-discretized-yet-fullsetb42-data-set---result-cad-tcp-acp-rwma-age-ef-htn-dm-bp-ncp-tinv" class="section level4">
<h4>Lastly, comparing the output of the FSelectorRcpp package using the data set that was not discretized yet (FullSetB42 data set) - result: CAD ~ TCP + ACP + RWMA + Age + EF + HTN + DM + BP + NCP + Tinv</h4>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb336-1" title="1">FS2B4all &lt;-<span class="st"> </span><span class="kw">information_gain</span>(</a>
<a class="sourceLine" id="cb336-2" title="2">  <span class="dt">formula =</span> CAD<span class="op">~</span>.,</a>
<a class="sourceLine" id="cb336-3" title="3">  <span class="dt">data =</span> FullSetB42,</a>
<a class="sourceLine" id="cb336-4" title="4">  <span class="dt">type =</span> <span class="st">&quot;infogain&quot;</span>,</a>
<a class="sourceLine" id="cb336-5" title="5">  <span class="dt">threads =</span> <span class="dv">2</span></a>
<a class="sourceLine" id="cb336-6" title="6">) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb336-7" title="7"><span class="kw">cut_attrs</span>(</a>
<a class="sourceLine" id="cb336-8" title="8">  <span class="dt">k =</span> <span class="dv">10</span></a>
<a class="sourceLine" id="cb336-9" title="9">) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb336-10" title="10"><span class="kw">to_formula</span>(</a>
<a class="sourceLine" id="cb336-11" title="11">  <span class="dt">attrs =</span> .,</a>
<a class="sourceLine" id="cb336-12" title="12">  <span class="dt">class =</span> <span class="st">&quot;CAD&quot;</span></a>
<a class="sourceLine" id="cb336-13" title="13">)</a>
<a class="sourceLine" id="cb336-14" title="14"><span class="kw">print</span>(FS2B4all)</a></code></pre></div>
<pre><code>## CAD ~ TCP + ACP + RWMA + Age + EF + HTN + DM + BP + NCP + Tinv
## &lt;environment: 0x000000001f7e6608&gt;</code></pre>
</div>
<div id="checking-on-strength-of-associations-between-top-12-attributes-and-the-dependent-variable-ranked-in-descending-order" class="section level4">
<h4>Checking on strength of associations between top 12 attributes and the dependent variable, ranked in descending order:</h4>
<div class="sourceCode" id="cb338"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb338-1" title="1"><span class="kw">library</span>(lsr)</a>
<a class="sourceLine" id="cb338-2" title="2"></a>
<a class="sourceLine" id="cb338-3" title="3"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>TCP, AllvFinal<span class="op">$</span>CAD)</a></code></pre></div>
<pre><code>## [1] 0.5356469</code></pre>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb340-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>ACP, AllvFinal<span class="op">$</span>CAD)</a></code></pre></div>
<pre><code>## [1] 0.4080137</code></pre>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb342-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>RWMA, AllvFinal<span class="op">$</span>CAD)</a></code></pre></div>
<pre><code>## [1] 0.3267227</code></pre>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb344-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>EF, AllvFinal<span class="op">$</span>CAD)</a></code></pre></div>
<pre><code>## [1] 0.3221946</code></pre>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb346-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>Age, AllvFinal<span class="op">$</span>CAD)</a></code></pre></div>
<pre><code>## [1] 0.2814322</code></pre>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb348-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>HTN, AllvFinal<span class="op">$</span>CAD)</a></code></pre></div>
<pre><code>## [1] 0.2803429</code></pre>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb350-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>NCP, AllvFinal<span class="op">$</span>CAD)</a></code></pre></div>
<pre><code>## Warning in chisq.test(...): Chi-squared approximation may be incorrect</code></pre>
<pre><code>## [1] 0.2578747</code></pre>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb353-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>DM, AllvFinal<span class="op">$</span>CAD)</a></code></pre></div>
<pre><code>## [1] 0.2449149</code></pre>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb355-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>VHD, AllvFinal<span class="op">$</span>CAD)</a></code></pre></div>
<pre><code>## Warning in chisq.test(...): Chi-squared approximation may be incorrect</code></pre>
<pre><code>## [1] 0.231208</code></pre>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb358-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>FBS, AllvFinal<span class="op">$</span>CAD)</a></code></pre></div>
<pre><code>## Warning in chisq.test(...): Chi-squared approximation may be incorrect</code></pre>
<pre><code>## [1] 0.229348</code></pre>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb361-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>Tinv, AllvFinal<span class="op">$</span>CAD)</a></code></pre></div>
<pre><code>## [1] 0.2289508</code></pre>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb363-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>BP, AllvFinal<span class="op">$</span>CAD)</a></code></pre></div>
<pre><code>## [1] 0.1255092</code></pre>
</div>
<div id="checking-on-the-strength-of-associations-between-the-top-12-attributes-and-each-other" class="section level4">
<h4>Checking on the strength of associations between the top 12 attributes and each other:</h4>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb365-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>TCP, AllvFinal<span class="op">$</span>ACP)</a></code></pre></div>
<pre><code>## [1] 0.7156668</code></pre>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb367-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>HTN, AllvFinal<span class="op">$</span>BP)</a></code></pre></div>
<pre><code>## [1] 0.3519147</code></pre>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb369-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>RWMA, AllvFinal<span class="op">$</span>EF)</a></code></pre></div>
<pre><code>## [1] 0.269923</code></pre>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb371-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>TCP, AllvFinal<span class="op">$</span>NCP)</a></code></pre></div>
<pre><code>## [1] 0.2416607</code></pre>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb373-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>HTN, AllvFinal<span class="op">$</span>DM)</a></code></pre></div>
<pre><code>## [1] 0.2105191</code></pre>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb375-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>VHD, AllvFinal<span class="op">$</span>Age)</a></code></pre></div>
<pre><code>## Warning in chisq.test(...): Chi-squared approximation may be incorrect</code></pre>
<pre><code>## [1] 0.1636751</code></pre>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb378-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>RWMA, AllvFinal<span class="op">$</span>TCP)</a></code></pre></div>
<pre><code>## [1] 0.1608916</code></pre>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb380-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>HTN, AllvFinal<span class="op">$</span>VHD)</a></code></pre></div>
<pre><code>## Warning in chisq.test(...): Chi-squared approximation may be incorrect</code></pre>
<pre><code>## [1] 0.1379553</code></pre>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb383-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>Tinv, AllvFinal<span class="op">$</span>EF)</a></code></pre></div>
<pre><code>## [1] 0.1360726</code></pre>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb385-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>TCP, AllvFinal<span class="op">$</span>Age)</a></code></pre></div>
<pre><code>## [1] 0.1078061</code></pre>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb387-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>RWMA, AllvFinal<span class="op">$</span>Age)</a></code></pre></div>
<pre><code>## [1] 0.1060843</code></pre>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb389-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>HTN, AllvFinal<span class="op">$</span>Age)</a></code></pre></div>
<pre><code>## [1] 0.09646362</code></pre>
</div>
<div id="checking-associations-between-the-final-variables-that-do-not-have-a-statistically-significant-relationship-with-the-dependent-variable-per-the-logistic-regression-results-later.-that-is-checking-acp-and-ncp-against-each-other-and-the-other-variables-including-tcp-ef-rwma-htn-age-and-dm-as-well-as-the-dependent-variable.-note-when-df1-the-interpretation-of-the-cramers-v-results-effect-would-be-as-follows-0.10-small-effect-0.30-medium-effect-0.50large-effect" class="section level4">
<h4>Checking associations between the final variables that do not have a statistically significant relationship with the dependent variable (per the logistic regression results later). That is, checking ACP and NCP against each other, and the other variables, including TCP, EF, RWMA, HTN, Age and DM (as well as the dependent variable). NOTE: When DF=1, the interpretation of the Cramer’s V results (effect) would be as follows: (0.10 = small effect) (0.30 = medium effect) (0.50=large effect)</h4>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb391-1" title="1"><span class="kw">library</span>(lsr)</a>
<a class="sourceLine" id="cb391-2" title="2"></a>
<a class="sourceLine" id="cb391-3" title="3"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>ACP, AllvFinal<span class="op">$</span>TCP)</a></code></pre></div>
<pre><code>## [1] 0.7156668</code></pre>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb393-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>ACP, AllvFinal<span class="op">$</span>EF)</a></code></pre></div>
<pre><code>## [1] 0.1645235</code></pre>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb395-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>ACP, AllvFinal<span class="op">$</span>RWMA)</a></code></pre></div>
<pre><code>## [1] 0.1729343</code></pre>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb397-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>ACP, AllvFinal<span class="op">$</span>HTN)</a></code></pre></div>
<pre><code>## [1] 0.1373895</code></pre>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb399-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>ACP, AllvFinal<span class="op">$</span>Age)</a></code></pre></div>
<pre><code>## [1] 0.1141707</code></pre>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb401-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>ACP, AllvFinal<span class="op">$</span>DM)</a></code></pre></div>
<pre><code>## [1] 0.08023603</code></pre>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb403-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>ACP, AllvFinal<span class="op">$</span>CAD)</a></code></pre></div>
<pre><code>## [1] 0.4080137</code></pre>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb405-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>NCP, AllvFinal<span class="op">$</span>TCP)</a></code></pre></div>
<pre><code>## [1] 0.2416607</code></pre>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb407-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>NCP, AllvFinal<span class="op">$</span>EF)</a></code></pre></div>
<pre><code>## [1] 0.05887248</code></pre>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb409-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>NCP, AllvFinal<span class="op">$</span>RWMA)</a></code></pre></div>
<pre><code>## Warning in chisq.test(...): Chi-squared approximation may be incorrect</code></pre>
<pre><code>## [1] 0.0668128</code></pre>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb412-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>NCP, AllvFinal<span class="op">$</span>HTN)</a></code></pre></div>
<pre><code>## [1] 0.001436249</code></pre>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb414-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>NCP, AllvFinal<span class="op">$</span>Age)</a></code></pre></div>
<pre><code>## Warning in chisq.test(...): Chi-squared approximation may be incorrect</code></pre>
<pre><code>## [1] 0.03838205</code></pre>
<div class="sourceCode" id="cb417"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb417-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>NCP, AllvFinal<span class="op">$</span>DM)</a></code></pre></div>
<pre><code>## Warning in chisq.test(...): Chi-squared approximation may be incorrect</code></pre>
<pre><code>## [1] 0.07274291</code></pre>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb420-1" title="1"><span class="kw">cramersV</span>(AllvFinal<span class="op">$</span>NCP, AllvFinal<span class="op">$</span>CAD)</a></code></pre></div>
<pre><code>## Warning in chisq.test(...): Chi-squared approximation may be incorrect</code></pre>
<pre><code>## [1] 0.2578747</code></pre>
</div>
<div id="creating-the-final-variable-data-set-using-the-fselector-package" class="section level4">
<h4>Creating the final variable data set using the FSelector package:</h4>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb423-1" title="1">TenVars &lt;-<span class="st"> </span>AllvFinal[, <span class="kw">c</span>(<span class="st">&quot;TCP&quot;</span>, <span class="st">&quot;ACP&quot;</span>, <span class="st">&quot;RWMA&quot;</span>, <span class="st">&quot;EF&quot;</span>, <span class="st">&quot;Age&quot;</span>, <span class="st">&quot;HTN&quot;</span>, <span class="st">&quot;NCP&quot;</span>, <span class="st">&quot;DM&quot;</span>, <span class="st">&quot;Tinv&quot;</span>, <span class="st">&quot;VHD&quot;</span>, <span class="st">&quot;CAD&quot;</span>)]</a>
<a class="sourceLine" id="cb423-2" title="2"><span class="co">#TenVars</span></a></code></pre></div>
</div>
<div id="creating-a-second-final-variable-data-set-using-the-fselectorrcpp-package" class="section level4">
<h4>Creating a second final variable data set using the FSelectorRcpp package:</h4>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb424-1" title="1">TenVars2 &lt;-<span class="st"> </span>AllvFinal[, <span class="kw">c</span>(<span class="st">&quot;TCP&quot;</span>, <span class="st">&quot;ACP&quot;</span>, <span class="st">&quot;RWMA&quot;</span>, <span class="st">&quot;EF&quot;</span>, <span class="st">&quot;HTN&quot;</span>, <span class="st">&quot;Age&quot;</span>, <span class="st">&quot;DM&quot;</span>, <span class="st">&quot;NCP&quot;</span>, <span class="st">&quot;Tinv&quot;</span>, <span class="st">&quot;FBS&quot;</span>, <span class="st">&quot;CAD&quot;</span>)]</a>
<a class="sourceLine" id="cb424-2" title="2"><span class="co">#TenVars2</span></a></code></pre></div>
</div>
<div id="using-createdatapartition-to-split-data-into-training-and-test-sets-75-and-25.-since-the-outcome-variable-cad-is-categorical-this-function-will-make-sure-that-the-distribution-of-outcome-variable-classes-will-be-similar-in-both-of-the-sets.-can-use-the-same-split-for-trainingtesting-by-commenting-out-this-chunk" class="section level4">
<h4>Using createDataPartition() to split data into training and test sets (75% and 25%). Since the outcome variable (CAD) is categorical, this function will make sure that the distribution of outcome variable classes will be similar in both of the sets. Can use the same split for training/testing by commenting out this chunk:</h4>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb425-1" title="1"><span class="kw">library</span>(caret)</a>
<a class="sourceLine" id="cb425-2" title="2"></a>
<a class="sourceLine" id="cb425-3" title="3">index &lt;-<span class="st"> </span><span class="kw">createDataPartition</span>(AllvFinal<span class="op">$</span>CAD, <span class="dt">p =</span> <span class="fl">0.75</span>, <span class="dt">list =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb425-4" title="4">AllvFtrain &lt;-<span class="st"> </span>AllvFinal[ index,]</a>
<a class="sourceLine" id="cb425-5" title="5">AllvFtest &lt;-<span class="st"> </span>AllvFinal[<span class="op">-</span>index,]</a>
<a class="sourceLine" id="cb425-6" title="6"></a>
<a class="sourceLine" id="cb425-7" title="7"><span class="co">#str(AllvFtrain)</span></a>
<a class="sourceLine" id="cb425-8" title="8"><span class="co">#str(AllvFtest)</span></a></code></pre></div>
</div>
<div id="using-recursive-feature-elimination-to-find-the-best-subset-of-atttributes-to-use-for-modeling-not-needed-for-subsequent-runs-once-the-final-set-of-predictors-have-been-determined" class="section level4">
<h4>Using ‘Recursive Feature Elimination’ to find the best subset of atttributes to use for modeling (not needed for subsequent runs once the final set of predictors have been determined):</h4>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb426-1" title="1"><span class="kw">library</span>(plyr); <span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb426-2" title="2"></a>
<a class="sourceLine" id="cb426-3" title="3">control &lt;-<span class="st"> </span><span class="kw">rfeControl</span>(<span class="dt">functions =</span> rfFuncs,</a>
<a class="sourceLine" id="cb426-4" title="4">                   <span class="dt">method =</span> <span class="st">&quot;repeatedcv&quot;</span>,</a>
<a class="sourceLine" id="cb426-5" title="5">                   <span class="dt">repeats =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb426-6" title="6">                   <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb426-7" title="7">outcomeName &lt;-<span class="st"> &#39;CAD&#39;</span></a>
<a class="sourceLine" id="cb426-8" title="8">predictors &lt;-<span class="st"> </span><span class="kw">names</span>(AllvFtrain)[<span class="op">!</span><span class="kw">names</span>(AllvFtrain) <span class="op">%in%</span><span class="st"> </span>outcomeName]</a>
<a class="sourceLine" id="cb426-9" title="9">CAD_Profile &lt;-<span class="st"> </span><span class="kw">rfe</span>(AllvFtrain[,predictors], AllvFtrain[,outcomeName],</a>
<a class="sourceLine" id="cb426-10" title="10">                   <span class="dt">rfeControl =</span> control)</a>
<a class="sourceLine" id="cb426-11" title="11"></a>
<a class="sourceLine" id="cb426-12" title="12">CAD_Profile</a></code></pre></div>
<pre><code>## 
## Recursive feature selection
## 
## Outer resampling method: Cross-Validated (10 fold, repeated 10 times) 
## 
## Resampling performance over subset size:
## 
##  Variables Accuracy  Kappa AccuracySD KappaSD Selected
##          4   0.7722 0.4192    0.08019  0.2109         
##          8   0.8277 0.5584    0.07138  0.1860         
##         16   0.8267 0.5662    0.07274  0.1871         
##         52   0.8541 0.6273    0.06454  0.1771        *
## 
## The top 5 variables (out of 52):
##    TCP, ACP, RWMA, EF, Tinv</code></pre>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb428-1" title="1">CAD_Profile<span class="op">$</span>optVariables[<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>]</a></code></pre></div>
<pre><code>## [1] &quot;TCP&quot;  &quot;ACP&quot;  &quot;RWMA&quot; &quot;EF&quot;   &quot;Tinv&quot; &quot;HTN&quot;  &quot;Age&quot;  &quot;DM&quot;</code></pre>
</div>
<div id="taking-the-top-8-predictors" class="section level4">
<h4>Taking the top 8 predictors:</h4>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb430-1" title="1">predictors &lt;-<span class="kw">c</span>(<span class="st">&quot;TCP&quot;</span>, <span class="st">&quot;EF&quot;</span>, <span class="st">&quot;RWMA&quot;</span>, <span class="st">&quot;NCP&quot;</span>, <span class="st">&quot;ACP&quot;</span>, <span class="st">&quot;HTN&quot;</span>, <span class="st">&quot;Age&quot;</span>, <span class="st">&quot;DM&quot;</span>)</a></code></pre></div>
</div>
<div id="visualize-degree-of-class-imbalance" class="section level4">
<h4>Visualize degree of class imbalance:</h4>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb431-1" title="1"><span class="kw">library</span>(ggsignif)</a>
<a class="sourceLine" id="cb431-2" title="2"><span class="kw">library</span>(ggsci)</a>
<a class="sourceLine" id="cb431-3" title="3"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb431-4" title="4"></a>
<a class="sourceLine" id="cb431-5" title="5"></a>
<a class="sourceLine" id="cb431-6" title="6"><span class="kw">ggplot</span>(AllvFinal, <span class="kw">aes</span>(CAD)) <span class="op">+</span></a>
<a class="sourceLine" id="cb431-7" title="7"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">fill =</span> <span class="st">&quot;#0073C2FF&quot;</span>)</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-95-1.png" width="672" /></p>
</div>
<div id="function-created-to-provide-additional-metrics-for-evaluation" class="section level4">
<h4>Function created to provide additional metrics for evaluation:</h4>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb432-1" title="1">MySummary  &lt;-<span class="st"> </span><span class="cf">function</span>(data, <span class="dt">lev =</span> <span class="ot">NULL</span>, <span class="dt">model =</span> <span class="ot">NULL</span>){</a>
<a class="sourceLine" id="cb432-2" title="2">  a1 &lt;-<span class="st"> </span><span class="kw">defaultSummary</span>(data, lev, model)</a>
<a class="sourceLine" id="cb432-3" title="3">  b1 &lt;-<span class="st"> </span><span class="kw">twoClassSummary</span>(data, lev, model)</a>
<a class="sourceLine" id="cb432-4" title="4">  c1 &lt;-<span class="st"> </span><span class="kw">prSummary</span>(data, lev, model)</a>
<a class="sourceLine" id="cb432-5" title="5">  out &lt;-<span class="st"> </span><span class="kw">c</span>(a1, b1, c1)</a>
<a class="sourceLine" id="cb432-6" title="6">  out}</a></code></pre></div>
</div>
</div>
<div id="random-forest-training-note-using-down-for-subsampling-for-class-imbalance-since-smote-introduces-nas-into-the-results" class="section level3">
<h3>Random Forest Training (Note: Using “down” for subsampling for class imbalance since “smote” introduces NA’s into the results):</h3>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb433-1" title="1"><span class="kw">library</span>(tictoc)</a>
<a class="sourceLine" id="cb433-2" title="2"><span class="kw">library</span>(caret)</a>
<a class="sourceLine" id="cb433-3" title="3"><span class="kw">library</span>(DMwR)</a>
<a class="sourceLine" id="cb433-4" title="4"></a>
<a class="sourceLine" id="cb433-5" title="5"><span class="kw">tic</span>(<span class="st">&quot;Random Forest Algorithm Timing&quot;</span>)</a>
<a class="sourceLine" id="cb433-6" title="6"></a>
<a class="sourceLine" id="cb433-7" title="7">RFControl &lt;-<span class="st"> </span><span class="kw">trainControl</span>(<span class="dt">method =</span> <span class="st">&quot;repeatedcv&quot;</span>, <span class="dt">number =</span> <span class="dv">10</span>, <span class="dt">repeats =</span> <span class="dv">3</span>, <span class="dt">sampling =</span> <span class="st">&quot;down&quot;</span>, <span class="dt">savePredictions =</span> <span class="ot">TRUE</span>, <span class="dt">classProbs =</span> <span class="ot">TRUE</span>, <span class="dt">summaryFunction =</span> MySummary)</a>
<a class="sourceLine" id="cb433-8" title="8"></a>
<a class="sourceLine" id="cb433-9" title="9">rfFit &lt;-<span class="st"> </span><span class="kw">train</span>(AllvFtrain[,predictors], AllvFtrain[,outcomeName], <span class="dt">method =</span> <span class="st">&#39;rf&#39;</span>, <span class="dt">returnResamp =</span> <span class="st">&quot;all&quot;</span>, <span class="dt">trControl =</span> RFControl)</a>
<a class="sourceLine" id="cb433-10" title="10"></a>
<a class="sourceLine" id="cb433-11" title="11">rfFit<span class="op">$</span>results</a></code></pre></div>
<pre><code>##   mtry  Accuracy     Kappa       ROC      Sens      Spec       AUC
## 1    2 0.7955808 0.5454283 0.8905156 0.7938725 0.7992063 0.8191681
## 2    5 0.7952734 0.5433359 0.8828183 0.8020833 0.7769841 0.7050318
## 3    8 0.8083773 0.5708250 0.8739583 0.8082108 0.8071429 0.6577260
##   Precision    Recall         F AccuracySD   KappaSD      ROCSD     SensSD
## 1 0.9077673 0.7938725 0.8450911 0.07969212 0.1706799 0.07698716 0.08072623
## 2 0.8990254 0.8020833 0.8451536 0.08900606 0.1859755 0.08261898 0.10055034
## 3 0.9130152 0.8082108 0.8554324 0.07287774 0.1526769 0.08378821 0.07978045
##      SpecSD      AUCSD PrecisionSD   RecallSD        FSD
## 1 0.1429506 0.08176626  0.06435348 0.08072623 0.06357333
## 2 0.1321202 0.12984551  0.05931819 0.10055034 0.07146063
## 3 0.1274306 0.12331878  0.05575173 0.07978045 0.05997136</code></pre>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb435-1" title="1"><span class="co">#plot(rfFit)</span></a>
<a class="sourceLine" id="cb435-2" title="2"></a>
<a class="sourceLine" id="cb435-3" title="3">RFpredictions &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> rfFit, AllvFtest[,predictors], <span class="dt">type =</span> <span class="st">&#39;raw&#39;</span>)</a>
<a class="sourceLine" id="cb435-4" title="4"><span class="kw">table</span>(RFpredictions)</a></code></pre></div>
<pre><code>## RFpredictions
##    Cad Normal 
##     51     24</code></pre>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb437-1" title="1"><span class="kw">varImp</span>(<span class="dt">object =</span> rfFit)</a></code></pre></div>
<pre><code>## rf variable importance
## 
##      Overall
## TCP  100.000
## RWMA  18.554
## HTN   10.279
## EF     9.450
## ACP    8.997
## Age    7.788
## DM     3.911
## NCP    0.000</code></pre>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb439-1" title="1"><span class="kw">plot</span>(<span class="kw">varImp</span>(<span class="dt">object =</span> rfFit), <span class="dt">main=</span><span class="st">&quot;Random Forest - Variable Importance&quot;</span>)</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-97-1.png" width="672" /></p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb440-1" title="1"><span class="kw">confusionMatrix</span>(RFpredictions, AllvFtest[,outcomeName], <span class="dt">mode =</span> <span class="st">&#39;everything&#39;</span>)</a></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction Cad Normal
##     Cad     47      4
##     Normal   7     17
##                                           
##                Accuracy : 0.8533          
##                  95% CI : (0.7527, 0.9244)
##     No Information Rate : 0.72            
##     P-Value [Acc &gt; NIR] : 0.005071        
##                                           
##                   Kappa : 0.6515          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.546494        
##                                           
##             Sensitivity : 0.8704          
##             Specificity : 0.8095          
##          Pos Pred Value : 0.9216          
##          Neg Pred Value : 0.7083          
##               Precision : 0.9216          
##                  Recall : 0.8704          
##                      F1 : 0.8952          
##              Prevalence : 0.7200          
##          Detection Rate : 0.6267          
##    Detection Prevalence : 0.6800          
##       Balanced Accuracy : 0.8399          
##                                           
##        &#39;Positive&#39; Class : Cad             
## </code></pre>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb442-1" title="1">RFcMatrix1 &lt;-<span class="st"> </span><span class="kw">confusionMatrix</span>(RFpredictions, AllvFtest[,outcomeName], <span class="dt">mode =</span> <span class="st">&#39;everything&#39;</span>)</a>
<a class="sourceLine" id="cb442-2" title="2">RFcMatrix1<span class="op">$</span>table <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb442-3" title="3"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb442-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Prediction =</span> <span class="kw">factor</span>(Prediction, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Cad&quot;</span>, <span class="st">&quot;Normal&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb442-5" title="5"><span class="st">  </span><span class="kw">group_by</span>(Reference) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb442-6" title="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">total =</span> <span class="kw">sum</span>(Freq)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb442-7" title="7"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb442-8" title="8"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Reference, Prediction, <span class="dt">fill =</span> Freq)) <span class="op">+</span></a>
<a class="sourceLine" id="cb442-9" title="9"><span class="st">  </span><span class="kw">geom_tile</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb442-10" title="10"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> Freq), <span class="dt">size =</span> <span class="dv">8</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb442-11" title="11"><span class="st">  </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;palegreen4&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb442-12" title="12"><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">position =</span> <span class="st">&quot;top&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb442-13" title="13"><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">alpha =</span> <span class="dv">0</span>)</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-97-2.png" width="672" /></p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb443-1" title="1">EvalRF1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">c</span>(RFcMatrix1<span class="op">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], RFcMatrix1<span class="op">$</span>overall[<span class="st">&#39;Kappa&#39;</span>], RFcMatrix1<span class="op">$</span>byClass[<span class="st">&#39;Sensitivity&#39;</span>], RFcMatrix1<span class="op">$</span>byClass[<span class="st">&#39;Specificity&#39;</span>], RFcMatrix1<span class="op">$</span>byClass[<span class="st">&#39;Precision&#39;</span>], RFcMatrix1<span class="op">$</span>byClass[<span class="st">&#39;Recall&#39;</span>], RFcMatrix1<span class="op">$</span>byClass[<span class="st">&#39;F1&#39;</span>])) </a>
<a class="sourceLine" id="cb443-2" title="2"><span class="kw">colnames</span>(EvalRF1)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;Metrics&quot;</span></a>
<a class="sourceLine" id="cb443-3" title="3">EvalRF1</a></code></pre></div>
<pre><code>##               Metrics
## Accuracy    0.8533333
## Kappa       0.6514575
## Sensitivity 0.8703704
## Specificity 0.8095238
## Precision   0.9215686
## Recall      0.8703704
## F1          0.8952381</code></pre>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb445-1" title="1"><span class="co"># Calculating Matthew&#39;s Correlation Coefficient:</span></a>
<a class="sourceLine" id="cb445-2" title="2"></a>
<a class="sourceLine" id="cb445-3" title="3">RF1.TP &lt;-<span class="st"> </span>RFcMatrix1<span class="op">$</span>table[<span class="dv">1</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb445-4" title="4">RF1.TN &lt;-<span class="st"> </span>RFcMatrix1<span class="op">$</span>table[<span class="dv">2</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb445-5" title="5">RF1.FP &lt;-<span class="st"> </span>RFcMatrix1<span class="op">$</span>table[<span class="dv">1</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb445-6" title="6">RF1.FN &lt;-<span class="st"> </span>RFcMatrix1<span class="op">$</span>table[<span class="dv">2</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb445-7" title="7"></a>
<a class="sourceLine" id="cb445-8" title="8">RF1mcc_num &lt;-<span class="st"> </span>(RF1.TP<span class="op">*</span>RF1.TN) <span class="op">-</span><span class="st"> </span>(RF1.FP<span class="op">*</span>RF1.FN)</a>
<a class="sourceLine" id="cb445-9" title="9">RF1mcc_den &lt;-<span class="st"> </span><span class="kw">as.double</span>((RF1.TP<span class="op">+</span>RF1.FP))<span class="op">*</span><span class="kw">as.double</span>((RF1.TP<span class="op">+</span>RF1.FN))<span class="op">*</span><span class="kw">as.double</span>((RF1.TN<span class="op">+</span>RF1.FP))<span class="op">*</span><span class="kw">as.double</span>((RF1.TN<span class="op">+</span>RF1.FN))</a>
<a class="sourceLine" id="cb445-10" title="10"></a>
<a class="sourceLine" id="cb445-11" title="11">RF1mcc_final &lt;-<span class="st"> </span>RF1mcc_num<span class="op">/</span><span class="kw">sqrt</span>(RF1mcc_den)</a>
<a class="sourceLine" id="cb445-12" title="12">RF1mcc_final</a></code></pre></div>
<pre><code>## [1] 0.6544209</code></pre>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb447-1" title="1"><span class="kw">toc</span>()</a></code></pre></div>
<pre><code>## Random Forest Algorithm Timing: 5.62 sec elapsed</code></pre>
</div>
<div id="training-for-naive-bayes-note-using-down-for-subsampling-to-address-class-imbalance" class="section level3">
<h3>Training for Naive Bayes (Note: Using “down” for subsampling to address class imbalance):</h3>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb449-1" title="1"><span class="kw">library</span>(klaR)</a>
<a class="sourceLine" id="cb449-2" title="2"><span class="kw">library</span>(caret)</a>
<a class="sourceLine" id="cb449-3" title="3"></a>
<a class="sourceLine" id="cb449-4" title="4"><span class="kw">tic</span>(<span class="st">&quot;Naive Bayes Algorithm Timing&quot;</span>)</a>
<a class="sourceLine" id="cb449-5" title="5"></a>
<a class="sourceLine" id="cb449-6" title="6">NBControl &lt;-<span class="st"> </span><span class="kw">trainControl</span>(<span class="dt">method =</span> <span class="st">&quot;repeatedcv&quot;</span>, <span class="dt">number =</span> <span class="dv">10</span>, <span class="dt">repeats =</span> <span class="dv">3</span>, <span class="dt">sampling =</span> <span class="st">&quot;down&quot;</span>, <span class="dt">savePredictions =</span> <span class="ot">TRUE</span>, <span class="dt">classProbs =</span> <span class="ot">TRUE</span>, <span class="dt">summaryFunction =</span> MySummary)</a>
<a class="sourceLine" id="cb449-7" title="7"></a>
<a class="sourceLine" id="cb449-8" title="8">NBfit &lt;-<span class="st"> </span><span class="kw">train</span>(AllvFtrain[,predictors], AllvFtrain[,outcomeName], <span class="dt">method =</span> <span class="st">&#39;nb&#39;</span>, <span class="dt">returnResamp =</span> <span class="st">&quot;all&quot;</span>, <span class="dt">trControl =</span> NBControl)</a>
<a class="sourceLine" id="cb449-9" title="9">                 </a>
<a class="sourceLine" id="cb449-10" title="10">NBfit<span class="op">$</span>results</a></code></pre></div>
<pre><code>##   usekernel fL adjust  Accuracy     Kappa       ROC      Sens      Spec
## 1     FALSE  0      1 0.8409640 0.6366675 0.9198515 0.8497549 0.8222222
## 2      TRUE  0      1 0.8484684 0.6519206 0.9221420 0.8561275 0.8325397
##         AUC Precision    Recall         F AccuracySD   KappaSD      ROCSD
## 1 0.8866666 0.9238249 0.8497549 0.8820015 0.07022706 0.1561499 0.06870770
## 2 0.8878770 0.9286292 0.8561275 0.8881215 0.07562012 0.1745292 0.06222516
##       SensSD    SpecSD      AUCSD PrecisionSD   RecallSD        FSD
## 1 0.08705866 0.1432307 0.04545725  0.05814829 0.08705866 0.05486183
## 2 0.08295751 0.1592268 0.04220411  0.06366851 0.08295751 0.05719891</code></pre>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb451-1" title="1"><span class="co">#plot(NBfit)</span></a>
<a class="sourceLine" id="cb451-2" title="2"></a>
<a class="sourceLine" id="cb451-3" title="3"><span class="kw">varImp</span>(<span class="dt">object =</span> NBfit)</a></code></pre></div>
<pre><code>## ROC curve variable importance
## 
##      Importance
## TCP      100.00
## ACP       76.58
## EF        61.22
## HTN       50.59
## RWMA      44.79
## Age       36.09
## DM        33.19
## NCP        0.00</code></pre>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb453-1" title="1"><span class="kw">plot</span>(<span class="kw">varImp</span>(<span class="dt">object =</span> NBfit),<span class="dt">main=</span><span class="st">&quot;Naive Bayes - Variable Importance&quot;</span>)</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-98-1.png" width="672" /></p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb454-1" title="1"><span class="co"># Naive Bayes Predictions:</span></a>
<a class="sourceLine" id="cb454-2" title="2">NBpredictions &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> NBfit, AllvFtest[,predictors], <span class="dt">type =</span> <span class="st">&#39;raw&#39;</span>)</a>
<a class="sourceLine" id="cb454-3" title="3"><span class="kw">table</span>(NBpredictions)</a></code></pre></div>
<pre><code>## NBpredictions
##    Cad Normal 
##     48     27</code></pre>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb456-1" title="1"><span class="kw">confusionMatrix</span>(NBpredictions, AllvFtest[,outcomeName], <span class="dt">mode =</span> <span class="st">&#39;everything&#39;</span>)</a></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction Cad Normal
##     Cad     47      1
##     Normal   7     20
##                                           
##                Accuracy : 0.8933          
##                  95% CI : (0.8006, 0.9528)
##     No Information Rate : 0.72            
##     P-Value [Acc &gt; NIR] : 0.0002469       
##                                           
##                   Kappa : 0.7567          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.0770999       
##                                           
##             Sensitivity : 0.8704          
##             Specificity : 0.9524          
##          Pos Pred Value : 0.9792          
##          Neg Pred Value : 0.7407          
##               Precision : 0.9792          
##                  Recall : 0.8704          
##                      F1 : 0.9216          
##              Prevalence : 0.7200          
##          Detection Rate : 0.6267          
##    Detection Prevalence : 0.6400          
##       Balanced Accuracy : 0.9114          
##                                           
##        &#39;Positive&#39; Class : Cad             
## </code></pre>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb458-1" title="1">NBcMatrix1 &lt;-<span class="st"> </span><span class="kw">confusionMatrix</span>(NBpredictions, AllvFtest[,outcomeName], <span class="dt">mode =</span> <span class="st">&#39;everything&#39;</span>)</a>
<a class="sourceLine" id="cb458-2" title="2">NBcMatrix1<span class="op">$</span>table <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb458-3" title="3"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb458-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Prediction =</span> <span class="kw">factor</span>(Prediction, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Cad&quot;</span>, <span class="st">&quot;Normal&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb458-5" title="5"><span class="st">  </span><span class="kw">group_by</span>(Reference) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb458-6" title="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">total =</span> <span class="kw">sum</span>(Freq)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb458-7" title="7"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb458-8" title="8"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Reference, Prediction, <span class="dt">fill =</span> Freq)) <span class="op">+</span></a>
<a class="sourceLine" id="cb458-9" title="9"><span class="st">  </span><span class="kw">geom_tile</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb458-10" title="10"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> Freq), <span class="dt">size =</span> <span class="dv">8</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb458-11" title="11"><span class="st">  </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;palegreen4&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb458-12" title="12"><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">position =</span> <span class="st">&quot;top&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb458-13" title="13"><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">alpha =</span> <span class="dv">0</span>)</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-98-2.png" width="672" /></p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb459-1" title="1">EvalNB1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">c</span>(NBcMatrix1<span class="op">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], NBcMatrix1<span class="op">$</span>overall[<span class="st">&#39;Kappa&#39;</span>], NBcMatrix1<span class="op">$</span>byClass[<span class="st">&#39;Sensitivity&#39;</span>], NBcMatrix1<span class="op">$</span>byClass[<span class="st">&#39;Specificity&#39;</span>], NBcMatrix1<span class="op">$</span>byClass[<span class="st">&#39;Precision&#39;</span>], NBcMatrix1<span class="op">$</span>byClass[<span class="st">&#39;Recall&#39;</span>], NBcMatrix1<span class="op">$</span>byClass[<span class="st">&#39;F1&#39;</span>])) </a>
<a class="sourceLine" id="cb459-2" title="2"><span class="kw">colnames</span>(EvalNB1)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;Metrics&quot;</span></a>
<a class="sourceLine" id="cb459-3" title="3">EvalNB1</a></code></pre></div>
<pre><code>##               Metrics
## Accuracy    0.8933333
## Kappa       0.7566910
## Sensitivity 0.8703704
## Specificity 0.9523810
## Precision   0.9791667
## Recall      0.8703704
## F1          0.9215686</code></pre>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb461-1" title="1"><span class="co"># Calculating Matthew&#39;s Correlation Coefficient:</span></a>
<a class="sourceLine" id="cb461-2" title="2"></a>
<a class="sourceLine" id="cb461-3" title="3">NB1.TP &lt;-<span class="st"> </span>NBcMatrix1<span class="op">$</span>table[<span class="dv">1</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb461-4" title="4">NB1.TN &lt;-<span class="st"> </span>NBcMatrix1<span class="op">$</span>table[<span class="dv">2</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb461-5" title="5">NB1.FP &lt;-<span class="st"> </span>NBcMatrix1<span class="op">$</span>table[<span class="dv">1</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb461-6" title="6">NB1.FN &lt;-<span class="st"> </span>NBcMatrix1<span class="op">$</span>table[<span class="dv">2</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb461-7" title="7"></a>
<a class="sourceLine" id="cb461-8" title="8">NB1mcc_num &lt;-<span class="st"> </span>(NB1.TP<span class="op">*</span>NB1.TN) <span class="op">-</span><span class="st"> </span>(NB1.FP<span class="op">*</span>NB1.FN)</a>
<a class="sourceLine" id="cb461-9" title="9">NB1mcc_den &lt;-<span class="st"> </span><span class="kw">as.double</span>((NB1.TP<span class="op">+</span>NB1.FP))<span class="op">*</span><span class="kw">as.double</span>((NB1.TP<span class="op">+</span>NB1.FN))<span class="op">*</span><span class="kw">as.double</span>((NB1.TN<span class="op">+</span>NB1.FP))<span class="op">*</span><span class="kw">as.double</span>((NB1.TN<span class="op">+</span>NB1.FN))</a>
<a class="sourceLine" id="cb461-10" title="10"></a>
<a class="sourceLine" id="cb461-11" title="11">NB1mcc_final &lt;-<span class="st"> </span>NB1mcc_num<span class="op">/</span><span class="kw">sqrt</span>(NB1mcc_den)</a>
<a class="sourceLine" id="cb461-12" title="12">NB1mcc_final</a></code></pre></div>
<pre><code>## [1] 0.7696134</code></pre>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb463-1" title="1"><span class="kw">toc</span>()</a></code></pre></div>
<pre><code>## Naive Bayes Algorithm Timing: 2.77 sec elapsed</code></pre>
</div>
<div id="training-for-logistic-regression-note-using-smote-subsampling-to-address-class-imbalance" class="section level3">
<h3>Training for Logistic Regression (Note: Using ‘smote’ subsampling to address class imbalance):</h3>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb465-1" title="1"><span class="kw">tic</span>(<span class="st">&quot;Logistic Regression Algorithm Timing&quot;</span>)</a>
<a class="sourceLine" id="cb465-2" title="2"></a>
<a class="sourceLine" id="cb465-3" title="3">LRControl &lt;-<span class="st"> </span><span class="kw">trainControl</span>(<span class="dt">method =</span> <span class="st">&quot;repeatedcv&quot;</span>, <span class="dt">number =</span> <span class="dv">10</span>, <span class="dt">repeats =</span> <span class="dv">3</span>, <span class="dt">sampling =</span> <span class="st">&quot;smote&quot;</span>, <span class="dt">savePredictions =</span> <span class="ot">TRUE</span>, <span class="dt">classProbs =</span> <span class="ot">TRUE</span>, <span class="dt">summaryFunction =</span> MySummary)</a>
<a class="sourceLine" id="cb465-4" title="4"></a>
<a class="sourceLine" id="cb465-5" title="5">LRFit &lt;-<span class="st"> </span><span class="kw">train</span>(AllvFtrain[,predictors], AllvFtrain[,outcomeName], <span class="dt">method =</span> <span class="st">&#39;glm&#39;</span>, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>, <span class="dt">trControl =</span> LRControl)</a>
<a class="sourceLine" id="cb465-6" title="6">LRFit<span class="op">$</span>results</a></code></pre></div>
<pre><code>##   parameter  Accuracy     Kappa       ROC      Sens Spec       AUC
## 1      none 0.8459816 0.6028281 0.9211689 0.9256127 0.65 0.8800816
##   Precision    Recall         F AccuracySD   KappaSD      ROCSD     SensSD
## 1  0.870367 0.9256127 0.8949447 0.06239763 0.1686914 0.04883568 0.06769226
##      SpecSD     AUCSD PrecisionSD   RecallSD      FSD
## 1 0.1689557 0.0580679  0.05509047 0.06769226 0.042172</code></pre>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb467-1" title="1"><span class="kw">varImp</span>(<span class="dt">object =</span> LRFit)</a></code></pre></div>
<pre><code>## glm variable importance
## 
##         Overall
## TCP1   100.0000
## Age.L   88.0537
## HTN1    80.8146
## RWMA.L  67.2687
## EF.L    58.0701
## DM1     56.7755
## ACPY     0.5168
## NCPY     0.0000</code></pre>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb469-1" title="1"><span class="kw">plot</span>(<span class="kw">varImp</span>(<span class="dt">object =</span> LRFit), <span class="dt">main=</span><span class="st">&quot;Logistic Regression - Variable Importance&quot;</span>)</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-99-1.png" width="672" /></p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb470-1" title="1"><span class="co"># Logistic Regression Predictions:</span></a>
<a class="sourceLine" id="cb470-2" title="2"></a>
<a class="sourceLine" id="cb470-3" title="3">LRpredictions &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> LRFit, AllvFtest[,predictors], <span class="dt">type =</span> <span class="st">&#39;raw&#39;</span>)</a>
<a class="sourceLine" id="cb470-4" title="4"><span class="kw">table</span>(LRpredictions)</a></code></pre></div>
<pre><code>## LRpredictions
##    Cad Normal 
##     59     16</code></pre>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb472-1" title="1"><span class="kw">confusionMatrix</span>(LRpredictions, AllvFtest[,outcomeName], <span class="dt">mode =</span> <span class="st">&#39;everything&#39;</span>)</a></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction Cad Normal
##     Cad     51      8
##     Normal   3     13
##                                           
##                Accuracy : 0.8533          
##                  95% CI : (0.7527, 0.9244)
##     No Information Rate : 0.72            
##     P-Value [Acc &gt; NIR] : 0.005071        
##                                           
##                   Kappa : 0.6077          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.227800        
##                                           
##             Sensitivity : 0.9444          
##             Specificity : 0.6190          
##          Pos Pred Value : 0.8644          
##          Neg Pred Value : 0.8125          
##               Precision : 0.8644          
##                  Recall : 0.9444          
##                      F1 : 0.9027          
##              Prevalence : 0.7200          
##          Detection Rate : 0.6800          
##    Detection Prevalence : 0.7867          
##       Balanced Accuracy : 0.7817          
##                                           
##        &#39;Positive&#39; Class : Cad             
## </code></pre>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb474-1" title="1">LRcMatrix1 &lt;-<span class="st"> </span><span class="kw">confusionMatrix</span>(LRpredictions, AllvFtest[,outcomeName], <span class="dt">mode =</span> <span class="st">&#39;everything&#39;</span>)</a>
<a class="sourceLine" id="cb474-2" title="2">LRcMatrix1<span class="op">$</span>table <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb474-3" title="3"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb474-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Prediction =</span> <span class="kw">factor</span>(Prediction, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Cad&quot;</span>, <span class="st">&quot;Normal&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb474-5" title="5"><span class="st">  </span><span class="kw">group_by</span>(Reference) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb474-6" title="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">total =</span> <span class="kw">sum</span>(Freq)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb474-7" title="7"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb474-8" title="8"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Reference, Prediction, <span class="dt">fill =</span> Freq)) <span class="op">+</span></a>
<a class="sourceLine" id="cb474-9" title="9"><span class="st">  </span><span class="kw">geom_tile</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb474-10" title="10"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> Freq), <span class="dt">size =</span> <span class="dv">8</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb474-11" title="11"><span class="st">  </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;palegreen4&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb474-12" title="12"><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">position =</span> <span class="st">&quot;top&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb474-13" title="13"><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">alpha =</span> <span class="dv">0</span>)</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-99-2.png" width="672" /></p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb475-1" title="1">EvalLR1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">c</span>(LRcMatrix1<span class="op">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], LRcMatrix1<span class="op">$</span>overall[<span class="st">&#39;Kappa&#39;</span>], LRcMatrix1<span class="op">$</span>byClass[<span class="st">&#39;Sensitivity&#39;</span>], LRcMatrix1<span class="op">$</span>byClass[<span class="st">&#39;Specificity&#39;</span>], LRcMatrix1<span class="op">$</span>byClass[<span class="st">&#39;Precision&#39;</span>], LRcMatrix1<span class="op">$</span>byClass[<span class="st">&#39;Recall&#39;</span>], LRcMatrix1<span class="op">$</span>byClass[<span class="st">&#39;F1&#39;</span>])) </a>
<a class="sourceLine" id="cb475-2" title="2"><span class="kw">colnames</span>(EvalLR1)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;Metrics&quot;</span></a>
<a class="sourceLine" id="cb475-3" title="3">EvalLR1</a></code></pre></div>
<pre><code>##               Metrics
## Accuracy    0.8533333
## Kappa       0.6077033
## Sensitivity 0.9444444
## Specificity 0.6190476
## Precision   0.8644068
## Recall      0.9444444
## F1          0.9026549</code></pre>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb477-1" title="1"><span class="co"># Calculating Matthew&#39;s Correlation Coefficient:</span></a>
<a class="sourceLine" id="cb477-2" title="2"></a>
<a class="sourceLine" id="cb477-3" title="3">LR1.TP &lt;-<span class="st"> </span>LRcMatrix1<span class="op">$</span>table[<span class="dv">1</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb477-4" title="4">LR1.TN &lt;-<span class="st"> </span>LRcMatrix1<span class="op">$</span>table[<span class="dv">2</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb477-5" title="5">LR1.FP &lt;-<span class="st"> </span>LRcMatrix1<span class="op">$</span>table[<span class="dv">1</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb477-6" title="6">LR1.FN &lt;-<span class="st"> </span>LRcMatrix1<span class="op">$</span>table[<span class="dv">2</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb477-7" title="7"></a>
<a class="sourceLine" id="cb477-8" title="8">LR1mcc_num &lt;-<span class="st"> </span>(LR1.TP<span class="op">*</span>LR1.TN) <span class="op">-</span><span class="st"> </span>(LR1.FP<span class="op">*</span>LR1.FN)</a>
<a class="sourceLine" id="cb477-9" title="9">LR1mcc_den &lt;-<span class="st"> </span><span class="kw">as.double</span>((LR1.TP<span class="op">+</span>LR1.FP))<span class="op">*</span><span class="kw">as.double</span>((LR1.TP<span class="op">+</span>LR1.FN))<span class="op">*</span><span class="kw">as.double</span>((LR1.TN<span class="op">+</span>LR1.FP))<span class="op">*</span><span class="kw">as.double</span>((LR1.TN<span class="op">+</span>LR1.FN))</a>
<a class="sourceLine" id="cb477-10" title="10"></a>
<a class="sourceLine" id="cb477-11" title="11">LR1mcc_final &lt;-<span class="st"> </span>LR1mcc_num<span class="op">/</span><span class="kw">sqrt</span>(LR1mcc_den)</a>
<a class="sourceLine" id="cb477-12" title="12">LR1mcc_final</a></code></pre></div>
<pre><code>## [1] 0.6176015</code></pre>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb479-1" title="1"><span class="kw">toc</span>()</a></code></pre></div>
<pre><code>## Logistic Regression Algorithm Timing: 2.39 sec elapsed</code></pre>
<div id="training-and-testing-for-all-three-algorithms-combined-different-parameters.-using-down-subsampling-to-address-class-imbalance" class="section level4">
<h4>Training and testing for all Three Algorithms Combined (different parameters). Using ‘down’ subsampling to address class imbalance:</h4>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb481-1" title="1"><span class="kw">library</span>(tictoc)</a>
<a class="sourceLine" id="cb481-2" title="2"><span class="kw">library</span>(caret)</a>
<a class="sourceLine" id="cb481-3" title="3"><span class="kw">library</span>(DMwR)</a>
<a class="sourceLine" id="cb481-4" title="4"></a>
<a class="sourceLine" id="cb481-5" title="5"><span class="kw">tic</span>(<span class="st">&quot;Three Combined Algorithms Timing&quot;</span>)</a>
<a class="sourceLine" id="cb481-6" title="6"></a>
<a class="sourceLine" id="cb481-7" title="7"><span class="co"># Defining the training control:</span></a>
<a class="sourceLine" id="cb481-8" title="8"></a>
<a class="sourceLine" id="cb481-9" title="9">ENCntrl &lt;-<span class="st"> </span><span class="kw">trainControl</span>(<span class="dt">method =</span> <span class="st">&quot;repeatedcv&quot;</span>, <span class="dt">number =</span> <span class="dv">10</span>, <span class="dt">repeats =</span> <span class="dv">3</span>, <span class="dt">sampling =</span> <span class="st">&quot;down&quot;</span>, <span class="dt">savePredictions =</span> <span class="ot">TRUE</span>, <span class="dt">classProbs =</span> <span class="ot">TRUE</span>, <span class="dt">summaryFunction =</span> MySummary)</a>
<a class="sourceLine" id="cb481-10" title="10"></a>
<a class="sourceLine" id="cb481-11" title="11"><span class="co"># Training the 3 models:</span></a>
<a class="sourceLine" id="cb481-12" title="12"></a>
<a class="sourceLine" id="cb481-13" title="13">RFmodel &lt;-<span class="st"> </span><span class="kw">train</span>(AllvFtrain[,predictors],AllvFtrain[,outcomeName], <span class="dt">method=</span><span class="st">&#39;rf&#39;</span>, <span class="dt">trControl =</span> ENCntrl)</a>
<a class="sourceLine" id="cb481-14" title="14"></a>
<a class="sourceLine" id="cb481-15" title="15">NBmodel &lt;-<span class="st"> </span><span class="kw">train</span>(AllvFtrain[,predictors],AllvFtrain[,outcomeName], <span class="dt">method=</span><span class="st">&#39;nb&#39;</span>, <span class="dt">trControl =</span> ENCntrl)</a>
<a class="sourceLine" id="cb481-16" title="16"></a>
<a class="sourceLine" id="cb481-17" title="17">LRmodel &lt;-<span class="st"> </span><span class="kw">train</span>(AllvFtrain[,predictors],AllvFtrain[,outcomeName], <span class="dt">method=</span><span class="st">&#39;glm&#39;</span>, <span class="dt">trControl =</span> ENCntrl)</a>
<a class="sourceLine" id="cb481-18" title="18"></a>
<a class="sourceLine" id="cb481-19" title="19"><span class="co"># Predictions on the test data set:</span></a>
<a class="sourceLine" id="cb481-20" title="20"></a>
<a class="sourceLine" id="cb481-21" title="21">RF_pred &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> RFmodel, AllvFtest[,predictors], <span class="dt">type =</span> <span class="st">&#39;raw&#39;</span>)</a>
<a class="sourceLine" id="cb481-22" title="22">NB_pred &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> NBmodel, AllvFtest[,predictors], <span class="dt">type =</span> <span class="st">&#39;raw&#39;</span>)</a>
<a class="sourceLine" id="cb481-23" title="23">LR_pred &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> LRmodel, AllvFtest[,predictors], <span class="dt">type =</span> <span class="st">&#39;raw&#39;</span>)</a>
<a class="sourceLine" id="cb481-24" title="24"></a>
<a class="sourceLine" id="cb481-25" title="25"><span class="kw">toc</span>()</a></code></pre></div>
</div>
<div id="variable-importance-and-confusion-matrix-for-the-random-forest-algorithm" class="section level4">
<h4>Variable importance and confusion matrix for the Random Forest algorithm:</h4>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb482-1" title="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb482-2" title="2"></a>
<a class="sourceLine" id="cb482-3" title="3"><span class="kw">varImp</span>(<span class="dt">object =</span> RFmodel)</a></code></pre></div>
<pre><code>## rf variable importance
## 
##      Overall
## TCP   100.00
## RWMA   41.62
## HTN    27.82
## ACP    24.62
## EF     24.51
## DM     23.25
## Age    21.16
## NCP     0.00</code></pre>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb484-1" title="1"><span class="kw">plot</span>(<span class="kw">varImp</span>(<span class="dt">object =</span> RFmodel), <span class="dt">main=</span><span class="st">&quot;Random Forest - Variable Importance&quot;</span>)</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-101-1.png" width="672" /></p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb485-1" title="1"><span class="kw">confusionMatrix</span>(RF_pred, AllvFtest[,outcomeName], <span class="dt">mode =</span> <span class="st">&#39;everything&#39;</span>)</a></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction Cad Normal
##     Cad     50      1
##     Normal   4     20
##                                          
##                Accuracy : 0.9333         
##                  95% CI : (0.8512, 0.978)
##     No Information Rate : 0.72           
##     P-Value [Acc &gt; NIR] : 3.705e-06      
##                                          
##                   Kappa : 0.8416         
##                                          
##  Mcnemar&#39;s Test P-Value : 0.3711         
##                                          
##             Sensitivity : 0.9259         
##             Specificity : 0.9524         
##          Pos Pred Value : 0.9804         
##          Neg Pred Value : 0.8333         
##               Precision : 0.9804         
##                  Recall : 0.9259         
##                      F1 : 0.9524         
##              Prevalence : 0.7200         
##          Detection Rate : 0.6667         
##    Detection Prevalence : 0.6800         
##       Balanced Accuracy : 0.9392         
##                                          
##        &#39;Positive&#39; Class : Cad            
## </code></pre>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb487-1" title="1">RFcMatrix2 &lt;-<span class="st"> </span><span class="kw">confusionMatrix</span>(RF_pred, AllvFtest[,outcomeName], <span class="dt">mode =</span> <span class="st">&#39;everything&#39;</span>)</a>
<a class="sourceLine" id="cb487-2" title="2">RFcMatrix2<span class="op">$</span>table <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb487-3" title="3"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb487-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Prediction =</span> <span class="kw">factor</span>(Prediction, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Cad&quot;</span>, <span class="st">&quot;Normal&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb487-5" title="5"><span class="st">  </span><span class="kw">group_by</span>(Reference) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb487-6" title="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">total =</span> <span class="kw">sum</span>(Freq)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb487-7" title="7"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb487-8" title="8"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Reference, Prediction, <span class="dt">fill =</span> Freq)) <span class="op">+</span></a>
<a class="sourceLine" id="cb487-9" title="9"><span class="st">  </span><span class="kw">geom_tile</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb487-10" title="10"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> Freq), <span class="dt">size =</span> <span class="dv">8</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb487-11" title="11"><span class="st">  </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;palegreen4&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb487-12" title="12"><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">position =</span> <span class="st">&quot;top&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb487-13" title="13"><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">alpha =</span> <span class="dv">0</span>)</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-101-2.png" width="672" /></p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb488-1" title="1">EvalRF2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">c</span>(RFcMatrix2<span class="op">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], RFcMatrix2<span class="op">$</span>overall[<span class="st">&#39;Kappa&#39;</span>], RFcMatrix2<span class="op">$</span>byClass[<span class="st">&#39;Sensitivity&#39;</span>], RFcMatrix2<span class="op">$</span>byClass[<span class="st">&#39;Specificity&#39;</span>], RFcMatrix2<span class="op">$</span>byClass[<span class="st">&#39;Precision&#39;</span>], RFcMatrix2<span class="op">$</span>byClass[<span class="st">&#39;Recall&#39;</span>], RFcMatrix2<span class="op">$</span>byClass[<span class="st">&#39;F1&#39;</span>])) </a>
<a class="sourceLine" id="cb488-2" title="2"><span class="kw">colnames</span>(EvalRF2)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;Metrics&quot;</span></a>
<a class="sourceLine" id="cb488-3" title="3">EvalRF2</a></code></pre></div>
<pre><code>##               Metrics
## Accuracy    0.9333333
## Kappa       0.8415716
## Sensitivity 0.9259259
## Specificity 0.9523810
## Precision   0.9803922
## Recall      0.9259259
## F1          0.9523810</code></pre>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb490-1" title="1"><span class="co"># Calculating Matthew&#39;s Correlation Coefficient:</span></a>
<a class="sourceLine" id="cb490-2" title="2"></a>
<a class="sourceLine" id="cb490-3" title="3">RF2.TP &lt;-<span class="st"> </span>RFcMatrix2<span class="op">$</span>table[<span class="dv">1</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb490-4" title="4">RF2.TN &lt;-<span class="st"> </span>RFcMatrix2<span class="op">$</span>table[<span class="dv">2</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb490-5" title="5">RF2.FP &lt;-<span class="st"> </span>RFcMatrix2<span class="op">$</span>table[<span class="dv">1</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb490-6" title="6">RF2.FN &lt;-<span class="st"> </span>RFcMatrix2<span class="op">$</span>table[<span class="dv">2</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb490-7" title="7"></a>
<a class="sourceLine" id="cb490-8" title="8">RF2mcc_num &lt;-<span class="st"> </span>(RF2.TP<span class="op">*</span>RF2.TN) <span class="op">-</span><span class="st"> </span>(RF2.FP<span class="op">*</span>RF2.FN)</a>
<a class="sourceLine" id="cb490-9" title="9">RF2mcc_den &lt;-<span class="st"> </span><span class="kw">as.double</span>((RF2.TP<span class="op">+</span>RF2.FP))<span class="op">*</span><span class="kw">as.double</span>((RF2.TP<span class="op">+</span>RF2.FN))<span class="op">*</span><span class="kw">as.double</span>((RF2.TN<span class="op">+</span>RF2.FP))<span class="op">*</span><span class="kw">as.double</span>((RF2.TN<span class="op">+</span>RF2.FN))</a>
<a class="sourceLine" id="cb490-10" title="10"></a>
<a class="sourceLine" id="cb490-11" title="11">RF2mcc_final &lt;-<span class="st"> </span>RF2mcc_num<span class="op">/</span><span class="kw">sqrt</span>(RF2mcc_den)</a>
<a class="sourceLine" id="cb490-12" title="12">RF2mcc_final</a></code></pre></div>
<pre><code>## [1] 0.8453997</code></pre>
</div>
<div id="variable-importance-and-confusion-matrix-for-the-naive-bayes-algorithm" class="section level4">
<h4>Variable importance and confusion matrix for the Naive Bayes algorithm:</h4>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb492-1" title="1"><span class="kw">varImp</span>(<span class="dt">object =</span> NBmodel)</a></code></pre></div>
<pre><code>## ROC curve variable importance
## 
##      Importance
## TCP      100.00
## ACP       76.58
## EF        61.22
## HTN       50.59
## RWMA      44.79
## Age       36.09
## DM        33.19
## NCP        0.00</code></pre>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb494-1" title="1"><span class="kw">plot</span>(<span class="kw">varImp</span>(<span class="dt">object =</span> NBmodel), <span class="dt">main=</span><span class="st">&quot;Naive Bayes - Variable Importance&quot;</span>)</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-102-1.png" width="672" /></p>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb495-1" title="1"><span class="kw">confusionMatrix</span>(NB_pred, AllvFtest[,outcomeName], <span class="dt">mode =</span> <span class="st">&#39;everything&#39;</span>)</a></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction Cad Normal
##     Cad     47      1
##     Normal   7     20
##                                           
##                Accuracy : 0.8933          
##                  95% CI : (0.8006, 0.9528)
##     No Information Rate : 0.72            
##     P-Value [Acc &gt; NIR] : 0.0002469       
##                                           
##                   Kappa : 0.7567          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.0770999       
##                                           
##             Sensitivity : 0.8704          
##             Specificity : 0.9524          
##          Pos Pred Value : 0.9792          
##          Neg Pred Value : 0.7407          
##               Precision : 0.9792          
##                  Recall : 0.8704          
##                      F1 : 0.9216          
##              Prevalence : 0.7200          
##          Detection Rate : 0.6267          
##    Detection Prevalence : 0.6400          
##       Balanced Accuracy : 0.9114          
##                                           
##        &#39;Positive&#39; Class : Cad             
## </code></pre>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb497-1" title="1">NBcMatrix2 &lt;-<span class="st"> </span><span class="kw">confusionMatrix</span>(NB_pred, AllvFtest[,outcomeName], <span class="dt">mode =</span> <span class="st">&#39;everything&#39;</span>)</a>
<a class="sourceLine" id="cb497-2" title="2">NBcMatrix2<span class="op">$</span>table <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb497-3" title="3"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb497-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Prediction =</span> <span class="kw">factor</span>(Prediction, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Cad&quot;</span>, <span class="st">&quot;Normal&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb497-5" title="5"><span class="st">  </span><span class="kw">group_by</span>(Reference) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb497-6" title="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">total =</span> <span class="kw">sum</span>(Freq)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb497-7" title="7"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb497-8" title="8"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Reference, Prediction, <span class="dt">fill =</span> Freq)) <span class="op">+</span></a>
<a class="sourceLine" id="cb497-9" title="9"><span class="st">  </span><span class="kw">geom_tile</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb497-10" title="10"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> Freq), <span class="dt">size =</span> <span class="dv">8</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb497-11" title="11"><span class="st">  </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;palegreen4&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb497-12" title="12"><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">position =</span> <span class="st">&quot;top&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb497-13" title="13"><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">alpha =</span> <span class="dv">0</span>)</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-102-2.png" width="672" /></p>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb498-1" title="1">EvalNB2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">c</span>(NBcMatrix2<span class="op">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], NBcMatrix2<span class="op">$</span>overall[<span class="st">&#39;Kappa&#39;</span>], NBcMatrix2<span class="op">$</span>byClass[<span class="st">&#39;Sensitivity&#39;</span>], NBcMatrix2<span class="op">$</span>byClass[<span class="st">&#39;Specificity&#39;</span>], NBcMatrix2<span class="op">$</span>byClass[<span class="st">&#39;Precision&#39;</span>], NBcMatrix2<span class="op">$</span>byClass[<span class="st">&#39;Recall&#39;</span>], NBcMatrix2<span class="op">$</span>byClass[<span class="st">&#39;F1&#39;</span>])) </a>
<a class="sourceLine" id="cb498-2" title="2"><span class="kw">colnames</span>(EvalNB2)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;Metrics&quot;</span></a>
<a class="sourceLine" id="cb498-3" title="3">EvalNB2</a></code></pre></div>
<pre><code>##               Metrics
## Accuracy    0.8933333
## Kappa       0.7566910
## Sensitivity 0.8703704
## Specificity 0.9523810
## Precision   0.9791667
## Recall      0.8703704
## F1          0.9215686</code></pre>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb500-1" title="1"><span class="co"># Calculating Matthew&#39;s Correlation Coefficient:</span></a>
<a class="sourceLine" id="cb500-2" title="2"></a>
<a class="sourceLine" id="cb500-3" title="3">NB2.TP &lt;-<span class="st"> </span>NBcMatrix2<span class="op">$</span>table[<span class="dv">1</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb500-4" title="4">NB2.TN &lt;-<span class="st"> </span>NBcMatrix2<span class="op">$</span>table[<span class="dv">2</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb500-5" title="5">NB2.FP &lt;-<span class="st"> </span>NBcMatrix2<span class="op">$</span>table[<span class="dv">1</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb500-6" title="6">NB2.FN &lt;-<span class="st"> </span>NBcMatrix2<span class="op">$</span>table[<span class="dv">2</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb500-7" title="7"></a>
<a class="sourceLine" id="cb500-8" title="8">NB2mcc_num &lt;-<span class="st"> </span>(NB2.TP<span class="op">*</span>NB2.TN) <span class="op">-</span><span class="st"> </span>(NB2.FP<span class="op">*</span>NB2.FN)</a>
<a class="sourceLine" id="cb500-9" title="9">NB2mcc_den &lt;-<span class="st"> </span><span class="kw">as.double</span>((NB2.TP<span class="op">+</span>NB2.FP))<span class="op">*</span><span class="kw">as.double</span>((NB2.TP<span class="op">+</span>NB2.FN))<span class="op">*</span><span class="kw">as.double</span>((NB2.TN<span class="op">+</span>NB2.FP))<span class="op">*</span><span class="kw">as.double</span>((NB2.TN<span class="op">+</span>NB2.FN))</a>
<a class="sourceLine" id="cb500-10" title="10"></a>
<a class="sourceLine" id="cb500-11" title="11">NB2mcc_final &lt;-<span class="st"> </span>NB2mcc_num<span class="op">/</span><span class="kw">sqrt</span>(NB2mcc_den)</a>
<a class="sourceLine" id="cb500-12" title="12">NB2mcc_final</a></code></pre></div>
<pre><code>## [1] 0.7696134</code></pre>
</div>
<div id="variable-importance-and-confusion-matrix-for-the-logistic-regression-algorithm" class="section level4">
<h4>Variable importance and confusion matrix for the Logistic Regression algorithm:</h4>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb502-1" title="1"><span class="kw">varImp</span>(<span class="dt">object =</span> LRmodel)</a></code></pre></div>
<pre><code>## glm variable importance
## 
##        Overall
## TCP1   100.000
## RWMA.L  90.148
## DM1     86.264
## EF.L    71.017
## HTN1    63.133
## Age.L   42.124
## ACPY     5.367
## NCPY     0.000</code></pre>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb504-1" title="1"><span class="kw">plot</span>(<span class="kw">varImp</span>(<span class="dt">object =</span> LRmodel), <span class="dt">main=</span><span class="st">&quot;Logistic Regression - Variable Importance&quot;</span>)</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-103-1.png" width="672" /></p>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb505-1" title="1"><span class="kw">confusionMatrix</span>(LR_pred, AllvFtest[,outcomeName], <span class="dt">mode =</span> <span class="st">&#39;everything&#39;</span>)</a></code></pre></div>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction Cad Normal
##     Cad     48      3
##     Normal   6     18
##                                           
##                Accuracy : 0.88            
##                  95% CI : (0.7844, 0.9436)
##     No Information Rate : 0.72            
##     P-Value [Acc &gt; NIR] : 0.0007567       
##                                           
##                   Kappa : 0.7148          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.5049851       
##                                           
##             Sensitivity : 0.8889          
##             Specificity : 0.8571          
##          Pos Pred Value : 0.9412          
##          Neg Pred Value : 0.7500          
##               Precision : 0.9412          
##                  Recall : 0.8889          
##                      F1 : 0.9143          
##              Prevalence : 0.7200          
##          Detection Rate : 0.6400          
##    Detection Prevalence : 0.6800          
##       Balanced Accuracy : 0.8730          
##                                           
##        &#39;Positive&#39; Class : Cad             
## </code></pre>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb507-1" title="1">LRcMatrix2 &lt;-<span class="st"> </span><span class="kw">confusionMatrix</span>(LR_pred, AllvFtest[,outcomeName], <span class="dt">mode =</span> <span class="st">&#39;everything&#39;</span>)</a>
<a class="sourceLine" id="cb507-2" title="2">LRcMatrix2<span class="op">$</span>table <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb507-3" title="3"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb507-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Prediction =</span> <span class="kw">factor</span>(Prediction, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Cad&quot;</span>, <span class="st">&quot;Normal&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb507-5" title="5"><span class="st">  </span><span class="kw">group_by</span>(Reference) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb507-6" title="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">total =</span> <span class="kw">sum</span>(Freq)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb507-7" title="7"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb507-8" title="8"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(Reference, Prediction, <span class="dt">fill =</span> Freq)) <span class="op">+</span></a>
<a class="sourceLine" id="cb507-9" title="9"><span class="st">  </span><span class="kw">geom_tile</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb507-10" title="10"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> Freq), <span class="dt">size =</span> <span class="dv">8</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb507-11" title="11"><span class="st">  </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;palegreen4&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb507-12" title="12"><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">position =</span> <span class="st">&quot;top&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb507-13" title="13"><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">alpha =</span> <span class="dv">0</span>)</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-103-2.png" width="672" /></p>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb508-1" title="1">EvalLR2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">c</span>(LRcMatrix2<span class="op">$</span>overall[<span class="st">&#39;Accuracy&#39;</span>], LRcMatrix2<span class="op">$</span>overall[<span class="st">&#39;Kappa&#39;</span>], LRcMatrix2<span class="op">$</span>byClass[<span class="st">&#39;Sensitivity&#39;</span>], LRcMatrix2<span class="op">$</span>byClass[<span class="st">&#39;Specificity&#39;</span>], LRcMatrix2<span class="op">$</span>byClass[<span class="st">&#39;Precision&#39;</span>], LRcMatrix2<span class="op">$</span>byClass[<span class="st">&#39;Recall&#39;</span>], LRcMatrix2<span class="op">$</span>byClass[<span class="st">&#39;F1&#39;</span>])) </a>
<a class="sourceLine" id="cb508-2" title="2"><span class="kw">colnames</span>(EvalLR2)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;Metrics&quot;</span></a>
<a class="sourceLine" id="cb508-3" title="3">EvalLR2</a></code></pre></div>
<pre><code>##               Metrics
## Accuracy    0.8800000
## Kappa       0.7148289
## Sensitivity 0.8888889
## Specificity 0.8571429
## Precision   0.9411765
## Recall      0.8888889
## F1          0.9142857</code></pre>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb510-1" title="1"><span class="co"># Calculating Matthew&#39;s Correlation Coefficient:</span></a>
<a class="sourceLine" id="cb510-2" title="2"></a>
<a class="sourceLine" id="cb510-3" title="3">LR2.TP &lt;-<span class="st"> </span>LRcMatrix2<span class="op">$</span>table[<span class="dv">1</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb510-4" title="4">LR2.TN &lt;-<span class="st"> </span>LRcMatrix2<span class="op">$</span>table[<span class="dv">2</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb510-5" title="5">LR2.FP &lt;-<span class="st"> </span>LRcMatrix2<span class="op">$</span>table[<span class="dv">1</span>,<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb510-6" title="6">LR2.FN &lt;-<span class="st"> </span>LRcMatrix2<span class="op">$</span>table[<span class="dv">2</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb510-7" title="7"></a>
<a class="sourceLine" id="cb510-8" title="8">LR2mcc_num &lt;-<span class="st"> </span>(LR2.TP<span class="op">*</span>LR2.TN) <span class="op">-</span><span class="st"> </span>(LR2.FP<span class="op">*</span>LR2.FN)</a>
<a class="sourceLine" id="cb510-9" title="9">LR2mcc_den &lt;-<span class="st"> </span><span class="kw">as.double</span>((LR2.TP<span class="op">+</span>LR2.FP))<span class="op">*</span><span class="kw">as.double</span>((LR2.TP<span class="op">+</span>LR2.FN))<span class="op">*</span><span class="kw">as.double</span>((LR2.TN<span class="op">+</span>LR2.FP))<span class="op">*</span><span class="kw">as.double</span>((LR2.TN<span class="op">+</span>LR2.FN))</a>
<a class="sourceLine" id="cb510-10" title="10"></a>
<a class="sourceLine" id="cb510-11" title="11">LR2mcc_final &lt;-<span class="st"> </span>LR2mcc_num<span class="op">/</span><span class="kw">sqrt</span>(LR2mcc_den)</a>
<a class="sourceLine" id="cb510-12" title="12">LR2mcc_final</a></code></pre></div>
<pre><code>## [1] 0.7180805</code></pre>
</div>
<div id="ensemble-evaluation" class="section level4">
<h4>Ensemble evaluation:</h4>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb512-1" title="1"><span class="kw">library</span>(caretEnsemble)</a>
<a class="sourceLine" id="cb512-2" title="2"></a>
<a class="sourceLine" id="cb512-3" title="3">ENCntrl &lt;-<span class="st"> </span><span class="kw">trainControl</span>(<span class="dt">method =</span> <span class="st">&quot;LOOCV&quot;</span>, <span class="dt">number =</span> <span class="dv">10</span>, <span class="dt">search =</span> <span class="st">&quot;grid&quot;</span>, <span class="dt">savePredictions =</span> <span class="st">&quot;all&quot;</span>, <span class="dt">sampling =</span> <span class="st">&quot;down&quot;</span>)</a>
<a class="sourceLine" id="cb512-4" title="4"></a>
<a class="sourceLine" id="cb512-5" title="5">ENFit &lt;-<span class="st"> </span><span class="kw">caretList</span>(AllvFtrain[,predictors], AllvFtrain[,outcomeName], <span class="dt">methodList =</span> <span class="kw">c</span>(<span class="st">&quot;rf&quot;</span>, <span class="st">&quot;nb&quot;</span>, <span class="st">&quot;glm&quot;</span>))</a>
<a class="sourceLine" id="cb512-6" title="6">ENFit</a>
<a class="sourceLine" id="cb512-7" title="7"></a>
<a class="sourceLine" id="cb512-8" title="8">ENres &lt;-<span class="st"> </span><span class="kw">resamples</span>(ENFit)</a>
<a class="sourceLine" id="cb512-9" title="9"><span class="kw">summary</span>(ENFit)</a></code></pre></div>
</div>
<div id="checking-on-the-direction-of-log-odds-for-a-one-unit-increase-in-the-selected-features-using-logistic-regression-to-confirm-the-relationship-between-the-independent-variables-and-the-dependent-variable-cad-or-normal" class="section level4">
<h4>Checking on the direction of log odds for a one unit increase in the selected features (using logistic regression) to confirm the relationship between the independent variables and the dependent variable (CAD or Normal):</h4>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb513-1" title="1">logiTrain &lt;-<span class="st"> </span><span class="kw">data.frame</span>(AllvFtrain[,<span class="kw">c</span>(<span class="dv">23</span>,<span class="dv">51</span>,<span class="dv">27</span>,<span class="dv">26</span>,<span class="dv">50</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">53</span>)])</a>
<a class="sourceLine" id="cb513-2" title="2"></a>
<a class="sourceLine" id="cb513-3" title="3">logiTrain<span class="op">$</span>CAD &lt;-<span class="st"> </span><span class="kw">relevel</span>(logiTrain<span class="op">$</span>CAD, <span class="dt">ref =</span> <span class="st">&quot;Normal&quot;</span>)</a>
<a class="sourceLine" id="cb513-4" title="4"><span class="kw">str</span>(logiTrain)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    228 obs. of  9 variables:
##  $ TCP : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 2 1 2 2 2 1 1 2 1 ...
##  $ RWMA: Ord.factor w/ 2 levels &quot;Med&quot;&lt;&quot;High&quot;: 1 2 1 1 2 1 2 1 1 1 ...
##  $ NCP : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ ACP : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 2 2 1 1 ...
##  $ EF  : Ord.factor w/ 2 levels &quot;Low&quot;&lt;&quot;Med&quot;: 1 1 1 1 1 1 2 2 1 1 ...
##  $ Age : Ord.factor w/ 2 levels &quot;Med&quot;&lt;&quot;High&quot;: 2 2 1 2 2 2 2 2 2 1 ...
##  $ HTN : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 2 2 2 1 1 2 2 2 1 1 ...
##  $ DM  : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 1 2 1 2 2 2 1 ...
##  $ CAD : Factor w/ 2 levels &quot;Normal&quot;,&quot;Cad&quot;: 2 2 1 2 2 2 2 2 2 1 ...</code></pre>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb515-1" title="1">LRlogit &lt;-<span class="st"> </span><span class="kw">glm</span>(CAD<span class="op">~</span>.,logiTrain, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)</a>
<a class="sourceLine" id="cb515-2" title="2"><span class="kw">summary</span>(LRlogit)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = CAD ~ ., family = &quot;binomial&quot;, data = logiTrain)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.7605  -0.3679   0.1379   0.4058   2.1517  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -0.97739    0.70571  -1.385 0.166058    
## TCP1         3.12150    0.73133   4.268 1.97e-05 ***
## RWMA.L       1.59908    0.55622   2.875 0.004041 ** 
## NCPY        -0.39191    1.02599  -0.382 0.702477    
## ACPY         0.07263    0.64405   0.113 0.910211    
## EF.L        -1.14380    0.33156  -3.450 0.000561 ***
## Age.L        0.89566    0.37013   2.420 0.015526 *  
## HTN1         1.33229    0.45330   2.939 0.003292 ** 
## DM1          1.65896    0.58440   2.839 0.004529 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 274.37  on 227  degrees of freedom
## Residual deviance: 132.84  on 219  degrees of freedom
## AIC: 150.84
## 
## Number of Fisher Scoring iterations: 6</code></pre>
</div>
<div id="logistic-regression-coefficients-with-exponentiated-coefficients" class="section level4">
<h4>Logistic regression coefficients with exponentiated coefficients:</h4>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb517-1" title="1"><span class="kw">exp</span>(<span class="kw">coef</span>(LRlogit))</a></code></pre></div>
<pre><code>## (Intercept)        TCP1      RWMA.L        NCPY        ACPY        EF.L 
##   0.3762925  22.6804212   4.9484987   0.6757666   1.0753329   0.3186072 
##       Age.L        HTN1         DM1 
##   2.4489500   3.7897118   5.2538681</code></pre>
</div>
<div id="converting-to-log-odds-into-percentages-to-assist-with-interpretation-of-impact-of-each-independent-variable-used-in-the-logistic-regression" class="section level4">
<h4>Converting to log odds into percentages to assist with interpretation of impact of each independent variable used in the logistic regression:</h4>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb519-1" title="1"><span class="co"># The predicted value for TCP: the intercept, plus the dummy coefficient for TCP</span></a>
<a class="sourceLine" id="cb519-2" title="2"></a>
<a class="sourceLine" id="cb519-3" title="3">TCP1 &lt;-<span class="st"> </span><span class="kw">coef</span>(LRlogit)[<span class="st">&quot;(Intercept)&quot;</span>] <span class="op">+</span><span class="st"> </span><span class="kw">coef</span>(LRlogit)[<span class="st">&quot;TCP1&quot;</span>]</a>
<a class="sourceLine" id="cb519-4" title="4"></a>
<a class="sourceLine" id="cb519-5" title="5"><span class="co"># Converting the predicted value from log odds into percentage:</span></a>
<a class="sourceLine" id="cb519-6" title="6"></a>
<a class="sourceLine" id="cb519-7" title="7">TCPpresent &lt;-<span class="kw">exp</span>(TCP1)<span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(TCP1))</a>
<a class="sourceLine" id="cb519-8" title="8"></a>
<a class="sourceLine" id="cb519-9" title="9"><span class="co"># Now for RWMA:</span></a>
<a class="sourceLine" id="cb519-10" title="10">RWMA1 &lt;-<span class="st"> </span><span class="kw">coef</span>(LRlogit)[<span class="st">&quot;(Intercept)&quot;</span>] <span class="op">+</span><span class="st"> </span><span class="kw">coef</span>(LRlogit)[<span class="st">&quot;RWMAHigh&quot;</span>]</a>
<a class="sourceLine" id="cb519-11" title="11">RWMAhigh &lt;-<span class="st"> </span><span class="kw">exp</span>(RWMA1)<span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(RWMA1))</a>
<a class="sourceLine" id="cb519-12" title="12"></a>
<a class="sourceLine" id="cb519-13" title="13"><span class="co"># Now for NCP: (Note: not statistically signficant):</span></a>
<a class="sourceLine" id="cb519-14" title="14">NCP1 &lt;-<span class="st"> </span><span class="kw">coef</span>(LRlogit)[<span class="st">&quot;(Intercept)&quot;</span>] <span class="op">+</span><span class="st"> </span><span class="kw">coef</span>(LRlogit)[<span class="st">&quot;NCPY&quot;</span>]</a>
<a class="sourceLine" id="cb519-15" title="15">NCPpresent &lt;-<span class="st"> </span><span class="kw">exp</span>(NCP1)<span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(NCP1))</a>
<a class="sourceLine" id="cb519-16" title="16"></a>
<a class="sourceLine" id="cb519-17" title="17"><span class="co"># Now for ACP: (Note: also not statistically signficant):</span></a>
<a class="sourceLine" id="cb519-18" title="18">ACP1 &lt;-<span class="st"> </span><span class="kw">coef</span>(LRlogit)[<span class="st">&quot;(Intercept)&quot;</span>] <span class="op">+</span><span class="st"> </span><span class="kw">coef</span>(LRlogit)[<span class="st">&quot;ACPY&quot;</span>]</a>
<a class="sourceLine" id="cb519-19" title="19">ACPpresent &lt;-<span class="st"> </span><span class="kw">exp</span>(ACP1)<span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(ACP1))</a>
<a class="sourceLine" id="cb519-20" title="20"></a>
<a class="sourceLine" id="cb519-21" title="21"><span class="co"># Now for EF:</span></a>
<a class="sourceLine" id="cb519-22" title="22">EF1 &lt;-<span class="st"> </span><span class="kw">coef</span>(LRlogit)[<span class="st">&quot;(Intercept)&quot;</span>] <span class="op">+</span><span class="st"> </span><span class="kw">coef</span>(LRlogit)[<span class="st">&quot;EFMed&quot;</span>]</a>
<a class="sourceLine" id="cb519-23" title="23">EFnormal &lt;-<span class="st"> </span><span class="kw">exp</span>(EF1)<span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(EF1))</a>
<a class="sourceLine" id="cb519-24" title="24"></a>
<a class="sourceLine" id="cb519-25" title="25"><span class="co"># Now for Age:</span></a>
<a class="sourceLine" id="cb519-26" title="26">Age1 &lt;-<span class="st"> </span><span class="kw">coef</span>(LRlogit)[<span class="st">&quot;(Intercept)&quot;</span>] <span class="op">+</span><span class="st"> </span><span class="kw">coef</span>(LRlogit)[<span class="st">&quot;AgeHigh&quot;</span>]</a>
<a class="sourceLine" id="cb519-27" title="27">AgeHigh &lt;-<span class="st"> </span><span class="kw">exp</span>(Age1)<span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(Age1))</a>
<a class="sourceLine" id="cb519-28" title="28"></a>
<a class="sourceLine" id="cb519-29" title="29"><span class="co"># Now for HTN:</span></a>
<a class="sourceLine" id="cb519-30" title="30">HTN1 &lt;-<span class="st"> </span><span class="kw">coef</span>(LRlogit)[<span class="st">&quot;(Intercept)&quot;</span>] <span class="op">+</span><span class="st"> </span><span class="kw">coef</span>(LRlogit)[<span class="st">&quot;HTN1&quot;</span>]</a>
<a class="sourceLine" id="cb519-31" title="31">HTNpresent &lt;-<span class="st"> </span><span class="kw">exp</span>(HTN1)<span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(HTN1))</a>
<a class="sourceLine" id="cb519-32" title="32"></a>
<a class="sourceLine" id="cb519-33" title="33"><span class="co"># Now for DM:</span></a>
<a class="sourceLine" id="cb519-34" title="34">DM1 &lt;-<span class="st"> </span><span class="kw">coef</span>(LRlogit)[<span class="st">&quot;(Intercept)&quot;</span>] <span class="op">+</span><span class="st"> </span><span class="kw">coef</span>(LRlogit)[<span class="st">&quot;DM1&quot;</span>]</a>
<a class="sourceLine" id="cb519-35" title="35">DMpresent &lt;-<span class="st"> </span><span class="kw">exp</span>(DM1)<span class="op">/</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(DM1))</a>
<a class="sourceLine" id="cb519-36" title="36"></a>
<a class="sourceLine" id="cb519-37" title="37">LRPredPerc &lt;-<span class="st"> </span><span class="kw">data.frame</span>(TCPpresent, RWMAhigh, NCPpresent, ACPpresent, EFnormal, AgeHigh, HTNpresent, DMpresent)</a>
<a class="sourceLine" id="cb519-38" title="38"><span class="kw">t</span>(LRPredPerc)</a></code></pre></div>
<pre><code>##            (Intercept)
## TCPpresent   0.8951174
## RWMAhigh            NA
## NCPpresent   0.2027336
## ACPpresent   0.2880737
## EFnormal            NA
## AgeHigh             NA
## HTNpresent   0.5878057
## DMpresent    0.6640904</code></pre>
</div>
<div id="running-avova-function-on-the-model-to-analyze-the-table-of-deviance.-shows-that-there-is-a-significant-gap-between-the-null-model-with-only-the-intercept-and-the-residual-deviance-after-adding-each-variable.-adding-tcp-and-rwma-significantly-reduces-the-residual-deviance.-the-large-p-value-for-acp-indicates-that-the-model-without-this-variable-explains-approximately-the-same-amount-of-variation---that-is-it-has-little-impact." class="section level4">
<h4>Running avova() function on the model to analyze the table of deviance. Shows that there is a significant gap between the null model (with only the intercept) and the residual deviance (after adding each variable). Adding ‘TCP’ and ‘RWMA’ significantly reduces the residual deviance. (The large p-value for ‘ACP’ indicates that the model without this variable explains ‘approximately’ the same amount of variation - that is, it has little impact).</h4>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb521-1" title="1"><span class="kw">anova</span>(LRlogit, <span class="dt">test =</span> <span class="st">&quot;Chisq&quot;</span>)</a></code></pre></div>
<pre><code>## Analysis of Deviance Table
## 
## Model: binomial, link: logit
## 
## Response: CAD
## 
## Terms added sequentially (first to last)
## 
## 
##      Df Deviance Resid. Df Resid. Dev  Pr(&gt;Chi)    
## NULL                   227     274.37              
## TCP   1   72.253       226     202.11 &lt; 2.2e-16 ***
## RWMA  1   21.738       225     180.38 3.126e-06 ***
## NCP   1    0.847       224     179.53 0.3573886    
## ACP   1    1.294       223     178.23 0.2552364    
## EF    1   15.204       222     163.03 9.652e-05 ***
## Age   1    8.220       221     154.81 0.0041439 ** 
## HTN   1   12.585       220     142.22 0.0003889 ***
## DM    1    9.388       219     132.84 0.0021837 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="using-the-mcfadden-r-squared-index-to-assess-the-model-fit.-also-checking-very-rough-approximate-percentage-of-those-predicted-to-be-normal-versus-those-with-cad-using-logistic-regression-results.-compared-against-the-study-where-28.7-were-found-to-be-normal-87303-using-a-subset-of-this-data-set-with-228-observations-shows-a-prediction-of-36.5-being-normal." class="section level4">
<h4>Using the McFadden R Squared Index to assess the model fit. Also checking (very rough) approximate percentage of those predicted to be ‘Normal’ versus those with ‘CAD’ using logistic regression results. Compared against the study, where 28.7% were found to be ‘normal’ (87/303), using a subset of this data set with 228 observations shows a prediction of 36.5% being ‘normal’.</h4>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb523-1" title="1"><span class="kw">library</span>(pscl)</a>
<a class="sourceLine" id="cb523-2" title="2"></a>
<a class="sourceLine" id="cb523-3" title="3"><span class="kw">pR2</span>(LRlogit)</a></code></pre></div>
<pre><code>##          llh      llhNull           G2     McFadden         r2ML 
##  -66.4184680 -137.1829841  141.5290322    0.5158403    0.4624542 
##         r2CU 
##    0.6608226</code></pre>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb525-1" title="1"><span class="kw">plot</span>(<span class="kw">residuals</span>(LRlogit) <span class="op">~</span><span class="st"> </span><span class="kw">fitted</span>(LRlogit))</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-109-1.png" width="672" /></p>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb526-1" title="1"><span class="kw">coef</span>(LRlogit)</a></code></pre></div>
<pre><code>## (Intercept)        TCP1      RWMA.L        NCPY        ACPY        EF.L 
## -0.97738839  3.12150205  1.59908425 -0.39190748  0.07263025 -1.14379641 
##       Age.L        HTN1         DM1 
##  0.89565935  1.33228997  1.65896459</code></pre>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb528-1" title="1">LRPred &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">predict</span>(LRlogit, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>))</a>
<a class="sourceLine" id="cb528-2" title="2"><span class="kw">names</span>(LRPred)[<span class="dv">1</span>]&lt;-<span class="st">&quot;Predict&quot;</span></a>
<a class="sourceLine" id="cb528-3" title="3"></a>
<a class="sourceLine" id="cb528-4" title="4">N &lt;-<span class="st"> </span><span class="kw">sum</span>(LRPred<span class="op">$</span>Predict <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.50</span>)</a>
<a class="sourceLine" id="cb528-5" title="5">C &lt;-<span class="st"> </span><span class="kw">sum</span>(LRPred<span class="op">$</span>Predict <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.50</span>)</a>
<a class="sourceLine" id="cb528-6" title="6">(N<span class="op">/</span>C)<span class="op">*</span><span class="dv">100</span></a></code></pre></div>
<pre><code>## [1] 36.52695</code></pre>
</div>
<div id="explanation-of-the-order-of-factor-variables-for-the-logistic-regression-output-in-r-r-will-use-the-alphabetical-order-of-the-variable-results---and-choose-the-letter-that-is-higher-in-the-alphabet-as-the-reference-variable-which-is-typically-coded-automatically-with-a-1-versus-0---or-a-2-vs-1-on-the-str-output.-as-such-normal-would-be-the-reference-variable-equal-to-2-on-the-str-output..-however-cad-should-be-the-reference-variable-and-so-i-have-re-leveled-that-attribute-so-that-cad-is-used-as-the-reference-and-as-such-is-showing-as-a-2-on-the-str-output." class="section level4">
<h4>Explanation of the order of factor variables for the logistic regression output in R: R will use the alphabetical order of the variable results - and choose the letter that is higher in the alphabet as the reference variable (which is typically coded automatically with a ‘1’, versus ‘0’ - or a ‘2’ vs ‘1’ on the str() output). As such, ‘Normal’ would be the reference variable (equal to ‘2’ on the str() output.). However, ‘CAD’ should be the reference variable and so I have ‘re-leveled’ that attribute so that ‘CAD’ is used as the reference (and as such, is showing as a ‘2’ on the str() output).</h4>
</div>
<div id="other-variables-explained-for-the-glm-output" class="section level4">
<h4>Other variables explained for the glm output:</h4>
</div>
<div id="tcp-yes-or-1-is-base-case-hence-shows-2-on-str-output." class="section level4">
<h4>TCP: ‘Yes’, or ‘1’, is base case (hence shows ‘2’ on str() output.</h4>
</div>
<div id="acp-same-base-case-behaviour-as-tcp.-this-happens-automatically-because-y-comes-after-n-in-the-alphabet.-y-is-showing-with-a-2-on-the-str-output." class="section level4">
<h4>ACP: Same base case behaviour as TCP. This happens automatically because ‘Y’ comes after ‘N’ in the alphabet. ‘Y’ is showing with a ‘2’ on the str() output.</h4>
</div>
<div id="rwma-high-is-the-base-case-and-is-the-2-on-str-output.-this-factor-has-been-ordered-so-that-even-though-the-h-in-high-comes-before-the-m-in-med-high-is-treated-as-the-base-case-and-is-assigned-the-2-on-the-str-output." class="section level4">
<h4>RWMA: ‘High’ is the base case and is the ‘2’ on str() output. This factor has been ‘ordered’ so that even though the ‘H’ in ‘High’ comes before the ‘M’ in ‘Med’, High is treated as the base case (and is assigned the ‘2’ on the str() output.</h4>
</div>
<div id="ef-is-also-an-ordered-factor-and-so-it-has-med-as-the-base-case-and-is-the-2-on-the-str-output." class="section level4">
<h4>EF is also an ‘ordered factor’, and so it has ‘Med’ as the base case (and is the ‘2’ on the str() output).</h4>
</div>
<div id="ncp-is-the-same-as-acp-for-y-and-n-and-y-being-the-base-case" class="section level4">
<h4>NCP: Is the same as ACP (for ‘Y’ and ‘N’, and ‘Y’ being the base case)</h4>
</div>
<div id="age-is-treated-the-same-as-rwma---so-high-is-the-base-case." class="section level4">
<h4>Age: Is treated the same as RWMA - so, ‘High’ is the base case.</h4>
</div>
<div id="htn-is-treated-the-same-as-tcp" class="section level4">
<h4>HTN: Is treated the same as TCP</h4>
</div>
<div id="dm-is-treated-the-same-as-tcp" class="section level4">
<h4>DM: Is treated the same as TCP</h4>
</div>
<div id="cad-releveled-so-that-cad-is-the-reference-base-case-as-such-the-str-output-shows-cad-as-2-even-though-c-comes-before-n-for-normal-in-the-alphabet." class="section level4">
<h4>CAD: Releveled so that CAD is the reference (base case); as such the str() output shows ‘CAD’ as ‘2’, even though ‘C’ comes before ‘N’ (for ‘Normal’) in the alphabet.</h4>
</div>
</div>
<div id="glm-output-interpretation" class="section level3">
<h3>GLM Output interpretation:</h3>
<div id="note-the-acp-result-is-not-connected-to-the-dependent-variable-in-a-statistically-significant-way.-this-needs-more-investigation." class="section level4">
<h4>Note: The ACP result is not connected to the dependent variable in a statistically significant way. (This needs more investigation.)</h4>
</div>
<div id="tcp-for-a-one-unit-increase-in-tcp-the-log-odds-of-being-diagnosed-with-coronary-artery-disease-increases-by-3.4047" class="section level4">
<h4>TCP: For a one unit increase in TCP, the log odds of being diagnosed with Coronary Artery Disease increases by 3.4047</h4>
</div>
<div id="acp-for-a-one-unit-increase-in-acp-the-log-odds-of-being-diagnosed-with-coronary-artery-disease-increases-by-0.312-note-not-statistically-significant-relationship-per-the-p-value-rwma-for-a-one-unit-increase-in-rwma-medium-versus-high-the-log-odds-of-being-diagnosed-with-coronary-artery-disease-decreases-by-2.6388-ef-for-a-one-unit-increase-in-ef-medium-versus-low-the-log-odds-of-being-diagnosed-with-coronary-artery-disease-decreases-by-1.5196-ncp-for-a-one-unit-increase-in-ncp-the-log-odds-of-being-diagnosed-with-coronary-artery-disease-decreases-by-1.4209-note-not-statistically-significant-just-outside-of-significance-range-per-the-p-value" class="section level4">
<h4>ACP: For a one unit increase in ACP, the log odds of being diagnosed with Coronary Artery Disease increases by 0.312 (<em>Note: Not statistically significant relationship, per the p-value) #### RWMA: For a one unit increase in ‘RWMA Medium’ (versus ‘High’) , the log odds of being diagnosed with Coronary Artery Disease decreases by 2.6388 #### EF: For a one unit increase in ‘EF Medium’ (versus ‘Low’), the log odds of being diagnosed with Coronary Artery Disease DECREASES by 1.5196 #### NCP: For a one unit increase in NCP, the log odds of being diagnosed with Coronary Artery Disease DECREASES by 1.4209 (</em>Note: not statistically significant, just outside of significance range per the p-value)</h4>
</div>
<div id="age-for-a-one-unit-increase-in-age-medium-versus-high-the-log-odds-of-being-diagnosed-with-coronary-artery-disease-decreases-by-1.6130" class="section level4">
<h4>Age: For a one unit increase in ‘Age Medium’ (versus ‘High’), the log odds of being diagnosed with Coronary Artery Disease DECREASES by 1.6130</h4>
</div>
<div id="htn-for-a-one-unit-increase-in-htn-the-log-odds-of-being-diagnosed-with-coronary-artery-disease-increases-by-0.8657" class="section level4">
<h4>HTN: For a one unit increase in HTN, the log odds of being diagnosed with Coronary Artery Disease increases by 0.8657</h4>
</div>
<div id="dm-for-a-one-unit-increase-in-dm-the-log-odds-of-being-diagnosed-with-coronary-artery-disease-increases-by-1.8719" class="section level4">
<h4>DM: For a one unit increase in DM, the log odds of being diagnosed with Coronary Artery Disease increases by 1.8719</h4>
</div>
<div id="brier-score-for-logistic-regression-model" class="section level4">
<h4>Brier Score for Logistic Regression model:</h4>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb530-1" title="1"><span class="kw">library</span>(rms)</a>
<a class="sourceLine" id="cb530-2" title="2"><span class="kw">library</span>(Hmisc)</a>
<a class="sourceLine" id="cb530-3" title="3"></a>
<a class="sourceLine" id="cb530-4" title="4"><span class="kw">options</span>(<span class="st">&#39;contrasts&#39;</span>)</a>
<a class="sourceLine" id="cb530-5" title="5"><span class="kw">options</span>(<span class="dt">contrasts=</span><span class="kw">c</span>(<span class="st">&#39;contr.treatment&#39;</span>,<span class="st">&#39;contr.treatment&#39;</span>))</a>
<a class="sourceLine" id="cb530-6" title="6"></a>
<a class="sourceLine" id="cb530-7" title="7"></a>
<a class="sourceLine" id="cb530-8" title="8">logiTrain2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(AllvFtrain[,<span class="kw">c</span>(<span class="dv">23</span>,<span class="dv">51</span>,<span class="dv">27</span>,<span class="dv">26</span>,<span class="dv">50</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">53</span>)])</a>
<a class="sourceLine" id="cb530-9" title="9"></a>
<a class="sourceLine" id="cb530-10" title="10">logiTrain2<span class="op">$</span>CAD &lt;-<span class="st"> </span><span class="kw">relevel</span>(logiTrain2<span class="op">$</span>CAD, <span class="dt">ref =</span> <span class="st">&quot;Normal&quot;</span>)</a>
<a class="sourceLine" id="cb530-11" title="11"><span class="co">#str(logiTrain2)</span></a>
<a class="sourceLine" id="cb530-12" title="12"></a>
<a class="sourceLine" id="cb530-13" title="13">LRlrm &lt;-<span class="st"> </span><span class="kw">lrm</span>(<span class="dt">formula =</span> CAD<span class="op">~</span>.,logiTrain2)</a>
<a class="sourceLine" id="cb530-14" title="14">LRlrm</a></code></pre></div>
</div>
<div id="documenting-and-plotting-the-accuracykappasensitivityspecificity-stability-of-the-algorithms-using-different-numbers-of-folds-during-cross-validation---starting-with-the-random-forest-algorithm" class="section level4">
<h4>Documenting and plotting the Accuracy/Kappa/Sensitivity/Specificity stability of the algorithms using different numbers of ‘folds’ during cross validation - starting with the Random Forest algorithm:</h4>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb531-1" title="1">RFstability &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Accuracy=</span><span class="kw">c</span>(<span class="fl">0.8933333</span>, <span class="fl">0.8933333</span>,  <span class="fl">0.9066667</span>,  <span class="fl">0.9066667</span>,  <span class="fl">0.9066667</span>,  <span class="fl">0.9066667</span>,  <span class="fl">0.9066667</span>),<span class="dt">Kappa=</span><span class="kw">c</span>(<span class="fl">0.7566910</span>,   <span class="fl">0.7429306</span>,  <span class="fl">0.7782003</span>,  <span class="fl">0.7782003</span>,  <span class="fl">0.7782003</span>,  <span class="fl">0.7782003</span>,  <span class="fl">0.7718383</span>), <span class="dt">Sensitivity=</span><span class="kw">c</span>(<span class="fl">0.8703704</span>,    <span class="fl">0.9074074</span>,  <span class="fl">0.9074074</span>,  <span class="fl">0.9074074</span>,  <span class="fl">0.9074074</span>,  <span class="fl">0.9074074</span>,  <span class="fl">0.9259259</span>), <span class="dt">Specificity=</span><span class="kw">c</span>(<span class="fl">0.9523810</span>,    <span class="fl">0.8571429</span>,  <span class="fl">0.9047619</span>,  <span class="fl">0.9047619</span>,  <span class="fl">0.9047619</span>,  <span class="fl">0.9047619</span>,  <span class="fl">0.8571429</span>))</a>
<a class="sourceLine" id="cb531-2" title="2"></a>
<a class="sourceLine" id="cb531-3" title="3"><span class="kw">rownames</span>(RFstability) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>,<span class="dv">25</span>,<span class="dv">30</span>,<span class="dv">35</span>)</a>
<a class="sourceLine" id="cb531-4" title="4">RFstability</a></code></pre></div>
<pre><code>##     Accuracy     Kappa Sensitivity Specificity
## 5  0.8933333 0.7566910   0.8703704   0.9523810
## 10 0.8933333 0.7429306   0.9074074   0.8571429
## 15 0.9066667 0.7782003   0.9074074   0.9047619
## 20 0.9066667 0.7782003   0.9074074   0.9047619
## 25 0.9066667 0.7782003   0.9074074   0.9047619
## 30 0.9066667 0.7782003   0.9074074   0.9047619
## 35 0.9066667 0.7718383   0.9259259   0.8571429</code></pre>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb533-1" title="1">cols &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;darkseagreen&quot;</span>, <span class="st">&quot;darkorange1&quot;</span>,<span class="st">&quot;cornflowerblue&quot;</span>,<span class="st">&quot;gray48&quot;</span>)</a>
<a class="sourceLine" id="cb533-2" title="2">pch &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">15</span>, <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb533-3" title="3">xmax &lt;-<span class="st"> </span><span class="kw">nrow</span>(RFstability) <span class="op">+</span><span class="st"> </span><span class="fl">2.5</span></a>
<a class="sourceLine" id="cb533-4" title="4"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb533-5" title="5"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(RFstability), <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(RFstability), <span class="dt">pch=</span><span class="st">&quot;&quot;</span>, </a>
<a class="sourceLine" id="cb533-6" title="6">        <span class="dt">xlab=</span><span class="st">&quot;nFolds&quot;</span>, <span class="dt">ylab=</span><span class="ot">NA</span>, <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, </a>
<a class="sourceLine" id="cb533-7" title="7">        <span class="dt">ylim=</span><span class="kw">c</span>(.<span class="dv">725</span>,.<span class="dv">975</span>), <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">1</span>,xmax), <span class="dt">main=</span><span class="st">&quot;Random Forest Stability Results; Part 1&quot;</span>)</a>
<a class="sourceLine" id="cb533-8" title="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq</span>(.<span class="dv">725</span>,.<span class="dv">975</span>,<span class="dt">by=</span>.<span class="dv">025</span>)) {</a>
<a class="sourceLine" id="cb533-9" title="9">    <span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(RFstability), <span class="kw">rep</span>(i,<span class="kw">nrow</span>(RFstability)), <span class="dt">col=</span><span class="st">&quot;gray69&quot;</span>)</a>
<a class="sourceLine" id="cb533-10" title="10">}</a>
<a class="sourceLine" id="cb533-11" title="11"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(RFstability)) {</a>
<a class="sourceLine" id="cb533-12" title="12"></a>
<a class="sourceLine" id="cb533-13" title="13">    <span class="kw">points</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(RFstability), RFstability[,i], <span class="dt">pch=</span>pch[i], </a>
<a class="sourceLine" id="cb533-14" title="14">        <span class="dt">col=</span>cols[i], <span class="dt">cex=</span><span class="fl">1.2</span>)</a>
<a class="sourceLine" id="cb533-15" title="15"></a>
<a class="sourceLine" id="cb533-16" title="16">    <span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(RFstability), RFstability[,i], <span class="dt">col=</span>cols[i], </a>
<a class="sourceLine" id="cb533-17" title="17">        <span class="dt">lwd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb533-18" title="18">}</a>
<a class="sourceLine" id="cb533-19" title="19"><span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>, <span class="dt">at=</span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(RFstability), <span class="dt">tick=</span><span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb533-20" title="20">        <span class="dt">labels=</span><span class="kw">rownames</span>(RFstability))</a>
<a class="sourceLine" id="cb533-21" title="21"></a>
<a class="sourceLine" id="cb533-22" title="22"><span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">8.5</span>,<span class="dt">by=</span><span class="dv">1</span>), </a>
<a class="sourceLine" id="cb533-23" title="23">        <span class="dt">tick=</span><span class="ot">FALSE</span>, <span class="dt">labels=</span><span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb533-24" title="24"></a>
<a class="sourceLine" id="cb533-25" title="25"><span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">2</span>, <span class="dt">at=</span><span class="kw">seq</span>(.<span class="dv">725</span>,.<span class="dv">975</span>,<span class="dt">by=</span>.<span class="dv">025</span>), <span class="dt">tick=</span><span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb533-26" title="26">        <span class="dt">las=</span><span class="ot">TRUE</span>, <span class="dt">labels=</span><span class="kw">paste</span>(<span class="kw">seq</span>(.<span class="dv">725</span>,.<span class="dv">975</span>,<span class="dt">by=</span>.<span class="dv">025</span>)))</a>
<a class="sourceLine" id="cb533-27" title="27"></a>
<a class="sourceLine" id="cb533-28" title="28"><span class="kw">legend</span>(<span class="st">&#39;bottomright&#39;</span>,<span class="dt">legend=</span><span class="kw">colnames</span>(RFstability), <span class="dt">pch=</span>pch, </a>
<a class="sourceLine" id="cb533-29" title="29">        <span class="dt">col=</span>cols, <span class="dt">cex=</span><span class="fl">1.0</span>, <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>,  <span class="dt">lwd=</span><span class="dv">3</span>, <span class="dt">lty=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-111-1.png" width="672" /> #### Plotting the Precision/Recall/F1 stability of the Random Forest algorithm:</p>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb534-1" title="1">RFstability2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Precision=</span><span class="kw">c</span>(<span class="fl">0.9791667</span>,   <span class="fl">0.9423077</span>,  <span class="fl">0.9607843</span>,  <span class="fl">0.9607843</span>,  <span class="fl">0.9607843</span>,  <span class="fl">0.9607843</span>,  <span class="fl">0.9433962</span>), <span class="dt">Recall=</span><span class="kw">c</span>(<span class="fl">0.8703704</span>, <span class="fl">0.9074074</span>,  <span class="fl">0.9074074</span>,  <span class="fl">0.9074074</span>,  <span class="fl">0.9074074</span>,  <span class="fl">0.9074074</span>,  <span class="fl">0.9259259</span>), <span class="dt">F1=</span><span class="kw">c</span>(<span class="fl">0.9215686</span>, <span class="fl">0.9245283</span>,  <span class="fl">0.9333333</span>,  <span class="fl">0.9333333</span>,  <span class="fl">0.9333333</span>,  <span class="fl">0.9333333</span>,  <span class="fl">0.9345794</span>))</a>
<a class="sourceLine" id="cb534-2" title="2"></a>
<a class="sourceLine" id="cb534-3" title="3"><span class="kw">rownames</span>(RFstability2) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>,<span class="dv">25</span>,<span class="dv">30</span>,<span class="dv">35</span>)</a>
<a class="sourceLine" id="cb534-4" title="4">RFstability2</a></code></pre></div>
<pre><code>##    Precision    Recall        F1
## 5  0.9791667 0.8703704 0.9215686
## 10 0.9423077 0.9074074 0.9245283
## 15 0.9607843 0.9074074 0.9333333
## 20 0.9607843 0.9074074 0.9333333
## 25 0.9607843 0.9074074 0.9333333
## 30 0.9607843 0.9074074 0.9333333
## 35 0.9433962 0.9259259 0.9345794</code></pre>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb536-1" title="1">cols &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;darkturquoise&quot;</span>, <span class="st">&quot;darkorchid1&quot;</span>,<span class="st">&quot;gray0&quot;</span>)</a>
<a class="sourceLine" id="cb536-2" title="2">pch &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">15</span>)</a>
<a class="sourceLine" id="cb536-3" title="3">xmax &lt;-<span class="st"> </span><span class="kw">nrow</span>(RFstability2) <span class="op">+</span><span class="st"> </span><span class="fl">2.5</span></a>
<a class="sourceLine" id="cb536-4" title="4"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb536-5" title="5"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(RFstability2), <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(RFstability2), <span class="dt">pch=</span><span class="st">&quot;&quot;</span>, </a>
<a class="sourceLine" id="cb536-6" title="6">        <span class="dt">xlab=</span><span class="st">&quot;nFolds&quot;</span>, <span class="dt">ylab=</span><span class="ot">NA</span>, <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, </a>
<a class="sourceLine" id="cb536-7" title="7">        <span class="dt">ylim=</span><span class="kw">c</span>(.<span class="dv">85</span>,<span class="fl">1.0</span>), <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">1</span>,xmax), <span class="dt">main=</span><span class="st">&quot;Random Forest Stability Results; Part 2&quot;</span>)</a>
<a class="sourceLine" id="cb536-8" title="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq</span>(.<span class="dv">85</span>,<span class="fl">1.0</span>,<span class="dt">by=</span>.<span class="dv">025</span>)) {</a>
<a class="sourceLine" id="cb536-9" title="9">    <span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(RFstability2), <span class="kw">rep</span>(i,<span class="kw">nrow</span>(RFstability2)), <span class="dt">col=</span><span class="st">&quot;gray69&quot;</span>)</a>
<a class="sourceLine" id="cb536-10" title="10">}</a>
<a class="sourceLine" id="cb536-11" title="11"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(RFstability2)) {</a>
<a class="sourceLine" id="cb536-12" title="12"></a>
<a class="sourceLine" id="cb536-13" title="13">    <span class="kw">points</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(RFstability2), RFstability2[,i], <span class="dt">pch=</span>pch[i], </a>
<a class="sourceLine" id="cb536-14" title="14">        <span class="dt">col=</span>cols[i], <span class="dt">cex=</span><span class="fl">1.2</span>)</a>
<a class="sourceLine" id="cb536-15" title="15"></a>
<a class="sourceLine" id="cb536-16" title="16">    <span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(RFstability2), RFstability2[,i], <span class="dt">col=</span>cols[i], </a>
<a class="sourceLine" id="cb536-17" title="17">        <span class="dt">lwd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb536-18" title="18">}</a>
<a class="sourceLine" id="cb536-19" title="19"><span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>, <span class="dt">at=</span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(RFstability2), <span class="dt">tick=</span><span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb536-20" title="20">        <span class="dt">labels=</span><span class="kw">rownames</span>(RFstability2))</a>
<a class="sourceLine" id="cb536-21" title="21"></a>
<a class="sourceLine" id="cb536-22" title="22"><span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">8.5</span>,<span class="dt">by=</span><span class="dv">1</span>), </a>
<a class="sourceLine" id="cb536-23" title="23">        <span class="dt">tick=</span><span class="ot">FALSE</span>, <span class="dt">labels=</span><span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb536-24" title="24"></a>
<a class="sourceLine" id="cb536-25" title="25"><span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">2</span>, <span class="dt">at=</span><span class="kw">seq</span>(.<span class="dv">85</span>,<span class="fl">1.0</span>,<span class="dt">by=</span>.<span class="dv">025</span>), <span class="dt">tick=</span><span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb536-26" title="26">        <span class="dt">las=</span><span class="ot">TRUE</span>, <span class="dt">labels=</span><span class="kw">paste</span>(<span class="kw">seq</span>(.<span class="dv">85</span>,<span class="fl">1.0</span>,<span class="dt">by=</span>.<span class="dv">025</span>)))</a>
<a class="sourceLine" id="cb536-27" title="27"></a>
<a class="sourceLine" id="cb536-28" title="28"><span class="kw">legend</span>(<span class="st">&#39;bottomright&#39;</span>,<span class="dt">legend=</span><span class="kw">colnames</span>(RFstability2), <span class="dt">pch=</span>pch, </a>
<a class="sourceLine" id="cb536-29" title="29">        <span class="dt">col=</span>cols, <span class="dt">cex=</span><span class="fl">1.0</span>, <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>,  <span class="dt">lwd=</span><span class="dv">3</span>, <span class="dt">lty=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-112-1.png" width="672" /></p>
</div>
<div id="plotting-the-accuracykappasensitivityspecificity-stability-of-the-naive-bayes-algorithm" class="section level4">
<h4>Plotting the Accuracy/Kappa/Sensitivity/Specificity stability of the Naive Bayes algorithm:</h4>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb537-1" title="1">NBstability &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Accuracy=</span><span class="kw">c</span>(<span class="fl">0.9200000</span>, <span class="fl">0.9200000</span>,  <span class="fl">0.9200000</span>,  <span class="fl">0.9200000</span>,  <span class="fl">0.9066667</span>,  <span class="fl">0.9200000</span>,  <span class="fl">0.9200000</span>), <span class="dt">Kappa=</span><span class="kw">c</span>(<span class="fl">0.8071979</span>,  <span class="fl">0.8071979</span>,  <span class="fl">0.8071979</span>,  <span class="fl">0.8071979</span>,  <span class="fl">0.7782003</span>,  <span class="fl">0.8071979</span>,  <span class="fl">0.8071979</span>), <span class="dt">Sensitivity=</span><span class="kw">c</span>(<span class="fl">0.9259259</span>,    <span class="fl">0.9259259</span>,  <span class="fl">0.9259259</span>,  <span class="fl">0.9259259</span>,  <span class="fl">0.9074074</span>,  <span class="fl">0.9259259</span>,  <span class="fl">0.9259259</span>), <span class="dt">Specificity=</span><span class="kw">rep</span>(<span class="fl">0.9047619</span>, <span class="dv">7</span>))</a>
<a class="sourceLine" id="cb537-2" title="2"><span class="kw">rownames</span>(NBstability) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>,<span class="dv">25</span>,<span class="dv">30</span>,<span class="dv">35</span>)</a>
<a class="sourceLine" id="cb537-3" title="3">NBstability</a></code></pre></div>
<pre><code>##     Accuracy     Kappa Sensitivity Specificity
## 5  0.9200000 0.8071979   0.9259259   0.9047619
## 10 0.9200000 0.8071979   0.9259259   0.9047619
## 15 0.9200000 0.8071979   0.9259259   0.9047619
## 20 0.9200000 0.8071979   0.9259259   0.9047619
## 25 0.9066667 0.7782003   0.9074074   0.9047619
## 30 0.9200000 0.8071979   0.9259259   0.9047619
## 35 0.9200000 0.8071979   0.9259259   0.9047619</code></pre>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb539-1" title="1">cols &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;darkseagreen&quot;</span>, <span class="st">&quot;darkorange1&quot;</span>,<span class="st">&quot;cornflowerblue&quot;</span>,<span class="st">&quot;gray48&quot;</span>)</a>
<a class="sourceLine" id="cb539-2" title="2">pch &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">15</span>, <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb539-3" title="3">xmax &lt;-<span class="st"> </span><span class="kw">nrow</span>(NBstability) <span class="op">+</span><span class="st"> </span><span class="fl">2.5</span></a>
<a class="sourceLine" id="cb539-4" title="4"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb539-5" title="5"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(NBstability), <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(NBstability), <span class="dt">pch=</span><span class="st">&quot;&quot;</span>, </a>
<a class="sourceLine" id="cb539-6" title="6">        <span class="dt">xlab=</span><span class="st">&quot;nFolds&quot;</span>, <span class="dt">ylab=</span><span class="ot">NA</span>, <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, </a>
<a class="sourceLine" id="cb539-7" title="7">        <span class="dt">ylim=</span><span class="kw">c</span>(.<span class="dv">775</span>,.<span class="dv">95</span>), <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">1</span>,xmax), <span class="dt">main=</span><span class="st">&quot;Naive Bayes Stability Results; Part 1&quot;</span>)</a>
<a class="sourceLine" id="cb539-8" title="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq</span>(.<span class="dv">775</span>,.<span class="dv">95</span>,<span class="dt">by=</span>.<span class="dv">025</span>)) {</a>
<a class="sourceLine" id="cb539-9" title="9">    <span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(NBstability), <span class="kw">rep</span>(i,<span class="kw">nrow</span>(NBstability)), <span class="dt">col=</span><span class="st">&quot;gray69&quot;</span>)</a>
<a class="sourceLine" id="cb539-10" title="10">}</a>
<a class="sourceLine" id="cb539-11" title="11"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(NBstability)) {</a>
<a class="sourceLine" id="cb539-12" title="12"></a>
<a class="sourceLine" id="cb539-13" title="13">    <span class="kw">points</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(NBstability), NBstability[,i], <span class="dt">pch=</span>pch[i], </a>
<a class="sourceLine" id="cb539-14" title="14">        <span class="dt">col=</span>cols[i], <span class="dt">cex=</span><span class="fl">1.2</span>)</a>
<a class="sourceLine" id="cb539-15" title="15"></a>
<a class="sourceLine" id="cb539-16" title="16">    <span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(NBstability), NBstability[,i], <span class="dt">col=</span>cols[i], </a>
<a class="sourceLine" id="cb539-17" title="17">        <span class="dt">lwd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb539-18" title="18">}</a>
<a class="sourceLine" id="cb539-19" title="19"><span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>, <span class="dt">at=</span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(NBstability), <span class="dt">tick=</span><span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb539-20" title="20">        <span class="dt">labels=</span><span class="kw">rownames</span>(NBstability))</a>
<a class="sourceLine" id="cb539-21" title="21"></a>
<a class="sourceLine" id="cb539-22" title="22"><span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">8.5</span>,<span class="dt">by=</span><span class="dv">1</span>), </a>
<a class="sourceLine" id="cb539-23" title="23">        <span class="dt">tick=</span><span class="ot">FALSE</span>, <span class="dt">labels=</span><span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb539-24" title="24"></a>
<a class="sourceLine" id="cb539-25" title="25"><span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">2</span>, <span class="dt">at=</span><span class="kw">seq</span>(.<span class="dv">775</span>,.<span class="dv">95</span>,<span class="dt">by=</span>.<span class="dv">025</span>), <span class="dt">tick=</span><span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb539-26" title="26">        <span class="dt">las=</span><span class="ot">TRUE</span>, <span class="dt">labels=</span><span class="kw">paste</span>(<span class="kw">seq</span>(.<span class="dv">775</span>,.<span class="dv">95</span>,<span class="dt">by=</span>.<span class="dv">025</span>)))</a>
<a class="sourceLine" id="cb539-27" title="27"></a>
<a class="sourceLine" id="cb539-28" title="28"><span class="kw">legend</span>(<span class="st">&#39;bottomright&#39;</span>,<span class="dt">legend=</span><span class="kw">colnames</span>(NBstability), <span class="dt">pch=</span>pch, </a>
<a class="sourceLine" id="cb539-29" title="29">        <span class="dt">col=</span>cols, <span class="dt">cex=</span><span class="fl">1.0</span>, <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>,  <span class="dt">lwd=</span><span class="dv">3</span>, <span class="dt">lty=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-113-1.png" width="672" /></p>
</div>
<div id="plotting-the-precisionrecallf1-stability-of-the-naive-bayes-algorithm" class="section level4">
<h4>Plotting the Precision/Recall/F1 stability of the Naive Bayes algorithm:</h4>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb540-1" title="1">NBstability2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Precision=</span><span class="kw">c</span>(<span class="fl">0.9615385</span>,   <span class="fl">0.9615385</span>,  <span class="fl">0.9615385</span>,  <span class="fl">0.9615385</span>,  <span class="fl">0.9607843</span>,  <span class="fl">0.9615385</span>,  <span class="fl">0.9615385</span>), <span class="dt">Recall=</span><span class="kw">c</span>(<span class="fl">0.9259259</span>, <span class="fl">0.9259259</span>,  <span class="fl">0.9259259</span>,  <span class="fl">0.9259259</span>,  <span class="fl">0.9074074</span>,  <span class="fl">0.9259259</span>,  <span class="fl">0.9259259</span>), <span class="dt">F1=</span><span class="kw">c</span>(<span class="fl">0.9433962</span>, <span class="fl">0.9433962</span>,  <span class="fl">0.9433962</span>,  <span class="fl">0.9433962</span>,  <span class="fl">0.9333333</span>,  <span class="fl">0.9433962</span>,  <span class="fl">0.9433962</span>))</a>
<a class="sourceLine" id="cb540-2" title="2"></a>
<a class="sourceLine" id="cb540-3" title="3"><span class="kw">rownames</span>(NBstability2) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>,<span class="dv">25</span>,<span class="dv">30</span>,<span class="dv">35</span>)</a>
<a class="sourceLine" id="cb540-4" title="4">NBstability2</a></code></pre></div>
<pre><code>##    Precision    Recall        F1
## 5  0.9615385 0.9259259 0.9433962
## 10 0.9615385 0.9259259 0.9433962
## 15 0.9615385 0.9259259 0.9433962
## 20 0.9615385 0.9259259 0.9433962
## 25 0.9607843 0.9074074 0.9333333
## 30 0.9615385 0.9259259 0.9433962
## 35 0.9615385 0.9259259 0.9433962</code></pre>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb542-1" title="1">cols &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;darkturquoise&quot;</span>, <span class="st">&quot;darkorchid1&quot;</span>,<span class="st">&quot;gray0&quot;</span>)</a>
<a class="sourceLine" id="cb542-2" title="2">pch &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">15</span>)</a>
<a class="sourceLine" id="cb542-3" title="3">xmax &lt;-<span class="st"> </span><span class="kw">nrow</span>(NBstability2) <span class="op">+</span><span class="st"> </span><span class="fl">2.5</span></a>
<a class="sourceLine" id="cb542-4" title="4"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb542-5" title="5"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(NBstability2), <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(NBstability2), <span class="dt">pch=</span><span class="st">&quot;&quot;</span>, </a>
<a class="sourceLine" id="cb542-6" title="6">        <span class="dt">xlab=</span><span class="st">&quot;nFolds&quot;</span>, <span class="dt">ylab=</span><span class="ot">NA</span>, <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, </a>
<a class="sourceLine" id="cb542-7" title="7">        <span class="dt">ylim=</span><span class="kw">c</span>(.<span class="dv">9</span>,<span class="fl">1.0</span>), <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">1</span>,xmax), <span class="dt">main=</span><span class="st">&quot;Naive Bayes Stability Results; Part 2&quot;</span>)</a>
<a class="sourceLine" id="cb542-8" title="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq</span>(.<span class="dv">9</span>,<span class="fl">1.0</span>,<span class="dt">by=</span>.<span class="dv">025</span>)) {</a>
<a class="sourceLine" id="cb542-9" title="9">    <span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(NBstability2), <span class="kw">rep</span>(i,<span class="kw">nrow</span>(NBstability2)), <span class="dt">col=</span><span class="st">&quot;gray69&quot;</span>)</a>
<a class="sourceLine" id="cb542-10" title="10">}</a>
<a class="sourceLine" id="cb542-11" title="11"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(NBstability2)) {</a>
<a class="sourceLine" id="cb542-12" title="12"></a>
<a class="sourceLine" id="cb542-13" title="13">    <span class="kw">points</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(NBstability2), NBstability2[,i], <span class="dt">pch=</span>pch[i], </a>
<a class="sourceLine" id="cb542-14" title="14">        <span class="dt">col=</span>cols[i], <span class="dt">cex=</span><span class="fl">1.2</span>)</a>
<a class="sourceLine" id="cb542-15" title="15"></a>
<a class="sourceLine" id="cb542-16" title="16">    <span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(NBstability2), NBstability2[,i], <span class="dt">col=</span>cols[i], </a>
<a class="sourceLine" id="cb542-17" title="17">        <span class="dt">lwd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb542-18" title="18">}</a>
<a class="sourceLine" id="cb542-19" title="19"><span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>, <span class="dt">at=</span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(NBstability2), <span class="dt">tick=</span><span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb542-20" title="20">        <span class="dt">labels=</span><span class="kw">rownames</span>(NBstability2))</a>
<a class="sourceLine" id="cb542-21" title="21"></a>
<a class="sourceLine" id="cb542-22" title="22"><span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">8.5</span>,<span class="dt">by=</span><span class="dv">1</span>), </a>
<a class="sourceLine" id="cb542-23" title="23">        <span class="dt">tick=</span><span class="ot">FALSE</span>, <span class="dt">labels=</span><span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb542-24" title="24"></a>
<a class="sourceLine" id="cb542-25" title="25"><span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">2</span>, <span class="dt">at=</span><span class="kw">seq</span>(.<span class="dv">9</span>,<span class="fl">1.0</span>,<span class="dt">by=</span>.<span class="dv">025</span>), <span class="dt">tick=</span><span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb542-26" title="26">        <span class="dt">las=</span><span class="ot">TRUE</span>, <span class="dt">labels=</span><span class="kw">paste</span>(<span class="kw">seq</span>(.<span class="dv">9</span>,<span class="fl">1.0</span>,<span class="dt">by=</span>.<span class="dv">025</span>)))</a>
<a class="sourceLine" id="cb542-27" title="27"></a>
<a class="sourceLine" id="cb542-28" title="28"><span class="kw">legend</span>(<span class="st">&#39;bottomright&#39;</span>,<span class="dt">legend=</span><span class="kw">colnames</span>(NBstability2), <span class="dt">pch=</span>pch, </a>
<a class="sourceLine" id="cb542-29" title="29">        <span class="dt">col=</span>cols, <span class="dt">cex=</span><span class="fl">1.0</span>, <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>,  <span class="dt">lwd=</span><span class="dv">3</span>, <span class="dt">lty=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-114-1.png" width="672" /></p>
</div>
<div id="plotting-the-accuracykappasensitivityspecificity-stability-of-the-logistic-regression-algorithm" class="section level4">
<h4>Plotting the Accuracy/Kappa/Sensitivity/Specificity stability of the Logistic Regression algorithm:</h4>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb543-1" title="1">LRstability &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Accuracy=</span><span class="kw">c</span>(<span class="fl">0.8800000</span>, <span class="fl">0.9066667</span>,  <span class="fl">0.9066667</span>,  <span class="fl">0.9066667</span>,  <span class="fl">0.9066667</span>,  <span class="fl">0.9066667</span>,  <span class="fl">0.8933333</span>), <span class="dt">Kappa=</span><span class="kw">c</span>(<span class="fl">0.6686303</span>,  <span class="fl">0.7503566</span>,  <span class="fl">0.7503566</span>,  <span class="fl">0.7503566</span>,  <span class="fl">0.7503566</span>,  <span class="fl">0.7503566</span>,  <span class="fl">0.7101449</span>), <span class="dt">Sensitivity=</span><span class="kw">rep</span>(<span class="fl">0.9814815</span>, <span class="dv">7</span>), <span class="dt">Specificity=</span><span class="kw">c</span>(<span class="fl">0.6190476</span>, <span class="fl">0.7142857</span>,  <span class="fl">0.7142857</span>,  <span class="fl">0.7142857</span>,  <span class="fl">0.7142857</span>,  <span class="fl">0.7142857</span>,  <span class="fl">0.6666667</span>))</a>
<a class="sourceLine" id="cb543-2" title="2"><span class="kw">rownames</span>(LRstability) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>,<span class="dv">25</span>,<span class="dv">30</span>,<span class="dv">35</span>)</a>
<a class="sourceLine" id="cb543-3" title="3">LRstability</a></code></pre></div>
<pre><code>##     Accuracy     Kappa Sensitivity Specificity
## 5  0.8800000 0.6686303   0.9814815   0.6190476
## 10 0.9066667 0.7503566   0.9814815   0.7142857
## 15 0.9066667 0.7503566   0.9814815   0.7142857
## 20 0.9066667 0.7503566   0.9814815   0.7142857
## 25 0.9066667 0.7503566   0.9814815   0.7142857
## 30 0.9066667 0.7503566   0.9814815   0.7142857
## 35 0.8933333 0.7101449   0.9814815   0.6666667</code></pre>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb545-1" title="1">cols &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;darkseagreen&quot;</span>, <span class="st">&quot;darkorange1&quot;</span>,<span class="st">&quot;cornflowerblue&quot;</span>,<span class="st">&quot;gray48&quot;</span>)</a>
<a class="sourceLine" id="cb545-2" title="2">pch &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">15</span>, <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb545-3" title="3">xmax &lt;-<span class="st"> </span><span class="kw">nrow</span>(LRstability) <span class="op">+</span><span class="st"> </span><span class="fl">2.5</span></a>
<a class="sourceLine" id="cb545-4" title="4"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb545-5" title="5"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(LRstability), <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(LRstability), <span class="dt">pch=</span><span class="st">&quot;&quot;</span>, </a>
<a class="sourceLine" id="cb545-6" title="6">        <span class="dt">xlab=</span><span class="st">&quot;nFolds&quot;</span>, <span class="dt">ylab=</span><span class="ot">NA</span>, <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, </a>
<a class="sourceLine" id="cb545-7" title="7">        <span class="dt">ylim=</span><span class="kw">c</span>(.<span class="dv">6</span>,<span class="fl">1.0</span>), <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">1</span>,xmax), <span class="dt">main=</span><span class="st">&quot;Logistic Regression Stability Results; Part 1&quot;</span>)</a>
<a class="sourceLine" id="cb545-8" title="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq</span>(.<span class="dv">6</span>,<span class="fl">1.0</span>,<span class="dt">by=</span>.<span class="dv">025</span>)) {</a>
<a class="sourceLine" id="cb545-9" title="9">    <span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(LRstability), <span class="kw">rep</span>(i,<span class="kw">nrow</span>(LRstability)), <span class="dt">col=</span><span class="st">&quot;gray69&quot;</span>)</a>
<a class="sourceLine" id="cb545-10" title="10">}</a>
<a class="sourceLine" id="cb545-11" title="11"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(LRstability)) {</a>
<a class="sourceLine" id="cb545-12" title="12"></a>
<a class="sourceLine" id="cb545-13" title="13">    <span class="kw">points</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(LRstability), LRstability[,i], <span class="dt">pch=</span>pch[i], </a>
<a class="sourceLine" id="cb545-14" title="14">        <span class="dt">col=</span>cols[i], <span class="dt">cex=</span><span class="fl">1.2</span>)</a>
<a class="sourceLine" id="cb545-15" title="15"></a>
<a class="sourceLine" id="cb545-16" title="16">    <span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(LRstability), LRstability[,i], <span class="dt">col=</span>cols[i], </a>
<a class="sourceLine" id="cb545-17" title="17">        <span class="dt">lwd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb545-18" title="18">}</a>
<a class="sourceLine" id="cb545-19" title="19"><span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>, <span class="dt">at=</span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(LRstability), <span class="dt">tick=</span><span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb545-20" title="20">        <span class="dt">labels=</span><span class="kw">rownames</span>(LRstability))</a>
<a class="sourceLine" id="cb545-21" title="21"></a>
<a class="sourceLine" id="cb545-22" title="22"><span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">8.5</span>,<span class="dt">by=</span><span class="dv">1</span>), </a>
<a class="sourceLine" id="cb545-23" title="23">        <span class="dt">tick=</span><span class="ot">FALSE</span>, <span class="dt">labels=</span><span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb545-24" title="24"></a>
<a class="sourceLine" id="cb545-25" title="25"><span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">2</span>, <span class="dt">at=</span><span class="kw">seq</span>(.<span class="dv">6</span>,<span class="fl">1.0</span>,<span class="dt">by=</span>.<span class="dv">025</span>), <span class="dt">tick=</span><span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb545-26" title="26">        <span class="dt">las=</span><span class="ot">TRUE</span>, <span class="dt">labels=</span><span class="kw">paste</span>(<span class="kw">seq</span>(.<span class="dv">6</span>,<span class="fl">1.0</span>,<span class="dt">by=</span>.<span class="dv">025</span>)))</a>
<a class="sourceLine" id="cb545-27" title="27"></a>
<a class="sourceLine" id="cb545-28" title="28"><span class="kw">legend</span>(<span class="st">&#39;bottomright&#39;</span>,<span class="dt">legend=</span><span class="kw">colnames</span>(LRstability), <span class="dt">pch=</span>pch, </a>
<a class="sourceLine" id="cb545-29" title="29">        <span class="dt">col=</span>cols, <span class="dt">cex=</span><span class="fl">1.0</span>, <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>,  <span class="dt">lwd=</span><span class="dv">3</span>, <span class="dt">lty=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-115-1.png" width="672" /> #### Plotting the Precision/Recall/F1 stability of the Logistic Regression algorithm:</p>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb546-1" title="1">LRstability2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Precision=</span><span class="kw">c</span>(<span class="fl">0.8688525</span>,   <span class="fl">0.8983051</span>,  <span class="fl">0.8983051</span>,  <span class="fl">0.8983051</span>,  <span class="fl">0.8983051</span>,  <span class="fl">0.8983051</span>,  <span class="fl">0.8833333</span>), <span class="dt">Recall=</span><span class="kw">rep</span>(<span class="fl">0.9814815</span>, <span class="dv">7</span>), <span class="dt">F1=</span><span class="kw">c</span>(<span class="fl">0.9217391</span>,   <span class="fl">0.9380531</span>,  <span class="fl">0.9380531</span>,  <span class="fl">0.9380531</span>,  <span class="fl">0.9380531</span>,  <span class="fl">0.9380531</span>,  <span class="fl">0.9298246</span>))</a>
<a class="sourceLine" id="cb546-2" title="2"></a>
<a class="sourceLine" id="cb546-3" title="3"><span class="kw">rownames</span>(LRstability2) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>,<span class="dv">25</span>,<span class="dv">30</span>,<span class="dv">35</span>)</a>
<a class="sourceLine" id="cb546-4" title="4">LRstability2</a></code></pre></div>
<pre><code>##    Precision    Recall        F1
## 5  0.8688525 0.9814815 0.9217391
## 10 0.8983051 0.9814815 0.9380531
## 15 0.8983051 0.9814815 0.9380531
## 20 0.8983051 0.9814815 0.9380531
## 25 0.8983051 0.9814815 0.9380531
## 30 0.8983051 0.9814815 0.9380531
## 35 0.8833333 0.9814815 0.9298246</code></pre>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb548-1" title="1">cols &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;darkturquoise&quot;</span>, <span class="st">&quot;darkorchid1&quot;</span>,<span class="st">&quot;gray0&quot;</span>)</a>
<a class="sourceLine" id="cb548-2" title="2">pch &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">17</span>,<span class="dv">18</span>,<span class="dv">15</span>)</a>
<a class="sourceLine" id="cb548-3" title="3">xmax &lt;-<span class="st"> </span><span class="kw">nrow</span>(LRstability2) <span class="op">+</span><span class="st"> </span><span class="fl">2.5</span></a>
<a class="sourceLine" id="cb548-4" title="4"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb548-5" title="5"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(LRstability2), <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(LRstability2), <span class="dt">pch=</span><span class="st">&quot;&quot;</span>, </a>
<a class="sourceLine" id="cb548-6" title="6">        <span class="dt">xlab=</span><span class="st">&quot;nFolds&quot;</span>, <span class="dt">ylab=</span><span class="ot">NA</span>, <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, </a>
<a class="sourceLine" id="cb548-7" title="7">        <span class="dt">ylim=</span><span class="kw">c</span>(.<span class="dv">85</span>,<span class="fl">1.0</span>), <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">1</span>,xmax), <span class="dt">main=</span><span class="st">&quot;Logistic Regression Stability Results; Part 2&quot;</span>)</a>
<a class="sourceLine" id="cb548-8" title="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq</span>(.<span class="dv">85</span>,<span class="fl">1.0</span>,<span class="dt">by=</span>.<span class="dv">025</span>)) {</a>
<a class="sourceLine" id="cb548-9" title="9">    <span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(LRstability2), <span class="kw">rep</span>(i,<span class="kw">nrow</span>(LRstability2)), <span class="dt">col=</span><span class="st">&quot;gray69&quot;</span>)</a>
<a class="sourceLine" id="cb548-10" title="10">}</a>
<a class="sourceLine" id="cb548-11" title="11"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(LRstability2)) {</a>
<a class="sourceLine" id="cb548-12" title="12"></a>
<a class="sourceLine" id="cb548-13" title="13">    <span class="kw">points</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(LRstability2), LRstability2[,i], <span class="dt">pch=</span>pch[i], </a>
<a class="sourceLine" id="cb548-14" title="14">        <span class="dt">col=</span>cols[i], <span class="dt">cex=</span><span class="fl">1.2</span>)</a>
<a class="sourceLine" id="cb548-15" title="15"></a>
<a class="sourceLine" id="cb548-16" title="16">    <span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(LRstability2), LRstability2[,i], <span class="dt">col=</span>cols[i], </a>
<a class="sourceLine" id="cb548-17" title="17">        <span class="dt">lwd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb548-18" title="18">}</a>
<a class="sourceLine" id="cb548-19" title="19"><span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>, <span class="dt">at=</span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(LRstability2), <span class="dt">tick=</span><span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb548-20" title="20">        <span class="dt">labels=</span><span class="kw">rownames</span>(LRstability2))</a>
<a class="sourceLine" id="cb548-21" title="21"></a>
<a class="sourceLine" id="cb548-22" title="22"><span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">8.5</span>,<span class="dt">by=</span><span class="dv">1</span>), </a>
<a class="sourceLine" id="cb548-23" title="23">        <span class="dt">tick=</span><span class="ot">FALSE</span>, <span class="dt">labels=</span><span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb548-24" title="24"></a>
<a class="sourceLine" id="cb548-25" title="25"><span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">2</span>, <span class="dt">at=</span><span class="kw">seq</span>(.<span class="dv">85</span>,<span class="fl">1.0</span>,<span class="dt">by=</span>.<span class="dv">025</span>), <span class="dt">tick=</span><span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb548-26" title="26">        <span class="dt">las=</span><span class="ot">TRUE</span>, <span class="dt">labels=</span><span class="kw">paste</span>(<span class="kw">seq</span>(.<span class="dv">85</span>,<span class="fl">1.0</span>,<span class="dt">by=</span>.<span class="dv">025</span>)))</a>
<a class="sourceLine" id="cb548-27" title="27"></a>
<a class="sourceLine" id="cb548-28" title="28"><span class="kw">legend</span>(<span class="st">&#39;bottomright&#39;</span>,<span class="dt">legend=</span><span class="kw">colnames</span>(LRstability2), <span class="dt">pch=</span>pch, </a>
<a class="sourceLine" id="cb548-29" title="29">        <span class="dt">col=</span>cols, <span class="dt">cex=</span><span class="fl">1.0</span>, <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>,  <span class="dt">lwd=</span><span class="dv">3</span>, <span class="dt">lty=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-116-1.png" width="672" /></p>
</div>
<div id="plotting-the-total-duration-of-each-of-the-three-algorithms-combined-for-each-of-the-seven-different-folds" class="section level4">
<h4>Plotting the total duration of each of the three algorithms combined for each of the seven different folds:</h4>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb549-1" title="1">Duration &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">All3Algorithms=</span><span class="kw">c</span>(<span class="fl">11.57</span>,  <span class="fl">10.17</span>,  <span class="fl">13.86</span>,  <span class="fl">16.69</span>,  <span class="fl">20.46</span>,  <span class="fl">23.51</span>,  <span class="fl">28.65</span>))</a>
<a class="sourceLine" id="cb549-2" title="2">                        </a>
<a class="sourceLine" id="cb549-3" title="3"><span class="kw">rownames</span>(Duration) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>,<span class="dv">25</span>)</a>
<a class="sourceLine" id="cb549-4" title="4">Duration</a></code></pre></div>
<pre><code>##    All3Algorithms
## 3           11.57
## 5           10.17
## 7           13.86
## 10          16.69
## 15          20.46
## 20          23.51
## 25          28.65</code></pre>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb551-1" title="1">cols &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;royalblue2&quot;</span>)</a>
<a class="sourceLine" id="cb551-2" title="2">pch &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">16</span>)</a>
<a class="sourceLine" id="cb551-3" title="3">xmax &lt;-<span class="st"> </span><span class="kw">nrow</span>(Duration) <span class="op">+</span><span class="st"> </span><span class="fl">2.5</span></a>
<a class="sourceLine" id="cb551-4" title="4"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb551-5" title="5"><span class="kw">plot</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(Duration), <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(Duration), <span class="dt">pch=</span><span class="st">&quot;&quot;</span>, </a>
<a class="sourceLine" id="cb551-6" title="6">        <span class="dt">xlab=</span><span class="st">&quot;nFolds&quot;</span>, <span class="dt">ylab=</span><span class="ot">NA</span>, <span class="dt">xaxt=</span><span class="st">&quot;n&quot;</span>, <span class="dt">yaxt=</span><span class="st">&quot;n&quot;</span>, </a>
<a class="sourceLine" id="cb551-7" title="7">        <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">30</span>), <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">1</span>,xmax), <span class="dt">main=</span><span class="st">&quot;Three Algorithm&#39;s Total Duration (Seconds)&quot;</span>)</a>
<a class="sourceLine" id="cb551-8" title="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">30</span>,<span class="dt">by=</span><span class="dv">2</span>)) {</a>
<a class="sourceLine" id="cb551-9" title="9">    <span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(Duration), <span class="kw">rep</span>(i,<span class="kw">nrow</span>(Duration)), <span class="dt">col=</span><span class="st">&quot;gray69&quot;</span>)</a>
<a class="sourceLine" id="cb551-10" title="10">}</a>
<a class="sourceLine" id="cb551-11" title="11"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(Duration)) {</a>
<a class="sourceLine" id="cb551-12" title="12"></a>
<a class="sourceLine" id="cb551-13" title="13">    <span class="kw">points</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(Duration), Duration[,i], <span class="dt">pch=</span>pch[i], </a>
<a class="sourceLine" id="cb551-14" title="14">        <span class="dt">col=</span>cols[i], <span class="dt">cex=</span><span class="fl">1.2</span>)</a>
<a class="sourceLine" id="cb551-15" title="15"></a>
<a class="sourceLine" id="cb551-16" title="16">    <span class="kw">lines</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(Duration), Duration[,i], <span class="dt">col=</span>cols[i], </a>
<a class="sourceLine" id="cb551-17" title="17">        <span class="dt">lwd=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb551-18" title="18">}</a>
<a class="sourceLine" id="cb551-19" title="19"><span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>, <span class="dt">at=</span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(Duration), <span class="dt">tick=</span><span class="ot">FALSE</span>, </a>
<a class="sourceLine" id="cb551-20" title="20">        <span class="dt">labels=</span><span class="kw">rownames</span>(Duration))</a>
<a class="sourceLine" id="cb551-21" title="21"></a>
<a class="sourceLine" id="cb551-22" title="22"><span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">1</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="fl">8.5</span>,<span class="dt">by=</span><span class="dv">1</span>), </a>
<a class="sourceLine" id="cb551-23" title="23">        <span class="dt">tick=</span><span class="ot">FALSE</span>, <span class="dt">labels=</span><span class="ot">NA</span>)</a>
<a class="sourceLine" id="cb551-24" title="24"></a>
<a class="sourceLine" id="cb551-25" title="25"><span class="kw">axis</span>(<span class="dt">side=</span><span class="dv">2</span>, <span class="dt">at=</span><span class="kw">seq</span>(<span class="dv">10</span>,<span class="dv">30</span>,<span class="dt">by=</span><span class="dv">2</span>), <span class="dt">tick=</span><span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb551-26" title="26">        <span class="dt">las=</span><span class="ot">TRUE</span>, <span class="dt">labels=</span><span class="kw">paste</span>(<span class="kw">seq</span>(<span class="dv">10</span>,<span class="dv">30</span>,<span class="dt">by=</span><span class="dv">2</span>)))</a>
<a class="sourceLine" id="cb551-27" title="27"></a>
<a class="sourceLine" id="cb551-28" title="28"><span class="kw">legend</span>(<span class="st">&#39;bottomright&#39;</span>,<span class="dt">legend=</span><span class="kw">colnames</span>(Duration), <span class="dt">pch=</span>pch, </a>
<a class="sourceLine" id="cb551-29" title="29">        <span class="dt">col=</span>cols, <span class="dt">cex=</span><span class="fl">1.0</span>, <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>,  <span class="dt">lwd=</span><span class="dv">3</span>, <span class="dt">lty=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="CKME136OutputJuly30b_files/figure-html/unnamed-chunk-117-1.png" width="672" /> #### Computing the Cliff’s Delta effect size (for ordinal variables):</p>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb552-1" title="1"><span class="kw">library</span>(effsize)</a>
<a class="sourceLine" id="cb552-2" title="2"></a>
<a class="sourceLine" id="cb552-3" title="3">RFacc &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.8933333</span>,   <span class="fl">0.8933333</span>,  <span class="fl">0.9066667</span>,  <span class="fl">0.9066667</span>,  <span class="fl">0.9066667</span>,  <span class="fl">0.9066667</span>,  <span class="fl">0.9066667</span>)</a>
<a class="sourceLine" id="cb552-4" title="4">RFsens &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.8703704</span>,  <span class="fl">0.9074074</span>,  <span class="fl">0.9074074</span>,  <span class="fl">0.9074074</span>,  <span class="fl">0.9074074</span>,  <span class="fl">0.9074074</span>,  <span class="fl">0.9259259</span>)</a>
<a class="sourceLine" id="cb552-5" title="5">RFspec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.9523810</span>,  <span class="fl">0.8571429</span>,  <span class="fl">0.9047619</span>,  <span class="fl">0.9047619</span>,  <span class="fl">0.9047619</span>,  <span class="fl">0.9047619</span>,  <span class="fl">0.8571429</span>)</a>
<a class="sourceLine" id="cb552-6" title="6"></a>
<a class="sourceLine" id="cb552-7" title="7">NBacc &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.9200000</span>,   <span class="fl">0.9200000</span>,  <span class="fl">0.9200000</span>,  <span class="fl">0.9200000</span>,  <span class="fl">0.9066667</span>,  <span class="fl">0.9200000</span>,  <span class="fl">0.9200000</span>)</a>
<a class="sourceLine" id="cb552-8" title="8">NBsens &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.9259259</span>,  <span class="fl">0.9259259</span>,  <span class="fl">0.9259259</span>,  <span class="fl">0.9259259</span>,  <span class="fl">0.9074074</span>,  <span class="fl">0.9259259</span>,  <span class="fl">0.9259259</span>)</a>
<a class="sourceLine" id="cb552-9" title="9">NBspec &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="fl">0.9047619</span>, <span class="dv">7</span>)</a>
<a class="sourceLine" id="cb552-10" title="10"></a>
<a class="sourceLine" id="cb552-11" title="11">LRacc &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.8800000</span>,   <span class="fl">0.9066667</span>,  <span class="fl">0.9066667</span>,  <span class="fl">0.9066667</span>,  <span class="fl">0.9066667</span>,  <span class="fl">0.9066667</span>,  <span class="fl">0.8933333</span>)</a>
<a class="sourceLine" id="cb552-12" title="12">LRsens &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="fl">0.9814815</span>, <span class="dv">7</span>)</a>
<a class="sourceLine" id="cb552-13" title="13">LRspec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.6190476</span>,  <span class="fl">0.7142857</span>,  <span class="fl">0.7142857</span>,  <span class="fl">0.7142857</span>,  <span class="fl">0.7142857</span>,  <span class="fl">0.7142857</span>,  <span class="fl">0.6666667</span>)</a></code></pre></div>
</div>
<div id="cliffs-delta-effect-size-for-accuracy" class="section level4">
<h4>Cliff’s Delta effect size for Accuracy:</h4>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb553-1" title="1"><span class="co">#Random Forest accuracy to Naive Bayes accuracy:</span></a>
<a class="sourceLine" id="cb553-2" title="2">RFNBaccDelta &lt;-<span class="st"> </span><span class="kw">cliff.delta</span>(RFacc, NBacc)</a>
<a class="sourceLine" id="cb553-3" title="3">RFNBaccDelta</a></code></pre></div>
<pre><code>## 
## Cliff&#39;s Delta
## 
## delta estimate: -0.8979592 (large)
## 95 percent confidence interval:
##      lower      upper 
## -0.9980284  0.4910023</code></pre>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb555-1" title="1"><span class="co">#Random Forest accuracy to Logistic Regression accuracy:</span></a>
<a class="sourceLine" id="cb555-2" title="2">RFLRaccDelta &lt;-<span class="st"> </span><span class="kw">cliff.delta</span>(RFacc, LRacc)</a>
<a class="sourceLine" id="cb555-3" title="3">RFLRaccDelta</a></code></pre></div>
<pre><code>## 
## Cliff&#39;s Delta
## 
## delta estimate: 0.04081633 (negligible)
## 95 percent confidence interval:
##      lower      upper 
## -0.4679416  0.5292549</code></pre>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb557-1" title="1"><span class="co">#Logistic Regression accuracy to Naive Bayes accuracy:</span></a>
<a class="sourceLine" id="cb557-2" title="2">LRNBaccDelta &lt;-<span class="st"> </span><span class="kw">cliff.delta</span>(LRacc, NBacc)</a>
<a class="sourceLine" id="cb557-3" title="3">LRNBaccDelta</a></code></pre></div>
<pre><code>## 
## Cliff&#39;s Delta
## 
## delta estimate: -0.8979592 (large)
## 95 percent confidence interval:
##      lower      upper 
## -0.9980284  0.4910023</code></pre>
</div>
<div id="cliffs-delta-effect-size-for-sensitivity" class="section level4">
<h4>Cliff’s Delta effect size for Sensitivity:</h4>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb559-1" title="1"><span class="co">#Random Forest sensitivity to Naive Bayes sensitivity:</span></a>
<a class="sourceLine" id="cb559-2" title="2">RFNBsensDelta &lt;-<span class="st"> </span><span class="kw">cliff.delta</span>(RFsens, NBsens)</a>
<a class="sourceLine" id="cb559-3" title="3">RFNBsensDelta</a></code></pre></div>
<pre><code>## 
## Cliff&#39;s Delta
## 
## delta estimate: -0.7346939 (large)
## 95 percent confidence interval:
##      lower      upper 
## -0.9413617 -0.1271321</code></pre>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb561-1" title="1"><span class="co">#Random Forest sensitivity to Logistic Regression sensitivity:</span></a>
<a class="sourceLine" id="cb561-2" title="2">RFLRsensDelta &lt;-<span class="st"> </span><span class="kw">cliff.delta</span>(RFsens, LRsens)</a></code></pre></div>
<pre><code>## Warning in cliff.delta.default(RFsens, LRsens): The samples are fully
## disjoint, using approximate Confidence Interval estimation</code></pre>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb563-1" title="1">RFLRsensDelta</a></code></pre></div>
<pre><code>## 
## Cliff&#39;s Delta
## 
## delta estimate: -1 (large)
## 95 percent confidence interval:
##      lower      upper 
## -1.0000000 -0.9311004</code></pre>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb565-1" title="1"><span class="co">#Logistic Regression sensitivity to Naive Bayes sensitivity:</span></a>
<a class="sourceLine" id="cb565-2" title="2">LRNBsensDelta &lt;-<span class="st"> </span><span class="kw">cliff.delta</span>(LRsens, NBsens)</a></code></pre></div>
<pre><code>## Warning in cliff.delta.default(LRsens, NBsens): The samples are fully
## disjoint, using approximate Confidence Interval estimation</code></pre>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb567-1" title="1">LRNBsensDelta</a></code></pre></div>
<pre><code>## 
## Cliff&#39;s Delta
## 
## delta estimate: 1 (large)
## 95 percent confidence interval:
##     lower     upper 
## 0.9311004 1.0000000</code></pre>
</div>
<div id="cliffs-delta-effect-size-for-specificity" class="section level4">
<h4>Cliff’s Delta effect size for Specificity:</h4>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb569-1" title="1"><span class="co">#Random Forest specificity to Naive Bayes specificity:</span></a>
<a class="sourceLine" id="cb569-2" title="2">RFNBspecDelta &lt;-<span class="st"> </span><span class="kw">cliff.delta</span>(RFspec, NBspec)</a>
<a class="sourceLine" id="cb569-3" title="3">RFNBspecDelta</a></code></pre></div>
<pre><code>## 
## Cliff&#39;s Delta
## 
## delta estimate: -0.1428571 (negligible)
## 95 percent confidence interval:
##      lower      upper 
## -0.6015307  0.3866544</code></pre>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb571-1" title="1"><span class="co">#Random Forest specificity to Logistic Regression specificity:</span></a>
<a class="sourceLine" id="cb571-2" title="2">RFLRspecDelta &lt;-<span class="st"> </span><span class="kw">cliff.delta</span>(RFspec, LRspec)</a></code></pre></div>
<pre><code>## Warning in cliff.delta.default(RFspec, LRspec): The samples are fully
## disjoint, using approximate Confidence Interval estimation</code></pre>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb573-1" title="1">RFLRspecDelta</a></code></pre></div>
<pre><code>## 
## Cliff&#39;s Delta
## 
## delta estimate: 1 (large)
## 95 percent confidence interval:
##     lower     upper 
## 0.9311004 1.0000000</code></pre>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb575-1" title="1"><span class="co">#Logistic Regression specificity to Naive Bayes specificity:</span></a>
<a class="sourceLine" id="cb575-2" title="2">LRNBspecDelta &lt;-<span class="st"> </span><span class="kw">cliff.delta</span>(LRspec, NBspec)</a></code></pre></div>
<pre><code>## Warning in cliff.delta.default(LRspec, NBspec): The samples are fully
## disjoint, using approximate Confidence Interval estimation</code></pre>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb577-1" title="1">LRNBspecDelta</a></code></pre></div>
<pre><code>## 
## Cliff&#39;s Delta
## 
## delta estimate: -1 (large)
## 95 percent confidence interval:
##      lower      upper 
## -1.0000000 -0.9311004</code></pre>
</div>
<div id="section" class="section level4">
<h4></h4>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
